

\chapter{Integração}\label{cap_integr}
\thispagestyle{fancy}

Neste capítulo, discutimos os métodos numéricos fundamentais para a aproximação de integrais definidas de funções. Tais métodos são chamados de \emph{quadraturas numéricas} e têm a forma
\begin{equation}
  \int_a^b f(x)\,dx \approx \sum_{i=1}^n f(x_i)w_i,
\end{equation}
onde $x_i$ e $w_i$ são, respectivamente, o $i$-ésimo nodo e o $i$-ésimo peso da quadratura, $i=1, 2, \dotsc, n$.

\section{Regras de Newton-Cotes}\label{cap_integr_sec_NC}

Dada uma função $f(x)$ e um intervalo $[a, b]$, denotamos por
\begin{equation}
  I := \int_a^b f(x)\,dx.
\end{equation}
a integral de $f(x)$ no intervalo $[a, b]$. A ideia das regras de Newton-Cotes e aproximar $I$ pela integral de um polinômio interpolador de $f(x)$ por pontos previamente selecionados.

Seja, então, $p(x)$ o polinômio interpolador de grau $n$ de $f(x)$ pelos dados pontos $\{(x_i, f(x_i))\}_{i=1}^{n+1}$, com $x_1 < x_2 < \cdots < x_{n+1}$ e $x_i\in [a, b]$ para todo $i=1, 2, \dotsc, n+1$. Então, pelo teorema de Lagrange, temos
\begin{equation}
  f(x) = p(x) + R_{n+1}(x),
\end{equation}
onde
\begin{equation}
  p(x) = \sum_{i=1}^{n+1} f(x_i)\prod_{\overset{j=1}{j\neq i}}^{n+1} \frac{(x-x_j)}{x_i-x_j}
\end{equation}
e
\begin{equation}
  R_{n+1}(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{j=1}^{n+1}(x-x_j),
\end{equation}
onde $\xi = \xi(x)$ pertencente ao intervalo $[x_1, x_{n+1}]$. Deste modo, temos
\begin{align}
  I &:= \int_a^b f(x)\\
  &= \int_a^b p(x)\,dx + \int_a^b R_{n+1}(x)\,dx\\
  &= \underbrace{\sum_{i=1}^{n+1} f(x_i)\int_a^b \prod_{\overset{j=1}{j\neq i}}^{n+1} \frac{(x-x_j)}{x_i-x_j)}\,dx}_{\text{quadratura}} + \underbrace{\int_a^b R_{n+1}(x)\,dx}_{\text{erro de truncamento}}
\end{align}
Ou seja, nas quadraturas (regras) de Newton-Cotes, os nodos são as abscissas dos pontos interpolados e os pesos são as integrais dos polinômios de Lagrange associados.

Na sequência, abordaremos as regras de Newton-Cotes mais usuais e estimaremos o erro de truncamento caso a caso. Para uma abordagem mais geral, recomenda-se consultar~\cite[Cap. 7,Sec. 1.1]{Isaacson1994a}.

\subsection{Regras de Newton-Cotes fechadas}

As regras de Newton-Cotes fechadas são aqueles que a quadratura incluem os extremos do intervalo de integração, i.e. os nodos extremos são $x_1=a$ e $x_{n+1}=b$.

\subsubsection{Regra do trapézio}

A regra do trapézio é obtida tomando-se os nodos $x_1=a$ e $x_2=b$. Então, denotando $h:=b-a$\footnote{Neste capítulo, $h$ é escolhido como a distância entre os nodos.}, os pesos da quadratura são:
\begin{align}
  w_1 &= \int_a^b \frac{x-b}{a-b}\,dx \\
  &= \frac{(b-a)}{2} = \frac{h}{2}
\end{align}
e
\begin{align}
  w_2 &= \int_a^b \frac{x-a}{b-a}\,dx \\
  &= \frac{(b-a)}{2} = \frac{h}{2}.
\end{align}
Agora, estimamos o erro de truncamento com
\begin{align}
  E &:= \int_a^b R_2(x)\,dx\\
  &= \int_a^b \frac{f''(\xi(x))}{2}(x-a)(x-b)\,dx\\
  &\leq C\left|\int_a^b (x-a)(x-b)\,dx\right|\\
  &= C\frac{(b-a)^3}{6} = O(h^3).
\end{align}

Portanto, a \emph{regra do trapézio}\index{regra do!trapézio} é dada por
\begin{equation}
  \int_a^b f(x)\,dx = \frac{h}{2}(f(a) + f(b)) + O(h^3).
\end{equation}

\begin{ex}\label{ex:int_trap}
  Consideremos o problema de computar a integral de $f(x)=xe^{-x^2}$ no intervalo $[0, 1/4]$. Analiticamente, temos
  \begin{align}
    I = \int_0^{1/4} xe^{-x^2}\,dx &= \left. -\frac{e^{-x^2}}{2} \right|_0^{1/4}\\
    &= \frac{1-e^{-1/4}}{2} = 3,02935\E-2.
  \end{align}
Agora, usando a regra do trapézio, obtemos a seguinte aproximação para $I$
\begin{align}
  I &\approx \frac{h}{2}(f(0) + f(1/2))\\
  &= \frac{1/4}{2}\left(0 + \frac{1}{4}e^{-(1/4)^2}\right) = 2,93567\E-2.
\end{align}

\ifisoctave
Podemos obter a aproximação dada pela regra do trapézio no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=0.25;
h=b-a;
Itrap = (h/2)*(f(a)+f(b));
printf("%1.5E\n",Itrap)
\end{verbatim}
\fi
\end{ex}

\subsubsection{Regra de Simpson}

A regra de Simpson é obtida escolhendo-se os nodos $x_1=a$, $x_2=(a+b)/2$ e $x_3=b$. Com isso e denotando $h=(b-a)/2$, calculamos os seguintes pesos:
\begin{align}
  w_1 &= \int_a^b\frac{(x-x_2)(x-x_3)}{(x_1-x_2)(x_1-x_3)}\,dx\\
  &= \frac{(b-a)}{6} = \frac{h}{3},
\end{align}
\begin{align}
  w_2 &= \int_a^b\frac{(x-x_1)(x-x_3)}{(x_2-x_1)(x_2-x_3)}\,dx\\
  &= 4\frac{(b-a)}{6} = 4\frac{h}{3}
\end{align}
e
\begin{align}
  w_3 &= \int_a^b\frac{(x-x_1)(x-x_2)}{(x_3-x_1)(x_3-x_2)}\,dx\\
  &= \frac{(b-a)}{6} = \frac{h}{3}.
\end{align}
Isto nos fornece a chamada \emph{regra de Simpson}\index{regra de Simpson}
\begin{equation}\label{eq:aux_Simpson}
  I \approx \frac{h}{3}\left[f(a) + 4f\left(\frac{a+b}{2}\right) + f(b)\right]
\end{equation}

Nos resta estimar o erro de truncamento da regra de Simpson. Para tanto, consideramos a expansão em polinômio de Taylor de grau 3 de $f(x)$ em torno do ponto $x_2$, i.e.
\begin{align}
  f(x) &= f(x_2) + f'(x_2)(x-x_2) + \frac{f''(x_2)}{2}(x-x_2)^2 \nonumber\\
  &+ \frac{f'''(x_2)}{6}(x-x_2)^3 \nonumber\\
  &+ \frac{f^{(4)}(\xi_1(x))}{24}(x-x_2)^4,
\end{align}
donde
\begin{align}
  \int_a^b f(x)\,dx &= 2hf(x_2) + \frac{h^3}{3}f''(x_2) \nonumber\\
  &+ \frac{1}{24}\int_a^bf^{(4)}(\xi_1(x))(x-x_2)^4\,dx.\label{eq:aux_int_sim1}
\end{align}
Daí, usando da fórmula de diferenças finitas central de ordem $h^2$, temos
\begin{equation}\label{eq:aux_int_sim2}
  f''(x_2) = \frac{f(x_1) - 2f(x_2) + f(x_3)}{h^2} + O(h^2).
\end{equation}
Ainda, o último termo da equação~\eqref{eq:aux_int_sim1} pode ser estimado por
\begin{align}
  \left|\frac{1}{24}\int_a^bf^{(4)}(\xi_1(x))(x-x_2)^4\,dx\right| &\leq C\left|\int_a^b (x-x_2)^4\,dx\right|\\
  &= C(b-a)^5 = O(h^5).\label{eq:aux_int_sim3}
\end{align}\label{eq:aux_int_sim3}
Então, de \eqref{eq:aux_int_sim1}, \eqref{eq:aux_int_sim2} e \eqref{eq:aux_int_sim3}, temos
\begin{equation}
  \int_a^b f(x)\,dx = \frac{h}{3}\left[f(a) + 4f\left(\frac{a+b}{2}\right) + f(b)\right] + O(h^5),
\end{equation}
o que mostra que a \emph{regra de Simpson tem erro de truncamento da ordem $h^5$}.

\begin{ex}\label{ex:int_simp}
  Aproximando a integral dada no Exemplo~\ref{ex:int_trap} pela a regra de Simpson, temos
  \begin{align}
    \int_0^{1/4} f(x)\,dx &\approx \frac{1/8}{3}\left[f(0) + 4f\left(\frac{1}{8}\right) + f\left(\frac{1}{4}\right)\right]\\
    &= \frac{1}{24}\left[\frac{1}{2}e^{-(1/8)^2} + \frac{1}{4}e^{-(1/4)^2}\right]\\
    &= 3,02959\E-2.
  \end{align}

\ifisoctave
Podemos computar a aproximação dada pela regra de Simpson no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=1/4;
h=(b-a)/2;
Isimp = (h/3)*(f(a)+4*f((a+b)/2)+f(b));
printf("%1.5E\n",Isimp)
\end{verbatim}
\fi
\end{ex}

\subsection{Regras de Newton-Cotes abertas}

As regras de Newton-Cotes abertas não incluem os extremos dos intervalos como nodos das quadraturas.

\subsubsection{Regra do ponto médio}

A regra do ponto médio\index{regra do!ponto médio} é obtida usando apenas o nodo $x_1=(a+b)/2$. Desta forma, temos
\begin{equation}
  \int_a^b f(x)\,dx = \int_a^b f(x_1)\,dx + \int_a^b f'(\xi(x))(x-x_1)\,dx,
\end{equation}
donde, denotando $h:=(b-a)$, temos
\begin{equation}
  \int_a^b f(x),dx = hf\left(\frac{a+b}{2}\right) + O(h^3).
\end{equation}
Deixa-se para o leitor a verificação do erro de truncamento (veja, Exercício~\ref{exer:trunc_pto_medio}).

\begin{ex}\label{ex:int_pto_medio}
  Aproximando a integral dada no Exemplo~\ref{ex:int_trap} pela a regra do ponto médio, temos
  \begin{align}
    \int_0^{1/4} f(x)\,dx &\approx \frac{1}{4}f\left(\frac{1}{8}\right)\\
    &= \frac{1}{32}e^{-(1/8)^2}\\
    &= 3,07655\E-2
  \end{align}

\ifisoctave
Podemos computar a aproximação dada pela regra do ponto médio no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=0.25;
h=b-a;
Ipmd = h*f((a+b)/2);
printf("%1.5E\n",Ipmd)
\end{verbatim}
\fi
\end{ex}

\subsection*{Exercício}

\begin{exer}\label{exer:int_NC_fun}
  Aproxime
  \begin{equation}
    \int_{-1}^0 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
usando a:
\begin{enumerate}[a)]
\item regra do ponto médio.
\item regra do trapézio.
\item regra de Simpson.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_int_NC_fun/exer_int_NC_fun.m}{Código.} 
  \fi
  a)~$3,33647\E-1$; b)~$1,71368\E-1$; c)~$2,79554\E-1$
\end{resp}

\begin{exer}\label{exer:int_NC_tab}
  Considere a seguinte tabela de pontos
  \begin{center}
    \begin{tabular}{l|cccccc}
      $i$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ \\\hline
      $x_i$ & $2,0$ & $2,1$ & $2,2$ & $2,3$ & $2,4$ & $2,5$ \\
      $y_i$ & $1,86$ & $1,90$ & $2,01$ & $2,16$ & $2,23$ & $2,31$ \\\hline
    \end{tabular}
  \end{center}
Assumindo que $y = f(x)$, calcule:
\begin{enumerate}[a)]
\item $\displaystyle \int_{2,1}^{2,3} f(x)\,dx$ usando a regra do ponto médio.
\item $\displaystyle \int_{2,0}^{2,5} f(x)\,dx$ usando a regra do trapézio.
\item $\displaystyle \int_{2,0}^{2,4} f(x)\,dx$ usando a regra de Simpson.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_int_NC_tab/exer_int_NC_tab.m}{Código.} 
  \fi
  a)~$4,02000\E-1$; b)~$1,04250E+0$; c)~$8,08667\E-1$
\end{resp}

\begin{exer}\label{exer:trunc_pto_medio}
  Mostre que o erro de truncamento da regra do ponto médio é da ordem de $h^3$, onde $h$ é o tamanho do intervalo de integração.
\end{exer}
\begin{resp}
  Use um procedimento semelhante aquele usado para determinar a ordem do erro de truncamento da regra de Simpson.
\end{resp}

\begin{exer}\label{exer:NC_aberta_2pts}
  Obtenha a regra de Newton-Cotes aberta de $2$ pontos e estime seu erro de truncamento.
\end{exer}
\begin{resp}
  \begin{align}
    \displaystyle \int_a^bf(x)\,dx &= \frac{3h}{2}\left[f\left(a+\frac{1}{3}(b-a)\right)\right. \\
    &+ \left. f\left(a + \frac{2}{3}(b-a)\right)\right] + O(h^3), ~h=\frac{(b-a)}{3}
  \end{align}
\end{resp}

\section{Regras compostas de Newton-Cotes}\label{cap_integr_sec_int_comp}

Regras de integração numérica compostas (ou quadraturas compostas\index{quadratura composta}) são aquelas obtidas da composição de quadraturas aplicadas as subintervalos do intervalo de integração. Mais especificamente, a integral de uma dada função $f(x)$ em um dado intervalo $[a, b]$ pode ser reescrita como uma soma de integrais em sucessivos subintervalos de $[a, b]$, i.e.
\begin{equation}
  \int_a^b f(x)\,dx = \sum_{i=1}^{n} \int_{x_i}^{x_{i+1}}f(x)\,dx,
\end{equation}
onde $a=x_1 < x_2 < \cdots < x_{n+1}=b$. Então, a aplicação de uma quadratura em cada integral em $[x_i, x_{i+1}]$, $i=1, 2, \dotsc, n$, nos fornece uma regra composta.

\subsection{Regra composta do ponto médio}

Consideremos uma partição uniforme do intervalo de integração $[a, b]$ da forma $a=\tilde{x}_1 < \tilde{x}_2 < \cdots < \tilde{x}_{n+1}=b$, com $h=x_{i+1}-x_{i}$, $i=1, 2, \dotsc, n$. Então, aplicando a regra do ponto médio a cada integral nos subintervalos $[\tilde{x}_i, \tilde{x}_{i+1}]$, temos
\begin{align}
  \int_a^b f(x)\,dx &= \sum_{i=1}^{n}\int_{\tilde{x}_i}^{\tilde{x}_{i+1}}f(x)\,dx\\
  &= \sum_{i=1}^n \left[hf\left(\frac{\tilde{x}_i+\tilde{x}_{i+1}}{2}\right) + O(h^3)\right].
\end{align}
Agora, observando que $h:=(b-a)/n$ e escolhendo os nodos $x_i = a + (i-1/2)h$, $i=1, 2, \dotsc, n$, obtemos a \emph{regra composta do ponto médio com $n$ subintervalos}
\begin{equation}
  \int_a^b f(x)\,dx = \sum_{i=1}^n hf(x_i) + O(h^2).
\end{equation}

\begin{ex}\label{ex:int_comp_pm}
  Consideremos o problema de computar a integral de $f(x)=xe^{-x^2}$ no intervalo $[0, 1]$. Usando a regra composta do ponto médio com $n$ subintervalos, obtemos a aproximação
  \begin{equation}
    \underbrace{\int_a^b f(x)\,dx}_{I} \approx \underbrace{\sum_{i=1}^n hf(x_i)}_{S},
  \end{equation}
onde $h=1/(4n)$ e $x_i = (i-1/2)h$, $i=1, 2, \dotsc, n$. Na Tabela~\ref{tab:ex_int_comp_pm}, temos as aproximações computadas com diversos números de subintervalos, bem como, seus erros absolutos.

\begin{table}[h!]
  \centering
  \caption{Resultados referentes ao Exemplo~\ref{ex:int_comp_pm}.}
  \begin{tabular}{l|cc}
    $n$ & $S$ & $|I-S|$ \\\hline
    1   & $3,89400\E-1$ & $7,3\E-2$ \\
    10  & $3,16631\E-1$ & $5,7\E-4$ \\
    100 & $3,16066\E-1$ & $5,7\E-6$ \\
    1000& $3.16060\E-1$ & $5,7\E-8$ \\\hline
  \end{tabular}
  \label{tab:ex_int_comp_pm}
\end{table}

\ifisoctave
Podemos fazer estas computações com o auxílio do seguinte código \verb+GNU Octave+:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=1;
n=10;
h=(b-a)/n;
s=0;
for i=1:n
  x=a+(i-1/2)*h;
  s+=h*f(x);
endfor
printf("%1.5E %1.1E\n",s,abs((1-e^(-1))/2-s))
\end{verbatim}
\fi
\end{ex}

\subsection{Regra composta do trapézio}

Para obtermos a regra composta do trapézio, consideramos uma partição uniforme do intervalo de integração $[a, b]$ da forma $a=x_1 < x_2 < \cdots < x_{n+1}=b$ com $h=x_{i+1}-x_{i}$, $i=1, 2, \dotsc, n$. Então, aplicando a regra do trapézio em cada integração nos subintervalos, obtemos
\begin{align}
  \int_a^bf(x)\,dx &= \sum_{i=1}^n \int_{x_i}^{x_{i+1}} f(x)\,dx\\
  &= \sum_{i=1}^n \left\{\frac{h}{2}\left[f(x_i)+f(x_{i+1})\right] + O(h^3)\right\}\\
  &= f(x_1)\frac{h}{2} + \sum_{i=2}^{n} hf(x_i) + f(x_{n+1})\frac{h}{2} + O(h^2). 
\end{align}
Desta forma, a regra composto do trapézio\index{regra composta!do trapézio} com $n$ subintervalos é
\begin{equation}
  \int_a^b f(x)\,dx = \frac{h}{2}\left[f(x_1) + \sum_{i=2}^{n} 2f(x_i) + f(x_{n+1})\right] + O(h^2),
\end{equation}
onde $h=(b-a)/n$ e $x_i = a + (i-1)h$, $i=1, 2, \dotsc, n$.

\begin{ex}\label{ex:int_comp_trap}
  Consideremos o problema de computar a integral de $f(x)=xe^{-x^2}$ no intervalo $[0, 1]$. Usando a regra composta do trapézio com $n$ subintervalos, obtemos a aproximação
  \begin{equation}
    \underbrace{\int_a^b f(x)\,dx}_{I} \approx \underbrace{\frac{h}{2}\left[f(x_1) + 2\sum_{i=2}^{n} f(x_i) + f(x_{n+1})\right]}_{S},
  \end{equation}
onde $h=1/(4n)$ e $x_i = (i-1)h$, $i=1, 2, \dotsc, n$. Na Tabela~\ref{tab:ex_int_comp_trap}, temos as aproximações computadas com diversos números de subintervalos, bem como, seus erros absolutos.

\begin{table}[h!]
  \centering
  \caption{Resultados referentes ao Exemplo~\ref{ex:int_comp_trap}.}
  \begin{tabular}{l|cc}
    $n$ & $S$ & $|I-S|$ \\\hline
    1   & $1,83940\E-1$ & $1,3\E-1$ \\
    10  & $3,14919\E-1$ & $1,1\E-3$ \\
    100 & $3.16049\E-1$ & $1,1\E-5$ \\
    1000& $3,16060\E-1$ & $1,1\E-7$ \\\hline
  \end{tabular}
  \label{tab:ex_int_comp_trap}
\end{table}

\ifisoctave
Podemos fazer estas computações com o auxílio do seguinte código \verb+GNU Octave+:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=1;
n=1000;
h=(b-a)/n;
s=f(a);
for i=2:n
  x=a+(i-1)*h;
  s+=2*f(x);
endfor
s+=f(b);
s*=h/2;
printf("%1.5E %1.1E\n",s,abs((1-e^(-1))/2-s))
\end{verbatim}
\fi
\end{ex}

\subsection{Regra composta de Simpson}

A fim de obtermos a regra composta de Simpson, consideramos uma partição uniforme do intervalo de integração $[a, b]$ da forma $a=\tilde{x}_1 < \tilde{x}_2 < \cdots < \tilde{x}_{n+1}=b$, com $h=(\tilde{x}_{i+1}-\tilde{x}_{i})/2$, $i=1, 2, \dotsc, n$. Então, aplicando a regra de Simpson a cada integral nos subintervalos $[\tilde{x}_i, \tilde{x}_{i+1}]$, temos
\begin{align}
  \int_a^b f(x)\,dx &= \sum_{i=1}^{n}\int_{\tilde{x}_i}^{\tilde{x}_{i+1}}f(x)\,dx\\
  &= \sum_{i=1}^n \left\{\frac{h}{3}\left[f(\tilde{x_i}) + 4f\left(\frac{\tilde{x}_i+\tilde{x}_{i+1}}{2}\right) + f(\tilde{x_{i+1}})\right] + O(h^5)\right\}.
\end{align}
Então, observando que $h=(b-a)/(2n)$ e tomando $x_i=a+(i-1)h$, $i=1, 2, \dotsc, n$, obtemos a regra composta de Simpson\index{regra composta!de Simpson} com $n$ subintervalos
\begin{align}
  \int_a^b f(x)\,dx &= \frac{h}{3}\left[f(x_1) + 2\sum_{i=2}^{n} f(x_{2i-1}) + 4\sum_{i=1}^{n} f(x_{2i}) + f(x_{n+1})\right] \nonumber\\
  &+ O(h^4)
\end{align}

\begin{ex}\label{ex:int_comp_sim}
  Consideremos o problema de computar a integral de $f(x)=xe^{-x^2}$ no intervalo $[0, 1]$. Usando a regra composta de Simpson com $n$ subintervalos, obtemos a aproximação
  \begin{equation}
    \underbrace{\int_a^b f(x)\,dx}_{I} \approx \underbrace{\frac{h}{3}\left[f(x_1) + 2\sum_{i=2}^{n} f(x_{2i-1}) + 4\sum_{i=1}^{n} f(x_{2i}) + f(x_{n+1})\right]}_{S},
  \end{equation}
onde $h=1/(8n)$ e $x_i = (i-1)h$, $i=1, 2, \dotsc, n$. Na Tabela~\ref{tab:ex_int_comp_sim}, temos as aproximações computadas com diversos números de subintervalos, bem como, seus erros absolutos.

\begin{table}[h!]
  \centering
  \caption{Resultados referentes ao Exemplo~\ref{ex:int_comp_sim}.}
  \begin{tabular}{l|cc}
    $n$ & $S$ & $|I-S|$ \\\hline
    1   & $3,20914\E-1$ & $4,9\E-3$ \\
    10  & $3,16061\E-1$ & $3,4\E-7$ \\
    100 & $3,16060\E-1$ & $3,4\E-11$ \\
    1000& $3,16060\E-1$ & $4,2\E-15$ \\\hline
  \end{tabular}
  \label{tab:ex_int_comp_sim}
\end{table}

\ifisoctave
Podemos fazer estas computações com o auxílio do seguinte código \verb+GNU Octave+:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=1;
n=1000;
h=(b-a)/(2*n);
s=f(a);
for i=2:n
  x=a+(2*i-2)*h;
  s+=2*f(x);
endfor
for i=1:n
  x=a+(2*i-1)*h;
  s+=4*f(x);
endfor
s+=f(b);
s*=h/3;
printf("%1.5E %1.1E\n",s,abs((1-e^(-1))/2-s))
\end{verbatim}
\fi
\end{ex}

\subsection*{Exercícios}

\begin{exer}\label{exer:int_comp_fun}
  Aproxime
  \begin{equation}
    \int_{-1}^0 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
usando a:
\begin{enumerate}[a)]
\item regra composta do ponto médio com $10$ subintervalos.
\item regra composta do trapézio com $10$ subintervalos.
\item regra composta de Simpson com $10$ subintervalos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_int_comp_fun/exer_int_comp_fun.m}{Código.} 
  \fi
  a)~$2,69264\E-1$; b)~$2,68282\E-1$; c)~$2,68937\E-1$
\end{resp}

\begin{exer}\label{exer:int_comp_tab}
  Considere a seguinte tabela de pontos
  \begin{center}
    \begin{tabular}{l|cccccc}
      $i$ & $1$ & $2$ & $3$ & $4$ & $5$ & $6$ \\\hline
      $x_i$ & $2,0$ & $2,1$ & $2,2$ & $2,3$ & $2,4$ & $2,5$ \\
      $y_i$ & $1,86$ & $1,90$ & $2,01$ & $2,16$ & $2,23$ & $2,31$ \\\hline
    \end{tabular}
  \end{center}
Assumindo que $y = f(x)$, e usando o máximo de subintervalos possíveis, calcule:
\begin{enumerate}[a)]
\item $\displaystyle \int_{2,0}^{2,4} f(x)\,dx$ usando a regra do ponto médio composta.
\item $\displaystyle \int_{2,0}^{2,5} f(x)\,dx$ usando a regra do trapézio composta.
\item $\displaystyle \int_{2,0}^{2,4} f(x)\,dx$ usando a regra de Simpson composta.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_int_comp_tab/exer_int_comp_tab.m}{Código.} 
  \fi
  a)~$8,12000\E-1$; b)~$1,03850$; c)~$8,11667\E-1$
\end{resp}

\section{Quadratura de Romberg}\label{cap_integr_sec_Romberg}

A quadratura de Romberg é construída por sucessivas extrapolações de Richardson da regra do trapézio composta. Sejam $h_k = (b-a)/(2k)$, $x_i = a + (i-1)h_k$ e
\begin{equation}
  R_{k,1} := \frac{h_k}{2}\left[f(a) + 2\sum_{i=2}^{2k}f(x_i) + f(b)\right]
\end{equation}
a regra do trapézio composta com $2k$ subintervalos de
\begin{equation}
  I := \int_a^b f(x)\,dx.
\end{equation}
Por sorte, o erro de truncamento de aproximar $I$ por $R_{k,1}$ tem a seguinte forma
\begin{equation}
  I - R_{k,1} = \sum_{i=1}^\infty k_ih_k^{2i},
\end{equation}
o que nos permite aplicar a extrapolação de Richardson para obter aproximações de mais alta ordem.

Mais precisamente, para obtermos uma aproximação de $I$ com erro de truncamento da ordem $h^{2n}$, $h=(b-a)$, computamos $R_{k,1}$ para $k=1, 2, \dotsc, n$. Então, usamos das sucessivas extrapolações de Richardson
\begin{equation}
  R_{k,j} := R_{k,j-1} + \frac{R_{k,j-1}-R_{k-1,j-1}}{4^{j-1}-1},
\end{equation}
$j=2, 3, \dotsc, n$, de forma a computarmos $R_{n,n}$, a qual fornece a aproximação desejada.

\begin{ex}\label{ex:Romberg}
  Consideremos o problema de aproximar a integral de $f(x)=xe^{-x^2}$ no intervalo $[0, 1]$. Para obtermos uma quadratura de Romberg de ordem $4$, calculamos
  \begin{align}
    R_{1,1} &:= \frac{1}{2}[f(0) + f(1)] = 1,83940\E-1\\
    R_{2,1} &:= \frac{1}{4}[f(0) + 2f(1/2) + f(1)] = 2,86670\E-1.
  \end{align}
Então, calculando
\begin{equation}
  R_{2,2} = R_{2,1} + \frac{R_{2,1}-R_{1,1}}{3} = 3,20914\E-1,
\end{equation}
a qual é a aproximação desejada.

\begin{table}[h!]
  \centering
  \caption{Resultados referentes ao Exemplo~\ref{ex:Romberg}.}
  \begin{tabular}{l|cccc}
    k & $R_{k,1}$ & $R_{k,2}$ & $R_{k,3}$ & $R_{k,4}$ \\\hline
    1 & $1,83940\E-1$ \\
    2 & $2,86670\E-1$ & $3,20914\E-1$ \\
    3 & $3,08883\E-1$ & $3,16287\E-1$ & $3,15978\E-1$ \\
    4 & $3,14276\E-1$ & $3,16074\E-1$ & $3,16059\E-1$ &  $3,16061\E-1$\\\hline
  \end{tabular}
  \label{tab:ex_Romberg}
\end{table}

Na Tabela~\ref{tab:ex_Romberg}, temos os valores de aproximações computadas pela quadratura de Romberg até ordem $8$.

\ifisoctave
Podemos fazer estas computações com o auxílio do seguinte código \verb+GNU Octave+:
\begin{verbatim}
#integral
f = @(x) x*exp(-x^2);
a=0;
b=1;

#ordem 2n
n=4;

R = zeros(n,n);
#R(k,1)
for k=1:n
  h = (b-a)/(2^(k-1));
  R(k,1) = f(a);
  for i=2:2^(k-1)
    x = a + (i-1)*h;
    R(k,1) += 2*f(x);
  endfor
  R(k,1) += f(b);
  R(k,1) *= h/2;
endfor
#extrapola
for j=2:n
  for k=j:n
    R(k,j) = R(k,j-1) + (R(k,j-1)-R(k-1,j-1))/(4^(j-1)-1);
  endfor
endfor
#sol.
for i = 1:n 
  printf("%1.5E ",R(i,:))
  printf("\n")
end
\end{verbatim}
\fi
\end{ex}

\subsection*{Exercícios}

\begin{exer}\label{exer:int_comp_fun}
  Aproxime
  \begin{equation}
    \int_{-1}^0 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
usando a quadratura de Romberg de ordem 4.
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_Romberg_fun/exer_Romberg_fun.m}{Código.} 
  \fi
  $2,68953\E-1$
\end{resp}

\section{Grau de exatidão}\label{cap_integr_sec_grau_exat}

O grau de exatidão é uma medida de exatidão de uma quadratura numérica. Mais precisamente, dizemos que uma dada quadratura numérica de nodos e pesos $\{(x_i, w_i)\}_{i=1}^n$ tem grau de exatidão $m$, quando
\begin{equation}
  \int_a^b p(x)\,dx = \sum_{i=1}^n p(x_i)w_i
\end{equation}
para todo polinômio $p(x)$ de grau menor $m$. Ou ainda, conforme descrito na definição a seguir.

\begin{defn}\index{grau de exatidão}
  Dizemos que uma dada quadratura numérica de pontos e nodos $\{x_i, w_i\}_{i=1}^n$ tem \emph{grau de exatidão} $m$, quando
  \begin{equation}
    \int_a^b x^k\,dx = \sum_{i=1}^n x_i^kw_i,~\forall k\leq m.
  \end{equation}
\end{defn}

\begin{ex}
  Determinemos o grau de exatidão da regra do ponto médio. Para tanto, verificamos para quais $k$ vale
  \begin{equation}
    \int_a^b x^k\,dx = (b-a)\left(\frac{a+b}{2}\right)^k.
  \end{equation}
Vejamos:
\begin{itemize}
\item $k=0$:
  \begin{align}
    &\int_a^b x^0\,dx = \left. x\right|_a^b = b-a,\\
    &(b-a)\left(\frac{a+b}{2}\right)^0 = b-a.
  \end{align}
\item $k=1$:
  \begin{align}
    &\int_a^b x^1\,dx = \left. \frac{x^2}{2}\right|_a^b = \frac{b^2}{2}-\frac{a^2}{2},\\
    &(b-a)\left(\frac{a+b}{2}\right)^1 = (b-a)\frac{(a+b)}{2} = \frac{b^2}{2}-\frac{a^2}{2}.
  \end{align}
\item $k=2$:
  \begin{align}
    &\int_a^b x^2\,dx = \left. \frac{x^3}{3}\right|_a^b = \frac{b^3}{3}-\frac{a^3}{3},\\
    &(b-a)\left(\frac{a+b}{2}\right)^2 \neq \frac{b^3}{3}-\frac{a^3}{3}.
  \end{align}
\end{itemize}
Ou seja, a regra do ponto média tem grau de exatidão $1$.
\end{ex}

\begin{ex}
  Determinemos o grau de exatidão da regra de Simpson. Para tanto, verificamos para quais $k$ vale
  \begin{equation}
    \int_a^b x^k\,dx = \frac{(b-a)}{6}\left(f(a) + 4f\left(\frac{a+b}{2}\right) + f(b)\right)^k.
  \end{equation}
Vejamos:
\begin{itemize}
\item $k=0$:
  \begin{align}
    &\int_a^b x^0\,dx = \left. x\right|_a^b = b-a,\\
    &\frac{(b-a)}{6}\left(a^0 + 4\left(\frac{a+b}{2}\right)^0 + b^0\right) = b-a.
  \end{align}
\item $k=1$:
  \begin{align}
    &\int_a^b x^1\,dx = \left. \frac{x^2}{2}\right|_a^b = \frac{b^2}{2}-\frac{a^2}{2},\\
    &\frac{(b-a)}{6}\left(a^1 + 4\left(\frac{a+b}{2}\right)^1 + b^1\right) = \frac{(b-a)}{2}(a+b) \\
    &\qquad = \frac{b^2}{2}-\frac{a^2}{2}.
  \end{align}
\item $k=2$:
  \begin{align}
    &\int_a^b x^2\,dx = \left. \frac{x^3}{3}\right|_a^b = \frac{b^3}{3} - \frac{a^3}{3},\\
    &\frac{(b-a)}{6}\left(a^2 + 4\left(\frac{a+b}{2}\right)^2 + b^2\right) = \frac{(b-a)}{3}(a^2 + ab + b^2)\\
    &\qquad = \frac{b^3}{3} - \frac{a^3}{3}.
  \end{align}
\item $k=3$:
  \begin{align}
    &\int_a^b x^3\,dx = \left. \frac{x^4}{4}\right|_a^b = \frac{b^4}{4}-\frac{a^4}{4},\\
    &\frac{(b-a)}{6}\left(a^3 + 4\left(\frac{a+b}{2}\right)^3 + b^3\right) \\
    &\qquad = \frac{(b-a)}{6}\left[\frac{3 a^{3}}{2} + \frac{3 b}{2} a^{2} + \frac{3 a}{2} b^{2} + \frac{3 b^{3}}{2}\right]\\
    &\qquad = \frac{b^4}{4}-\frac{a^4}{4}.
  \end{align}
\item $k=4$:
  \begin{align}
    &\int_a^b x^4\,dx = \left. \frac{x^5}{5}\right|_a^b = \frac{b^5}{5}-\frac{a^5}{5},\\
    &\frac{(b-a)}{6}\left(a^4 + 4\left(\frac{a+b}{2}\right)^4 + b^4\right) \neq \frac{b^5}{5}-\frac{a^5}{5}.
  \end{align}
\end{itemize}
Ou seja, a regra de Simpson tem grau de exatidão $3$.
\end{ex}

\subsection*{Exercícios}

\begin{exer}
  Determine o grau de exatidão da regra do trapézio.
\end{exer}
\begin{resp}
  $1$
\end{resp}

\begin{exer}
  Determine o nodo e o peso da quadratura numérica de um único nodo e de grau de exatidão $1$ para o intervalo de integração $[-1, 1]$.
\end{exer}
\begin{resp}
  $x_1=0$, $w_1=2$
\end{resp}

\section{Quadratura Gauss-Legendre}\label{cap_integr_sec_Gauss-Legendre}

Quadraturas gaussianas são quadraturas numéricas de máximo grau de exatidão. Especificamente, quadraturas de Gauss-Legendre são quadraturas gaussianas para integrais da forma
\begin{equation}
  \int_{-1}^1 f(x)\,dx.
\end{equation}

Consideremos o problema de determinar a quadratura de Gauss-Legendre de apenas um ponto. Começamos por exigir o grau de exatidão $0$, o que nos leva a
\begin{equation}
  w_1x_1^0 = \int_{-1}^1 x^0\,dx \Rightarrow w_1 = x|_{-1}^1 = 2.
\end{equation}
Agora, exigindo o grau de exatidão $1$, obtemos
\begin{align}
  w_1x_1^1 = \int_{-1}^1 x^1\,dx &\Rightarrow 2x_1 = \left.\frac{x^2}{2}\right|_{-1}^1 = 0\\
  &\Rightarrow x_1=0.
\end{align}
Com isso, concluímos que a quadratura de apenas um nodo de maior grau de exatidão para tais integrais é a de nodo $x_1=0$ e $w_1=2$. A qual é, por acaso, a regra do ponto médio.

Observamos, também, que cada grau de exatidão nos fornece uma condição para determinarmos os nodos e os pesos da desejada quadratura. Mais precisamente, seguindo o raciocínio anterior, para determinarmos a quadratura de $n$ pontos com maior grau de exatidão possível para integrais no intervalo $[-1, 1]$, acabaremos tendo que resolver um sistema de equações
\begin{equation}\label{eq:quad_gauss_sys}
  \sum_{i=1}^n x_i^kw_i = \int_{-1}^1 x^k\,dx,~k=0,1,2,\ldots, 2n-1.
\end{equation}
Isto é, como teremos $2n$ incógnitas ($n$ nodos e $n$ pesos) a determinar, poderemos exigir o grau de exatidão máximo de $2n-1$.

O sistema~\eqref{eq:quad_gauss_sys} é um sistema não linear para os nodos e a determinação de soluções para $n$ grande não é uma tarefa trivial. Alternativamente, veremos que os pontos da quadratura de Gauss-Legendre de $n$ nodos são as raízes do polinômio de Legendre de grau $n$. Por definição, o polinômio de Legendre de grau $n$, denotado por $P_n(x)$, satisfaz a seguinte propriedade de ortogonalidade
\begin{equation}\label{eq:ortogonalidade_pol_Legendre}
  \int_{-1}^1 p(x)P_n(x)\,dx = 0,
\end{equation}
para todo polinômio $p(x)$ de grau menor que $n$. Com isso, estabelecemos o seguinte resultado.

\begin{teo}\label{teo:Gauss-Legendre}
  A quadratura de Gauss-Legendre de $n$ nodos tem as raízes do polinômio de Legendre de grau $n$ como seus nodos e seus pesos são dados por
  \begin{equation}\label{eq:pesos_Gauss-Legendre_1}
    w_i = \int_{-1}^1 \prod_{\overset{j=1}{j\neq i}}^n \frac{x-x_j}{x_i-x_j}\,dx.
  \end{equation}
\end{teo}
\begin{dem}
  Sejam $x_1, x_2, \dotsc, x_n$ as raízes do polinômio de Legendre de grau $n$. Queremos mostrar que
  \begin{equation}
    \int_{-1}^1 p(x)\,dx = \sum_{i=1}^n p(x_i)w_i,
  \end{equation}
para todo polinômio $p(x)$ de grau menor ou igual $2n-1$. Primeiramente, suponhamos que $p(x)$ seja um polinômio de grau menor que $n$. Então, tomando sua representação por polinômio de Lagrange nos nodos $x_i$, $i=1, 2, \ldots, n$, temos
\begin{align}
  \int_{-1}^1 p(x)\,dx &= \int_{-1}^1 \sum_{i=1}^n p(x_i)\prod_{\overset{j=1}{j\neq i}}^n \frac{x-x_j}{x_i-x_j}\,dx\\
  &= \sum_{i=1}^n p(x_i) \int_{-1}^1 \prod_{\overset{j=1}{j\neq i}}^n \frac{x-x_j}{x_i-x_j}\,dx\\
  &= \sum_{i=1}^n p(x_i)w_i.
\end{align}
Isto mostra o resultado para polinômios $p(x)$ de grau menor que $n$. Agora, suponhamos que $p(x)$ é um polinômio de grau maior ou igual que $n$ e menor ou igual a $2n-1$. Dividindo $p(x)$ pelo polinômio de Legendre de grau $n$, $P_n(x)$,  obtemos
\begin{equation}
  p(x) = q(x)P_n(x) + r(x),
\end{equation}
onde $q(x)$ e $r(x)$ são polinômio de grau menor que $n$. Ainda, nas raízes $x_1, x_2, \dotsc, x_n$ temos $p(x_i) = r(x_i)$ e da ortogonalidade dos polinômios de Legendre (veja, equação~\eqref{eq:ortogonalidade_pol_Legendre}), temos
\begin{align}
  \int_{-1}^1 p(x)\,dx &= \int_{-1}^1 q(x)P_n(x) + r(x)\,dx\\
  &= \int_{-1}^1 r(x)\,dx.
\end{align}
Agora, do resultado anterior aplicado a $r(x)$, temos
\begin{equation}
  \int_{-1}^1 p(x)\,dx = \sum_{i=1}^n r(x_i)w_i = \sum_{i=1}^n p(x_i)w_i.
\end{equation}
Isto complete o resultado para polinômios de grau menor ou igual a $2n-1$.
\end{dem}

\begin{ex}
  Consideremos a quadratura de Gauss-Legendre de $2$ nodos. Do teorema anterior (Teorema~\ref{teo:Gauss-Legendre}, seus nodos são as raízes do polinômio de Legendre de grau 2
  \begin{equation}
    P_2(x) = \frac{3}{2}x^2 - \frac{1}{2},
  \end{equation}
as quais são
\begin{equation}
  x_1 = -\frac{\sqrt{3}}{3},\quad x_2=\frac{\sqrt{3}}{3}.
\end{equation}
Os pesos são, então
\begin{align}
  w_1 &= \int_{-1}^1 \frac{x-x_1}{x_2-x_1}\,dx \\
  &= \frac{\sqrt{3}}{2}\left[\frac{x^2}{2}+\frac{\sqrt{3}}{3}x\right]_{-1}^1\\
  &= 1
\end{align}
e
\begin{align}
  w_2 &= \int_{-1}^1 \frac{x-x_2}{x_1-x_2}\,dx \\
  &= -\frac{\sqrt{3}}{2}\left[\frac{x^2}{2}-\frac{\sqrt{3}}{3}x\right]_{-1}^1\\
  &= 1
\end{align}
Ou seja, a quadratura de Gauss-Legendre de $2$ pontos tem o seguinte conjunto de nodos e pesos $\{(x_1=-\sqrt{3}/3, w_1=1), (x_2=\sqrt{3}/3, w_2=1)\}$. Esta, por sua vez, é exata para polinômios de grau menor ou igual a $3$. De fato, verificando para potência de $x^k$ temos:
\begin{itemize}
\item $k=0$:
  \begin{align}
    \int_{-1}^1 x^0\,dx &= 2\\
    x_1^0w_1 + x_2^0w_2 &= \left(-\frac{\sqrt{3}}{3}\right)^0 + \left(\frac{\sqrt{3}}{3}\right)^0 = 2.
  \end{align}
\item $k=1$:
  \begin{align}
    \int_{-1}^1 x^1\,dx &= 0\\
    x_1^1w_1 + x_2^1w_2 &= \left(-\frac{\sqrt{3}}{3}\right)^1 + \left(\frac{\sqrt{3}}{3}\right)^1 = 0.
  \end{align}
\item $k=2$:
  \begin{align}
    \int_{-1}^1 x^2\,dx &= \frac{2}{3}\\
    x_1^2w_1 + x_2^2w_2 &= \left(-\frac{\sqrt{3}}{3}\right)^2 + \left(\frac{\sqrt{3}}{3}\right)^2 = \frac{2}{3}.
  \end{align}
\item $k=3$:
  \begin{align}
    \int_{-1}^1 x^3\,dx &= 0\\
    x_1^3w_1 + x_2^3w_2 &= \left(-\frac{\sqrt{3}}{3}\right)^3 + \left(\frac{\sqrt{3}}{3}\right)^3 = 0.
  \end{align}
\item $k=4$:
  \begin{align}
    \int_{-1}^1 x^4\,dx &= \frac{2}{5}\\
    x_1^4w_1 + x_2^4w_2 &= \left(-\frac{\sqrt{3}}{3}\right)^4 + \left(\frac{\sqrt{3}}{3}\right)^4 = \frac{2}{9}.
  \end{align}
\end{itemize}
\end{ex}

\begin{table}[h!]
  \centering
  \caption{Conjunto de nodos e pesos da quadratura de Gauss-Legendre.}
  \begin{tabular}{lcc}
    $n$ & $x_i$ & $w_i$ \\\hline\noalign{\smallskip}
    $1$ & 0 & 2 \\\noalign{\smallskip}\hline
    $2$ & $\displaystyle \pm \frac{\sqrt{3}}{3}$ & 1\\\noalign{\smallskip}\hline\noalign{\smallskip}
    \multirow{2}{*}{$3$} & $0$ & $\displaystyle \frac{8}{9}$ \\
      & $\displaystyle \pm\sqrt{\frac{3}{5}}$ & $\displaystyle \frac{5}{9}$\\\noalign{\smallskip}\hline\noalign{\smallskip}
    \multirow{2}{*}{$4$} & $\displaystyle \pm\sqrt{\frac{3}{7}-\frac{2}{7}\sqrt{\frac{6}{5}}}$ & $\displaystyle \frac{18+\sqrt{30}}{36}$ \\\noalign{\smallskip}
 & $\displaystyle \pm\sqrt{\frac{3}{7}+\frac{2}{7}\sqrt{\frac{6}{5}}}$ & $\displaystyle \frac{18-\sqrt{30}}{36}$\\\noalign{\smallskip}\hline\noalign{\smallskip}
    \multirow{3}{*}{$5$} & $0$ & $\displaystyle \frac{128}{225}$ \\\noalign{\smallskip}
        & $\displaystyle \pm\frac{1}{3}\sqrt{5-2\sqrt{\frac{10}{7}}}$ & $\displaystyle \frac{322+13\sqrt{70}}{900}$ \\\noalign{\smallskip}
        & $\displaystyle \pm\frac{1}{3}\sqrt{5+2\sqrt{\frac{10}{7}}}$ & $\displaystyle \frac{322-13\sqrt{70}}{900}$ \\\noalign{\smallskip}\hline
  \end{tabular}
  \label{tab:Gauss-Legendre}
\end{table}

\begin{obs}\label{obs:quad_Gauss-Legendre}
  O conjunto de nodos e pesos da quadratura de Gauss-Legendre para $n=1, 2, 3, 4, 5$ são apresentados na Tabela~\ref{tab:Gauss-Legendre}\footnote{Disponível em \url{https://en.wikipedia.org/w/index.php?title=Gaussian_quadrature&oldid=837460315}.}. Alternativamente, a quadratura de Gauss-Legendre com $n$ pontos tem seus nodos iguais as raízes de $P_n(x)$ (o polinômio de Legendre de gaus $n$), e os pesos dados por \eqref{eq:pesos_Gauss-Legendre_1} ou \cite[Cap.4, Sec. 4.6]{Press2007a}:
  \begin{equation}
    w_i = \frac{2}{(1-x_i^2)\left[P_n'(x_i)\right]^2},\quad i=1, 2, \dotsc, n.
  \end{equation}
\ifisoctave
Assim sendo, no \verb+GNU Octave+ podemos encontrar os nodos e pesos da quadratura de Gauss-Legendre com o seguinte código:
\begin{verbatim}
pkg load miscellaneous
n=6;
Pn=legendrepoly(n);
dPn=polyder(Pn);
x=roots(Pn);
w=2./((1-x.^2).*(polyval(dPn,x)).^2);
printf("i xx_i w_i\n")
for i=1:n
  printf("%d %1.7E %1.7E\n",i,x(i),w(i))
endfor
\end{verbatim}
\fi
\end{obs}

\begin{ex}\label{ex:GL_fun}
  Considere o problema de obter uma aproximação para $I = \int_{-1}^1 \cos(x)\,dx$ usando a quadratura de Gauss-Legendre. Calculemos algumas aproximações com $n=1$, $2$ e $3$ pontos:
  \begin{itemize}
  \item $n=1$:
    \begin{equation}
      \int_{-1}^1 \cos(x)\,dx \approx 2 \cos 0 = 2.
    \end{equation}
  \item $n=2$:
    \begin{equation}
      \int_{-1}^1 xe^{-x^2}\,dx \approx \cos(-\sqrt{3}/3) + \cos(-\sqrt{3}/3) = 1,67582.
    \end{equation}
  \item $n=3$:
    \begin{align}
      \int_{-1}^1 xe^{-x^2}\,dx &\approx \frac{8}{9}\cos 0 + \frac{5}{9}\cos(-\sqrt{3/5}) \nonumber\\
      &+ \frac{5}{9}\cos(\sqrt{3/5}) = 1,68300.
    \end{align}
  \end{itemize}

\begin{table}[h!]
  \centering
  \begin{tabular}{lcc}
    $n$ & $\tilde{I}$ & $|I-\tilde{I}|$ \\\hline
    $1$ & $2,00000$ & $3,2\E-01$ \\
    $2$ & $1,67582$ & $7,1\E-03$ \\
    $3$ & $1,68300$ & $6,2\E-05$ \\
    $4$ & $1,68294$ & $2,8\E-07$ \\
    $5$ & $1,68294$ & $7,9\E-10$ \\\hline
  \end{tabular}
  \caption{Resultados referentes ao Exemplo~\ref{ex:GL_fun}.}
  \label{tab:ex_GL_fun}
\end{table}

Na Tabela~\ref{tab:ex_GL_fun}, temos as aproximações de $I$ com a quadratura de Gauss-Legendre de $n=1$, $2$, $3$, $4$ e $5$ pontos (detonado por $\tilde{I}$, bem como, o erro absoluto com respeito ao valor analítico da integral.

\ifisoctave
Os cálculos, aqui, apresentados podem ser realizados no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) cos(x);

#int. anlitc.
ia = sin(1)-sin(-1);

#GL-1
x=0;
w=2;
s=w*f(x);
printf("%1.5E %1.1\E\n",s,abs(s-ia))

#GL-2
x=[sqrt(3)/3];
w=[1];
s=w(1)*f(x(1));
s+=w(1)*f(-x(1));
printf("%1.5E %1.1\E\n",s,abs(s-ia))

#GL-3
x=[0 sqrt(3/5)];
w=[8/9 5/9];
s=w(1)*f(x(1)) + w(2)*f(x(2));
s+=w(2)*f(-x(2));
printf("%1.5E %1.1\E\n",s,abs(s-ia))

#GL-4
x=[sqrt(3/7-2/7*sqrt(6/5)) sqrt(3/7+2/7*sqrt(6/5))];
w=[(18+sqrt(30))/36 (18-sqrt(30))/36];
s=w(1)*f(x(1)) + w(2)*f(x(2));
s+=w(1)*f(-x(1)) + w(2)*f(-x(2));
printf("%1.5E %1.1\E\n",s,abs(s-ia))

#GL-5
x=[0 1/3*sqrt(5-2*sqrt(10/7)) 1/3*sqrt(5+2*sqrt(10/7))];
w=[128/225 (322+13*sqrt(70))/900 (322-13*sqrt(70))/900];
s=w(1)*f(x(1)) + w(2)*f(x(2)) + w(3)*f(x(3));
s+=w(2)*f(-x(2)) + w(3)*f(-x(3));
printf("%1.5E %1.1\E\n",s,abs(s-ia))
\end{verbatim}
\fi
\end{ex}

\subsection{Intervalos de integração arbitrários}

Observamos que a quadratura de Gauss-Legendre foi desenvolvida para aproximar integrais definidas no intervalo $[-1, 1]$. Por sorte, uma integral definida em um intervalo arbitrário $[a, b]$ pode ser reescrita como uma integral no intervalo $[-1, 1]$ através de uma mudança de variável apropriada. Mais precisamente, assumindo a mudança de variável
\begin{equation}
  x = \frac{b-a}{2}(u+1)+a
\end{equation}
temos
\begin{equation}
  dx = \frac{b-a}{2}du
\end{equation}
e, portanto,
\begin{equation}
  \int_a^b f(x)\,dx = \int_{-1}^1 f\left(\frac{b-a}{2}(u+1)+a\right)\cdot \frac{b-a}{2}du.
\end{equation}
Portanto, para computarmos $\int_a^bf(x)\,dx$ podemos aplicar a quadratura de Gauss-Legendre na integral definida no $[-1, 1]$ dada conforme acima.

\begin{ex}
Usemos a quadratura de Gauss-Legendre com $2$ pontos para aproximar a integral
\begin{equation}
  \int_0^{1} xe^{-x^2}\,dx.
\end{equation}
Fazendo a mudança de variável $x=u/2 + 1/2$, temos
\begin{equation}
  \int_0^{1} xe^{-x^2}\,dx = \int_{-1}^1 \left(\frac{u}{2}+\frac{1}{2}\right)e^{-\left(\frac{u}{2}+\frac{1}{2}\right)^2}\,du.
\end{equation}
Então, aplicando a quadratura temos
\begin{align}
  \int_0^{1} xe^{-x^2}\,dx &= \left(-\frac{\sqrt{3}}{6}+\frac{1}{2}\right)e^{-\left(-\frac{\sqrt{3}}{6}+\frac{1}{2}\right)^2} + \left(\frac{\sqrt{3}}{6}+\frac{1}{2}\right)e^{-\left(\frac{\sqrt{3}}{6}+\frac{1}{2}\right)^2} \\
  &= 3,12754\E-1.
\end{align}

\ifisoctave
No \verb+GNU Octave+, pode usar o seguinte código:
\begin{verbatim}
f = @(x) x*exp(-x^2);
a=0;
b=1;
F = @(u) (b-a)/2*f((b-a)/2*(u+1)+a);
x=sqrt(3)/3;
w=1;
s=w*F(-x)+w*F(x);
printf("%1.5E\n",s)
\end{verbatim}
\fi
\end{ex}

\subsection*{Exercícios}

\begin{exer}\label{exer:GL_fun}
  Aproxime
  \begin{equation}
    \int_{-1}^1 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
usando a quadratura de Gauss-Legendre com:
\begin{enumerate}[a)]
\item $n=1$ ponto.
\item $n=2$ pontos.
\item $n=3$ pontos.
\item $n=4$ pontos.
\item $n=5$ pontos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_GL_fun/exer_GL_fun.m}{Código.} 
  \fi
  a)~$-2,61712\E-1$; b)~$2,55351\E-1$; c)~$8,97510\E-2$; d)~$1,27411\E-1$; e)~$1.21016\E-1$.
\end{resp}

\begin{exer}\label{exer:GL_mudvar}
  Aproxime
  \begin{equation}
    \int_{0}^1 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
usando a quadratura de Gauss-Legendre com:
\begin{enumerate}[a)]
\item $n=1$ ponto.
\item $n=2$ pontos.
\item $n=3$ pontos.
\item $n=4$ pontos.
\item $n=5$ pontos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_GL_mudvar/exer_GL_mudvar.m}{Código.} 
  \fi
  a)~$-1,54617\E-1$; b)~$-1,50216\E-1$; c)~$-1,47026\E-1$; d)~$-1,47190\E-1$; e)~$-1,47193\E-1$.
\end{resp}

\begin{exer}\label{exer:GL_Npts}
  Aproxime
  \begin{equation}
    \int_{-1}^1 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
usando a quadratura de Gauss-Legendre com:
\begin{enumerate}[a)]
\item $n=5$ ponto.
\item $n=10$ pontos.
\item $n=20$ pontos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_GL_Npts/exer_GL_Npts.m}{Código.} 
  \fi
  a)~$1,21016\E-1$; b)~$1,21744\E-1$; c)~$1,21744\E-1$
\end{resp}

\section{Quadraturas gaussianas com pesos}\label{cap_integr_sec_Gauss_peso}

A quadratura gaussiana estudada na seção anterior (Seção~\ref{cap_integr_sec_Gauss-Legendre}) é um caso particular de quadraturas de máximo grau de exatidão para integrais da forma
\begin{equation}
  \int_a^b f(x)w(x)\,dx,
\end{equation}
onde $w(x)$ é positiva e contínua, chamada de função peso. Como anteriormente, os nodos $x_i$, $i=1, 2, \dotsc, n$, da quadratura gaussiana de $n$ pontos são as raízes do polinômio $p_n(x)$ que é ortogonal a todos os polinômios de grau menor que $n$. Aqui, isto significa
\begin{equation}
  \int_a^b q(x)p_n(x)w(x)\,dx = 0,
\end{equation}
para todo polinômio $q(x)$ de grau menor que $n$.

\subsection{Quadratura de Gauss-Chebyshev}\index{quadratura de!Gauss-Chebyshev}

Quadraturas de Gauss-Chebyshev são quadraturas gaussianas para integrais da forma
\begin{equation}
  \int_{-1}^1 f(x)(1-x^2)^{-1/2}\,dx.
\end{equation}
Neste caso, na quadratura gaussiana de $n$ pontos os nodos $x_i$ são as raízes do $n$-ésimo polinômio de Chebyshev $T_n(x)$. Pode-se mostrar (veja, por exemplo, \cite[Cap. 7, Sec. 4.1]{Isaacson1994a}) que o conjunto de pontos desta quadratura são dados por
\begin{align}
  x_i &= \cos\left(\frac{2i-1}{2n}\pi\right),\\
  w_i &= \frac{\pi}{n}.
\end{align}

\begin{ex}\label{ex:GC}
  Considere o problema de aproximar a integral
  \begin{equation}
    \int_{-1}^1 \frac{e^{-x^2}}{\sqrt{1-x^2}}\,dx.
  \end{equation}
Usando a quadratura de Gauss-Chebyshev de $n$ pontos temos:
\begin{itemize}
\item $n=1$:
  \begin{equation}
  \int_{-1}^1 \frac{e^{-x^2}}{\sqrt{1-x^2}}\,dx \approx \pi e^{-\cos(\pi/2)^2} = \pi.
\end{equation}
\item $n=2$:
  \begin{align}
  \int_{-1}^1 \frac{e^{-x^2}}{\sqrt{1-x^2}}\,dx &\approx \frac{\pi}{2} e^{-\cos(\pi/4)^2} + \frac{\pi}{2} e^{-\cos(3\pi/4)^2}  \\
    &= 1,90547.
\end{align}
\item $n=3$:
  \begin{align}
  \int_{-1}^1 \frac{e^{-x^2}}{\sqrt{1-x^2}}\,dx &\approx \frac{\pi}{3} e^{-\cos(\pi/6)^2} + \frac{\pi}{3} e^{-\cos(\pi/2)^2} + \frac{\pi}{3} e^{-\cos(5\pi/6)^2}  \\
    &= 2,03652.
\end{align}
\end{itemize}

\begin{table}[h!]
  \centering
  \begin{tabular}{lc}
    $n$ & $\tilde{I}$\\\hline
    $1$ & $3,14159$\\
    $2$ & $1,90547$\\
    $3$ & $2,03652$\\
    $4$ & $2,02581$\\
    $5$ & $2,02647$\\
    $6$ & $2,02644$\\
    $10$ & $2,02644$\\\hline
  \end{tabular}
  \caption{Resultados referentes ao Exemplo~\ref{ex:GC}.}
  \label{tab:ex_GC}
\end{table}

Na Tabela~\ref{tab:ex_GC}, temos as aproximações $\tilde{I}$ da integral computadas com a quadratura de Gauss-Chebyshev  com diferentes números de pontos.
\ifisoctave
Estes resultados podem ser computados no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) exp(-x^2);
n=5;
s=0;
for i=1:n
  x=cos((2*i-1)*pi/(2*n));
  w=pi/n;
  s+=f(x)*w;
endfor
printf("%1.5E\n",s)
\end{verbatim}
\fi
\end{ex}

\subsection{Quadratura de Gauss-Laguerre}

Quadraturas de Gauss-Laguerre são quadraturas gaussianas para integrais da forma
\begin{equation}
  \int_{0}^\infty f(x)e^{-x}\,dx.
\end{equation}
Neste caso, na quadratura gaussiana de $n$ pontos os nodos $x_i$ são as raízes do $n$-ésimo polinômio de Laguerre $L_n(x)$ e os pesos por
\begin{equation}
  w_i = -\frac{1}{n[L_n'(x_i)]^2},~i=1, 2, \dotsc, n.
\end{equation}
Na Tabela~\ref{tab:quad_GLa}, temos os pontos da quadratura de Gauss-Laguerre para diversos valores de $n$.

\begin{table}[h!]
  \centering
  \caption{Pontos da quadratura de Gauss-Laguerre.}
  \begin{tabular}{lrr}
    $n$ & $x_i$ & $w_i$ \\\hline
    $1$ & $1,0000000\E+00$ & $1,0000000\E+00$ \\\hline
    \multirow{2}{*}{2}
        & $3,4142136\E+00$ & $1,4644661\E-01$ \\
        & $5,8578644\E-01$ & $8,5355339\E-01$ \\\hline
    \multirow{3}{*}{3}
        & $6,2899451\E+00$ & $1,0389257\E-02$ \\
        & $2,2942804\E+00$ & $2,7851773\E-01$ \\
        & $4,1577456\E-01$ & $7,1109301\E-01$ \\\hline
    \multirow{4}{*}{4}
        & $9,3950709\E+00$ & $5,3929471\E-04$ \\
        & $4,5366203\E+00$ & $3,8887909\E-02$ \\
        & $1,7457611\E+00$ & $3,5741869\E-01$ \\
        & $3,2254769\E-01$ & $6,0315410\E-01$ \\\hline
    \multirow{5}{*}{5}
        & $1,2640801\E+01$ & $2,3369972\E-05$ \\
        & $7,0858100\E+00$ & $3,6117587\E-03$ \\
        & $3,5964258\E+00$ & $7,5942450\E-02$ \\
        & $1,4134031\E+00$ & $3,9866681\E-01$ \\
        & $2,6356032\E-01$ & $5,2175561\E-01$ \\\hline
  \end{tabular}
  \label{tab:quad_GLa}
\end{table}

\ifisoctave
No \verb+GNU Octave+, os pontos da quadratura de Gauss-Laguerre podem ser obtido com o seguinte código:
\begin{verbatim}
pkg load miscellaneous
n=2;
Ln=laguerrepoly(n);
dLn=polyder(Ln);
x=roots(Ln);
w=1./(x.*(polyval(dLn,x)).^2);
printf("i xx_i w_i\n")
for i=1:n
  printf("%1.7E %1.7E\n",x(i),w(i))
endfor
\end{verbatim}
\fi

\begin{ex}\label{ex:GLa}
  Na Tabela~\ref{tab:ex_GLa}, temos as aproximações $\tilde{I}$ da integral $I = \int_0^\infty \sen(x)e^{-x}\,dx$ obtidas pela quadratura de Gauss-Laguerre com diferentes pontos $n$.

\begin{table}[h!]
  \centering
  \begin{tabular}{lc}
    $n$ & $\tilde{I}$\\\hline
    $1$ & $8,41471\E-01$ \\
    $2$ & $4,32459\E-01$ \\
    $3$ & $4,96030\E-01$ \\
    $4$ & $5,04879\E-01$ \\
    $5$ & $4,98903\E-01$ \\\hline
  \end{tabular}
  \caption{Resultados referentes ao Exemplo~\ref{ex:GC}.}
  \label{tab:ex_GLa}
\end{table}

\ifisoctave
Os resultados obtidos neste exemplo podem ser computados no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) sin(x);

n=1;
xw = [1.0000000E+00 1.0000000E+00];
s = f(xw(1,1))*xw(1,2);
printf("%d %1.5E\n",n,s)

n=2;
xw = [3.4142136E+00 1.4644661E-01; ...
      5.8578644E-01 8.5355339E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)

n=3;
xw = [6.2899451E+00 1.0389257E-02;...
      2.2942804E+00 2.7851773E-01;...
      4.1577456E-01 7.1109301E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)

n=4;
xw = [9.3950709E+00 5.3929471E-04;...
      4.5366203E+00 3.8887909E-02;...
      1.7457611E+00 3.5741869E-01;...
      3.2254769E-01 6.0315410E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)

n=5;
xw = [1.2640801E+01 2.3369972E-05;...
      7.0858100E+00 3.6117587E-03;...
      3.5964258E+00 7.5942450E-02;...
      1.4134031E+00 3.9866681E-01;...
      2.6356032E-01 5.2175561E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)
\end{verbatim}
\fi
\end{ex}

\subsection{Quadratura de Gauss-Hermite}

Quadraturas de Gauss-Hermite são quadraturas gaussianas para integrais da forma
\begin{equation}
  \int_{-\infty}^\infty f(x)e^{-x^2}\,dx.
\end{equation}
Seus nodos $x_i$, $i=1, 2, \dotsc, n$ são as raízes do $n$-ésimo polinômio de Hermite e os pesos são dados por
\begin{equation}
  w_i = \frac{2^{n+1}n!\sqrt{\pi}}{[H_n'(x_i)]^2}.
\end{equation}

Na Tabela~\ref{tab:quad_GH}, temos os pontos da quadratura de Gauss-Hermite para diversos valores de $n$.

\begin{table}[h!]
  \centering
  \caption{Pontos da quadratura de Gauss-Hermite.}
  \begin{tabular}{lrr}
    $n$ & $x_i$ & $w_i$ \\\hline
    $1$ & $0,0000000\E+00$ & $1,7724539\E+00$ \\
    \multirow{2}{*}{2}
    & $-7,0710678\E-01$ & $8,8622693\E-01$ \\
    & $7,0710678\E-01$ & $8,8622693\E-01$ \\\hline
    \multirow{3}{*}{3}
    & $-1,2247449\E+00$ & $2,9540898\E-01$ \\
    & $1,2247449\E+00$ & $2,9540898\E-01$ \\
    & $0,0000000\E+00$ & $1,1816359\E+00$ \\\hline
    \multirow{4}{*}{4}
    & $-1,6506801\E+00$ & $8,1312835\E-02$ \\
    & $1,6506801\E+00$ & $8,1312835\E-02$ \\
    & $-5,2464762\E-01$ & $8,0491409\E-01$ \\
    & $5,2464762\E-01$ & $8,0491409\E-01$ \\\hline
    \multirow{5}{*}{5}
    & $-2,0201829\E+00$ & $1,9953242\E-02$ \\
    & $2,0201829\E+00$ & $1,9953242\E-02$ \\
    & $-9,5857246\E-01$ & $3,9361932\E-01$ \\
    & $9,5857246\E-01$ & $3,9361932\E-01$ \\
    & $0,0000000\E+00$ & $9,4530872\E-01$ \\\hline
  \end{tabular}
  \label{tab:quad_GH}
\end{table}

\ifisoctave
No \verb+GNU Octave+, os pontos da quadratura de Gauss-Hermite podem ser obtido com o seguinte código:
\begin{verbatim}
pkg load miscellaneous
n=2;
Hn=hermitepoly(n);
dHn=polyder(Hn);
x=roots(Hn);
w=2^(n+1)*factorial(n)*sqrt(pi)./((polyval(dHn,x)).^2);
printf("i xx_i w_i\n")
for i=1:n
  printf("%1.7E %1.7E\n",x(i),w(i))
endfor
\end{verbatim}
\fi

\begin{ex}\label{ex:GH}
  Na Tabela~\ref{tab:ex_GH}, temos as aproximações $\tilde{I}$ da integral $I = \int_{-\infty}^\infty x\sen(x)e^{-x^2}\,dx$ obtidas pela quadratura de Gauss-Hermite com diferentes pontos $n$.

\begin{table}[h!]
  \centering
  \begin{tabular}{lc}
    $n$ & $\tilde{I}$\\\hline
    $1$ & $0,00000\E+00$ \\
    $2$ & $8,14199\E-01$ \\
    $3$ & $6,80706\E-01$ \\
    $4$ & $6,90650\E-01$ \\
    $5$ & $6,90178\E-01$
  \end{tabular}
  \caption{Resultados referentes ao Exemplo~\ref{ex:GH}.}
  \label{tab:ex_GH}
\end{table}

\ifisoctave
Os resultados obtidos neste exemplo podem ser computados no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
f = @(x) x*sin(x);

n=1;
xw = [0.0000000E+00 1.7724539E+00];
s = f(xw(1,1))*xw(1,2);
printf("%d %1.5E\n",n,s)

n=2;
xw = [-7.0710678E-01 8.8622693E-01;...
       7.0710678E-01 8.8622693E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)

n=3;
xw = [-1.2247449E+00 2.9540898E-01;...
       1.2247449E+00 2.9540898E-01;...
       0.0000000E+00 1.1816359E+00];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)

n=4;
xw = [-1.6506801E+00 8.1312835E-02;...
       1.6506801E+00 8.1312835E-02;...
      -5.2464762E-01 8.0491409E-01;...
       5.2464762E-01 8.0491409E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)

n=5;
xw = [-2.0201829E+00 1.9953242E-02;...
       2.0201829E+00 1.9953242E-02;...
      -9.5857246E-01 3.9361932E-01;...
       9.5857246E-01 3.9361932E-01;...
       0.0000000E+00 9.4530872E-01];
s=0;
for i=1:n
  s+=f(xw(i,1))*xw(i,2);
endfor
printf("%d %1.5E\n",n,s)
\end{verbatim}
\fi
\end{ex}

\subsection*{Exercícios}

\begin{exer}\label{exer:GL_fun}
  Aproxime
  \begin{equation}
    \int_{-1}^1 \frac{\sen(x+2)-e^{-x^2}}{\sqrt{1-x^2}}\,dx
  \end{equation}
usando a quadratura de Gauss-Chebyshev com:
\begin{enumerate}[a)]
\item $n=1$ ponto.
\item $n=2$ pontos.
\item $n=3$ pontos.
\item $n=4$ pontos.
\item $n=5$ pontos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_GC_fun/exer_GC_fun.m}{Código.} 
  \fi
  a)~$-2,84951E-01$; b)~$2,66274\E-01$; c)~$1,49496\E-01$; d)~$1,60085\E-01$; e)~$1,59427\E-01$.
\end{resp}

\begin{exer}\label{exer:GLa_fun}
  Aproxime
  \begin{equation}
    \int_{0}^\infty \left(\sen(x+2)-e^{-x^2}\right)e^{-x}\,dx
  \end{equation}
usando a quadratura de Gauss-Laguerre com:
\begin{enumerate}[a)]
\item $n=3$ pontos.
\item $n=4$ pontos.
\item $n=5$ pontos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_GLa_fun/exer_GLa_fun.m}{Código.} 
  \fi
  a)~$-1,03618\E-1$; b)~$-5,56446\E-2$; c)~$-4,19168\E-2$
\end{resp}

\begin{exer}\label{exer:GH_fun}
  Aproxime
  \begin{equation}
    \int_{-\infty}^\infty \sen(x+2)e^{-x^2}-e^{-2x^2}\,dx
  \end{equation}
usando a quadratura de Gauss-Hermite com:
\begin{enumerate}[a)]
\item $n=3$ pontos.
\item $n=4$ pontos.
\item $n=5$ pontos.
\end{enumerate}
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_GH_fun/exer_GH_fun.m}{Código.} 
  \fi
  a)~$-1,31347$; b)~$-1,23313$; c)~$-1,26007$
\end{resp}

\section{Método de Monte Carlo}\label{cap_integr_sec_Monte_Carlo}

O método de Monte Carlo é uma técnica não determinística para a aproximação de integrais. Mais especificamente, o método compreende a aproximação
\begin{equation}
  \int_a^b f(x)\,dx \approx \frac{(b-a)}{n}\sum_{i=1}^n f(x_i),
\end{equation}
onde $x_1, x_2, \dotsc, x_n$ são pontos de uma sequência aleatória em $[a, b]$. Aqui, não vamos entrar em detalhes sobre a escolha desta sequência e, sem mais justificativas, assumiremos uma sequência de pontos uniformemente distribuídos no intervalo de integração.

\begin{ex}\label{ex:Monte_Carlo}
  Na tabela~\ref{tab:ex_Monte_Carlo} temos aproximações $\tilde{I}$ computadas para
  \begin{equation}
    I = \int_0^1 xe^{-x^2}\,dx
  \end{equation}
usando o método de Monte Carlo com diferentes números de pontos $n$. Aqui, os pontos foram gerados no \verb+GNU Octave+ pela sequência {\it quasi}-randômica obtida da função $\verb+rand+$ inicializada com \verb+seed=0+.

\begin{table}[h!]
  \centering
  \begin{tabular}{l|cc}
    $n$ & $\tilde{I}$ & $|I-\tilde{I}|$\\\hline
    $10$ & $2,53304\E-01$ & $6,3\E-02$\\
    $100$ & $3,03149\E-01$ & $1,3\E-02$ \\
    $1000$ & $3,08415\E-01$ & $7,6\E-03$ \\
    $10000$ & $3,16385\E-01$ & $3,2\E-04$ \\
    $100000$ & $3,15564\E-01$ & $5,0\E-04$ \\\hline
  \end{tabular}
  \caption{Resultados referentes ao Exemplo~\ref{ex:Monte_Carlo}.}
  \label{tab:ex_Monte_Carlo}
\end{table}

\ifisoctave
Os resultados presentes na Tabela~\ref{tab:ex_Monte_Carlo} podem ser computados no \verb+GNU Octave+ com o seguinte código:
\begin{verbatim}
#inic. gerador randômico
rand("seed",0)
#fun. obj.
f = @(x) x*exp(-x^2);
a=0;
b=1;
#num. de amostras
n=100000;
#calc. aprox.
s=0;
for i=1:n
  x=a + (b-a)*rand();
  s+=f(x);
endfor
s*=(b-a)/n;
#sol. analítica
ia=0.5-exp(-1)/2;
printf("%1.5E %1.1E\n",s,abs(ia-s))
\end{verbatim}
\fi
\end{ex}

\subsection*{Exercícios}

\begin{exer}\label{exer:Monte_Carlo_fun1}
  Use o método de Monte Carlo para obter uma aproximação de 
  \begin{equation}
    \int_{-1}^1 \frac{\sen(x+2)-e^{-x^2}}{x^2+\ln(x+2)}\,dx
  \end{equation}
com precisão de $10^{-2}$.
\end{exer}
\begin{resp}
  \ifisoctave 
  \href{https://github.com/phkonzen/notas/blob/master/src/MatematicaNumerica/cap_integr/dados/exer_Monte_Carlo_fun1/exer_Monte_Carlo_fun1.m}{Código.} 
  \fi
  $1,2\E-1$
\end{resp}
