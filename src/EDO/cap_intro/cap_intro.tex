%Este trabalho está licenciado sob a Licença Atribuição-CompartilhaIgual 4.0 Internacional Creative Commons. Para visualizar uma cópia desta licença, visite http://creativecommons.org/licenses/by-sa/4.0/deed.pt_BR ou mande uma carta para Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.

\chapter{Introdução}\label{cap_intro}

Neste capítulo, introduzimos conceitos e definições elementares sobre Equações Diferenciais (ED). Por exemplo, definimos tais equações, apresentamos alguns exemplos de modelagem matemática e problemas relacionados.

\section{Equações diferenciais}\label{cap_intro_sec_ed}
\badgeYouTube{f6FX2o3U-X0}

% \begin{flushright}
%   \href{https://archive.org/details/edo-introducao}{[Vídeo]} | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
% \end{flushright}

\emph{Equação Diferencial (ED)} é o nome dado a qualquer equação que tenha pelo menos um termo envolvendo a diferenciação (derivação) de uma incógnita.

\begin{ex}\label{ex:ed}
  São exemplos de equações diferenciais:
  \begin{enumerate}[a)]
  \item Modelo de queda de um corpo com resistência do ar.
    \begin{equation}\label{eq:ex_ed_queda}
      \frac{dv}{dt} = g - \frac{k}{m}v^2.
    \end{equation}
    Nesta equação, temos a velocidade $v = v(t)$ ($v$ função de $t$) como \emph{incógnita}. O tempo é descrito por $t$ como uma variável independente. As demais letras correspondem a parâmetros dados (constantes). Mais especificamente, $g$ corresponde à gravidade, $k$ à resistência do ar e $m$ à massa do corpo.
  \item Equação de Verhulst (Equação Logística)
    \begin{equation}\label{eq:ex_ed_Verhulst}
      \frac{dy}{dt} = r\left(1 - \frac{y}{K}\right)y.
    \end{equation}
    Esta equação é um clássico modelo de crescimento populacional. Aqui, $y = y(t)$ é o tamanho da população (incógnita) no tempo $t$ (variável independente). As demais letras correspondem a parâmetros dados.
  \item Equação de Schrödinger.
    \begin{equation}\label{eq:ex_ed_Schroedinger}
      -\frac{\hbar}{2m}\frac{d^2\psi}{dx^2} + \frac{kx^2}{2}\psi = E\psi.
    \end{equation}
    Esta equação modela a função de onda $\psi$ (incógnita) de uma partícula em função de sua posição $x$ (modelo unidimensional). Neste modelo quântico, $\hbar$, $m$, $k$ e $E$ são parâmetros.
  \item Modelagem da corrente em um circuito elétrico.
    \begin{equation}
      L\frac{d^2I}{dt^2} + R\frac{dI}{dt} + \frac{1}{C}I = E.
    \end{equation}
    Aqui, a incógnita é função corrente $I$ em função do tempo. O modelo refere-se a um circuito elétrico com os seguintes parâmetros: $L$ indutância, $R$ resistência, $C$ capacitância e $E$ voltagem do gerador.
  \item Equação do calor.
    \begin{equation}
      \frac{\p u}{\p t} = \alpha\frac{\p^2 u}{\p x^2}.
    \end{equation}
    Esta equação modela a distribuição de temperatura (incógnita) $u = u(t,x)$ como função do tempo e da posição (variáveis independentes). O parâmetro é o coeficiente de difusão térmica $\alpha$.
  \end{enumerate}
\end{ex}

\emph{Equação Diferencial Ordinária (EDO)} é aquela em que a incógnita é função apenas de uma variável independente. Desta forma, todas as derivadas que aparecem na equação são ordinárias. No Exemplo \ref{ex:ed}, as equações diferenciais a), b), c) e d) são ordinárias. A equação e) não é ordinária, pois a incógnita $u = u(t,x)$ é função das varáveis independentes $t$ e $x$, portanto, os termos diferenciais são parciais (derivadas parciais). Equações como esta são chamadas de equações diferenciais parciais.

Toda EDO pode ser escrita na seguinte forma geral
\begin{equation}\label{eq:edo_geral}
  F(t, y, y', y'', \cdots, y^{(n)}) = 0.
\end{equation}
Aqui, $F$ é uma função envolvendo a variável independente $t$ e a variável dependente $y = y(t)$ (incógnita, função de $t$) e pelo menos uma derivada ordinária de $y$ em relação a $t$\footnote{Lembre-se que $\displaystyle y' = \frac{dy}{dt}$, $y'' = \frac{d^2y}{dt^2}$ e assim por diante.}. O índice $n$ corresponde a \emph{ordem} da derivada de maior ordem que aparece na equação, sendo $n\geq 1$. Quando $F$ é função linear das variáveis $y$, $y'$, $\cdots$, $y^{(n)}$, então a EDO é dita ser \emph{linear}, caso contrário, é \emph{não linear}. Quando $F$ não dependente explicitamente de $t$, a equação é dita ser \emph{autônoma}.

\begin{ex}
  Vejamos os seguintes casos:
  \begin{enumerate}[a)]
  \item A equação
    \begin{equation}
      y'' + y = 0
    \end{equation}
    é uma EDO de ordem $2$, linear e autônoma. Aqui, temos $F(y, y'') = y'' + y$.
  \item As equações \eqref{eq:ex_ed_queda} e \eqref{eq:ex_ed_Verhulst} são EDOs de \emph{primeira ordem} (de ordem $1$), autônomas e não lineares.
  \item A Equação de Schrödinger \eqref{eq:ex_ed_Schroedinger} é uma EDO de \emph{segunda ordem}, linear e não autônoma.
  \end{enumerate}
\end{ex}

Uma \emph{solução} de uma EDO \eqref{eq:edo_geral} é uma função $y = y(t)$ que satisfaça a equação para todos os valores de $t$\footnote{Em várias situações o domínio de interesse de $t$ é também informado junto com a equação. Veremos isso mais adiante.}.

\begin{ex}
  As funções $y_1(t) = e^t$ e $y_2(t) = e^{-t}$ são soluções da equação diferencial ordinária
  \begin{equation}
    y'' - y = 0.
  \end{equation}
  De fato, tomando $y = y_1(t) = e^t$, temos $y' = e^t$ e $y'' = e^t$. Substituindo na EDO, obtemos
  \begin{equation}
    y'' - y = e^t - e^t = 0,
  \end{equation}
  para todo $t$. Logo, $y = e^t$ satisfaz a equação.
  
  Também, tomando $y = y_2(t) = e^{-t}$, temos $y' = -e^{-t}$ e $y'' = e^{-t}$. Substituindo na EDO, calculamos
  \begin{equation}
    y'' - y = e^{-t} - e^{-t} = 0, \quad\forall t.
  \end{equation}
  Ou seja, $y = e^{-t}$ também satisfaz a equação.

  \ifispython
  No \python, podemos usar:
  \begin{lstlisting}
    In : from sympy import *
    In : t = symbols('t')
    In : y = symbols('y', cls=Function)
    In : de = Eq(Derivative(y(t),t,t)-y(t) ,0)
    In : y1 = exp(t)
    In : checkodesol(de,y1)
    Out: (True, 0)
    In : y2 = exp(-t)
    In : checkodesol(de,y2)
    Out: (True, 0)
  \end{lstlisting}
  \fi
\end{ex}

\subsection*{Exercícios resolvidos}

\begin{exeresol}
  Determine a ordem e diga se a seguinte EDO é linear ou autônoma. Justifique suas respostas.
  \begin{equation}
    t^2\frac{dy}{dt} + (1+y^2)\frac{d^2y}{dt^2} + y = e^t.
  \end{equation}
\end{exeresol}
\begin{resol}
  \begin{enumerate}[a)]
  \item Ordem 2.

    A equação tem ordem 2, pois o termo diferencial de maior ordem é uma derivada de segunda ordem.

  \item EDO é não linear.

    A equação tem um termo $\displaystyle y^2\frac{d^2y}{dt^2}$, o qual não é linear em $y$.

  \item EDO não é autônoma.

    A equação não é autônoma, pois a variável independente $t$ aparece explicitamente. A saber, no primeiro termo do lado esquerdo e no termo fonte da equação.
  \end{enumerate}
\end{resol}

\begin{exeresol}
  Determine os valores de $r$ para os quais $y = e^{rt}$ é solução da equação
  \begin{equation}
    y'' - y = 0.
  \end{equation}
\end{exeresol}
\begin{resol}
  Para que $y = e^{rt}$ seja solução da equação dada, devemos ter
  \begin{align}
    y'' - y = 0 &\Rightarrow \left(e^{rt}\right)'' - e^{rt} = 0 \\
    &\Rightarrow r^2e^{rt} - e^{rt} = 0 \\
    &\Rightarrow (r^2 - 1)\cdot \underbrace{e^{rt}}_{>0} = 0\\
    &\Rightarrow r^2 - 1 = 0 \\
    &\Rightarrow r = \pm 1.
  \end{align}
  \ifispython
  No \python, podemos computar a solução deste problema com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    In : r,t = symbols('r,t')
    In : eq = diff(exp(r*t),t,2)-exp(r*t)
    In : solve(eq,r)
    Out: [-1, 1]
  \end{lstlisting}
  \fi
\end{resol}

\subsection*{Exercícios}

\begin{exer}
  Determine quais das seguintes são EDOs. Justifique sua resposta.
  \begin{enumerate}[a)]
  \item $\displaystyle y = y''$.
  \item $\displaystyle \frac{\p y}{\p t} = \frac{1}{2}\frac{\p y}{\p x}$.
  \item $\displaystyle y\cdot \frac{d^5y}{dx^5} = x\ln(y) + \frac{d}{dx}e^{x^2}$.
  \item $u_{tt} = \alpha^2u_{xx}$, sendo $\alpha$ um parâmetro.
  \end{enumerate}
\end{exer}
\begin{resp}
  a), c)
\end{resp}

\begin{exer}\label{exer:edo_ordem}
  Determine a ordem das seguintes EDOs. Justifique sua resposta.
  \begin{enumerate}[a)]
  \item $\displaystyle t^2y' = e^{t}$.
  \item $\displaystyle \frac{d^2y}{dt^2} = \frac{d^3y}{dt^3}$.
  \item $\displaystyle y\cdot y'' - 3y'' = y - y'$.
  \item $\displaystyle \left(\frac{d^2y}{dt^2}\right)^2 = e^t$.
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$1$; b)~$3$; c)~$2$; d)~$2$.
\end{resp}

\begin{exer}
  Determine quais das equações do Exercício \ref{exer:edo_ordem} não são autônomas. Justifique sua resposta.
\end{exer}
\begin{resp}
  a), d).
\end{resp}

\begin{exer}
  Determine quais das equações do Exercício \ref{exer:edo_ordem} são lineares. Justifique sua resposta.
\end{exer}
\begin{resp}
  a), b).
\end{resp}

\begin{exer}
  Para cada equação a seguir, calcule os valores de $r$ para os quais $y = e^{rt}$ seja solução da equação.
  \begin{enumerate}[a)]
  \item $y'' + y' - 6y = 0$.
  \item $y''' = 3y''$.
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\{-3, 2\}$; b)~$\{0, 3\}$
\end{resp}

\begin{exer}
  Calcule os valores de $\alpha$ para os quais $y = t^\alpha$, $t>0$, seja solução da equação
  \begin{equation}
    t^2y'' = 2y.
  \end{equation}
\end{exer}
\begin{resp}
  $\{-1, 2\}$.
\end{resp}


\section{Problemas de Valores Iniciais e de Valores de Contorno}\label{cap_intro_sec_pv}

A solução de uma Equação Diferencial Ordinária (EDO) pode conter uma ou mais constantes indeterminadas. Estas constantes podem ser fixadas pela imposição de uma ou mais condições iniciais ou condições de contorno.

\subsection{Problema de Valor Inicial (PVI)}\label{cap_intro_sec_pv_ssec_pvi}
\badgeYouTube{vrOWeU4CqeY}

% \begin{flushright}
%   [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
% \end{flushright}

\begin{flushright}
  \href{https://archive.org/details/edo-pvi}{[Vídeo]} | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

\begin{ex}
  A EDO
  \begin{equation}
    y' = 1
  \end{equation}
  tem soluções
  \begin{gather}
    \int y'\,dt = \int 1\cdot dt\\
    \Rightarrow y = t + c
  \end{gather}
  onde $c$ é uma constante indeterminada.
\end{ex}

Afim de fixar uma solução única para tais EDOs, comumente define-se uma \emph{condição inicial} apropriada, i.e. o valor da solução para um dado valor da variável independente. O problema de resolver uma EDO com condição inicial dada é chamado de \emph{Problema de Valor Inicial} (PVI).

\begin{ex}
  Vamos resolver o seguinte problema de valor inicial (PVI)
  \begin{align}
    &y' = 1,\quad t>0,\\
    &y(0)=1.
  \end{align}
  Como vimos acima, integrando a EDO em relação a $t$, obtemos a chamada \emph{solução geral}
  \begin{equation}
    y(t) = t + c,
  \end{equation}
  onde $c$ é uma constante indeterminada.

  Agora, vamos usar a condição inicial $y(0)=1$. Para tanto, substituímos $t=0$ e $y=1$ na solução geral, i.e.
  \begin{gather}
    y = t + c\\
    1 = 0 + c\\
    c = 1
  \end{gather}
  Com isso, concluímos que a solução do PVI é
  \begin{equation}
    y(t) = t + 1.
  \end{equation}
\end{ex}


EDOs de segunda ordem podem requer duas condições iniciais.

\begin{ex}
  Consideramos o seguinte problema de valores iniciais
  \begin{align}
    &y'' = 1,\\
    &y(1) = 0,\quad y'(1) = 1.
  \end{align}
  Integrando a EDO, obtemos
  \begin{gather}
    \int y''\,dt = \int 1\cdot dt\\
    y' = t + c_1
  \end{gather}
  Integrando novamente
  \begin{gather}
    \int y'\,dt = \int t + c_1\,dt\\
    y = \frac{t^2}{2} + c_1t + c_2
  \end{gather}
  Com isso, obtemos a chamada \emph{solução geral} desta EDO
  \begin{equation}
    y(t) = \frac{t^2}{2} + c_1t + c_2.
  \end{equation}
  Agora, aplicando as condições iniciais, obtemos
  \begin{align}
    y(1) = 0 &\Rightarrow \frac{1}{2} + c_1 + c_2 = 0\\
    y'(1) = 1 &\Rightarrow 1 + c_1 = 1.
  \end{align}
  o que nos fornece o seguinte sistema de equações lineares
  \begin{gather}
    c_1 + c_2 = -\frac{1}{2}\\
    c_1 = 0
  \end{gather}
  A segunda equação nos fornece $c_1$ diretamente. Então, utilizando a primeira equação, obtemos $c_2 = -\frac{1}{2}$. Portanto, a solução deste PVI de ordem 2 é:
  \begin{equation}
    y(t) = \frac{t^2}{2} - \frac{1}{2}.
  \end{equation}
\end{ex}


\begin{obs}
  Observe que o número de condições iniciais é igual à ordem da EDO.
\end{obs}

\subsection{Problema de Valor de Contorno (PVC)}

\begin{flushright}
  \href{https://archive.org/details/edo-pvc}{[Vídeo]} | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Para EDOs de ordem 2, também podemos fixar uma solução através da aplicação de \emph{condições de contorno}. Neste caso, estamos interessados em obter a solução para valores da variável independente restritos a um intervalo fechado $[t_0, t_1]$. A solução é fixada pela determinação de seus valores nos pontos $t_0$ e $t_1$. O problema de encontrar a solução de uma EDO com condições de contorno, é chamado de \emph{Problema de Valor de Contorno (PVC)}.

\begin{ex}
  Consideramos o seguinte problema de valores de contorno
  \begin{align}
    &y'' = 1,\quad 0 < t < 1,\\
    &y(0) = 1,\quad y(1) = \frac{1}{2}.
  \end{align}
  Integrando duas vezes a EDO, obtemos a solução geral
  \begin{equation}
    y(t) = \frac{t^2}{2} + c_1t + c_2.
  \end{equation}
  Agora, aplicando as condições de contorno, obtemos
  \begin{align}
    &y(0) = 1 \Rightarrow c_2 = 1,\\
    &y(1) = \frac{1}{2} \Rightarrow \frac{1}{2} + c_1 + c_2 = \frac{1}{2}
  \end{align}
  Isto é, temos o sistema de equações lineares
  \begin{gather}
    c_2 = 1\\
    c_1 + c_2 = 0
  \end{gather}
  Resolvendo, temos $c_1=-1$ e $c_2=1$.  Desta forma, concluímos que a solução do PVC é
  \begin{equation}
    y(t) = \frac{t^2}{2} -t + 1.
  \end{equation}
\end{ex}

\begin{obs}
  O número de constantes indeterminadas na solução geral está relacionado à ordem da EDO.
\end{obs}

\subsection*{Exercícios resolvidos}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

\begin{exeresol}
  Encontre a solução do seguinte problema de valor inicial (PVI)
  \begin{align}
    &y' = t + 1,\quad t>0,\\
    &y(0) = 2.
  \end{align}
\end{exeresol}
\begin{resol}
  Integrando a EDO obtemos
  \begin{gather}
    \int y'\,dt = \int t+1\,dt\\
    y(t) = \frac{t^2}{2} + t + c,
  \end{gather}
  a qual é a solução geral da EDO.

  Então, aplicando a condição inicial $y(0) = 2$, obtemos
  \begin{equation}
    c = 2.
  \end{equation}
  Logo, a solução do PVI é
  \begin{equation}
    y(t) = \frac{t^2}{2} + t + 2
  \end{equation}

\end{resol}

\begin{exeresol}
  Encontre a solução do seguinte problema de valor de contorno (PVC)
  \begin{gather}
    y'' = t + 1,\quad -1 < t < 1, \\
    y(-1) = y(1) = 0.
  \end{gather}
\end{exeresol}
\begin{resol}
  Integrando duas vezes a EDO, obtemos
  \begin{gather}
    y'' = t + 1\\
    \int y''\,dt = \int t+1\,dt \\
    y' = \frac{t^2}{2} + t + c_1 \\
    \int y'\,dt = \int \frac{t^2}{2} + t + c_1 \,dt \\
    y(t) =  \frac{t^3}{6} + \frac{t^2}{2} + c_1t + c_2.
  \end{gather}
  Obtida a solução geral da EDO, aplicamos as condições de contorno. Temos
  \begin{gather}
    y(-1) = 0 \\
    -\frac{1}{6} + \frac{1}{2} - c_1 + c_2 = 0
  \end{gather}
  e
  \begin{gather}
    y(1) = 0 \\
    \frac{1}{6} + \frac{1}{2} + c_1 + c_2 = 0.
  \end{gather}
  Ou seja, precisamos resolver o seguinte sistema linear
  \begin{align}
    -c_1 + c_2 = -\frac{1}{3} \\
    c_1 + c_2 = -\frac{2}{3}.
  \end{align}
  Resolvendo, obtemos $c_1 = -\frac{1}{6}$ e $c_2 = -\frac{1}{2}$. Logo, a solução do PVC é
  \begin{equation}
    y(t) = \frac{t^3}{6} + \frac{t^2}{2} - \frac{1}{6}t - \frac{1}{2}.
  \end{equation}
\end{resol}

\begin{exeresol}
  Determine o valor de $x$ para o qual a solução do PVI
  \begin{align}
    &\frac{dy}{dx} = \frac{2-e^x}{1 + y^2},\quad x>0,\\
    &y(0)=0,
  \end{align}
  atinge seu valor máximo.
\end{exeresol}
\begin{resol}
  Lembramos que a monotonicidade de $y = y(x)$ pode ser analisada a partir do estudo de sinal de $dy/dx$. Fazendo o estudo de sinal de
  \begin{equation}
    \frac{dy}{dx} = \frac{2-e^x}{1+y^2},
  \end{equation}
  vemos que $dy/dx > 0$ para $x\in (0, \ln 2)$ e $dy/dx < 0$ para $x\in (\ln 2, \infty)$. Logo, temos que $y = y(x)$ é crescente em $[0, \ln 2]$ e decrescente em $[\ln 2, \infty)$. Desta forma, concluímos que a solução do PVI atinge seu valor máximo em $x = \ln 2$.
\end{resol}

\subsection*{Exercícios}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

\begin{exer}
  Resolva o seguinte PVI
  \begin{align}
    &y' = 0,\\
    &y(-1) = 1.
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = 1$.
\end{resp}

\begin{exer}
  Resolva o seguinte PVI
  \begin{align}
    &y' = t,\\
    &y(-1) = 1.
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = \frac{t^2}{2} + \frac{1}{2}$.
\end{resp}

\begin{exer}
  Resolva o seguinte PVC
  \begin{align}
    &y'' = 1,\\
    &y(0)=1,\quad y(1)=-1.
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = \frac{t^2}{2} - \frac{5}{2}t + 1$.
\end{resp}

\begin{exer}
  Resolva o seguinte PVC
  \begin{align}
    &y'' = \sen(t),\\
    &y(-\pi)=y(\pi)=0.
  \end{align}
\end{exer}
\begin{resp}
  $y(t) = -\sen(t)$.
\end{resp}
