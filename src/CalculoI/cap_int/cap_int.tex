\chapter{Integração}\label{cap_int}
\thispagestyle{fancy}

\section{Noção de integral}\label{cap_int_sec_nocaoint}

\subsection{Soma de Riemann}

Seja \hl{$f$ uma função contínua definida em um intervalo fechado $[a, b]$}. Seja, também, \hl{$P$} a seguinte \hl{\emph{partição} de $[a, b]$}
\begin{equation}
  P = \{a=x_0<x_1<x_2<\cdots<x_n=b\},
\end{equation}
onde $n+1$ é o número de pontos na partição. Definimos
\begin{equation}
  \hleq\Delta x_i = x_{i} - x_{i-1}
\end{equation}
o \hl{tamanho de cada subintervalo $I_{i} = [x_{i-1}, x_{i}]$ da partição}, com $i = 1, 2, \cdots, n$. A \hl{\emph{norma da partição}} é definida por
\begin{equation}
  \hleq\|P\| := \max_{i=1, \dotsc, n} \Delta x_i,
\end{equation}
i.e. \hl{o tamanho do maior subintervalo da partição}. Com isso, chama-se de uma \hl{\emph{soma de Riemann}}{\riemann} toda a expressão da forma
\begin{equation}\hleq
  S_n := \sum_{i=1}^n f(x_i^*)\Delta x_i,
\end{equation}
onde \hl{$x_i^*\in [x_i, x_{i-1}]$ (arbitrariamente escolhido)}. Consulte a Figura \ref{fig:soma_de_Riemann}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.9\textwidth]{./cap_int/dados/fig_soma_de_Riemann/fig_soma_de_Riemann}
  \caption{Ilustração da soma de Riemann.}
  \label{fig:soma_de_Riemann}
\end{figure}

\hl{No caso de uma função não negativa, uma soma de Riemann é uma aproximação da área sob seu gráfico e o eixo das abscissas}\footnote{Consulte o Exercício \ref{exer:int_geoRiemann} para uma interpretação geométrica no caso geral de funções contínuas.}. 

\subsection{Integral}

\hl{A integral (definida) de $a$ até $b$ de uma dada função $f$ em relação a $x$ é} denotada e definida por
\begin{equation}\hleq
  \int_a^b f(x)\,dx := \lim_{\|P\|\to 0} \sum_{i=1}^n f(x_i^*)\Delta x_i.
\end{equation}
De forma genérica, \hl{a integral definida de $a$ até $b$ é o limite das somas de Riemann quando a norma das partições $P$ do intervalo $[a, b]$ tendem a zero. Quando o limite existe, dizemos que $f$ é \emph{integrável} no intervalo $[a, b]$}.

Na notação de integral definida acima, chamamos $a$ de \hl{\emph{limite inferior}} e $b$ de \hl{\emph{limite superior de integração}}, $f$ é chamada de \hl{\emph{integrando}} e $x$ de \hl{\emph{variável de integração}}.

\begin{obs}
  Funções contínuas são funções integráveis.
\end{obs}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.9\textwidth]{./cap_int/dados/fig_geointdef/fig_geointdef}
  \caption{A integral definida como a área sob o gráfico.}
  \label{fig:geointdef}
\end{figure}

\begin{obs}\normalfont{(Área sob o gráfico)}\label{obs:int_area}
  No caso de uma função não negativa,
  \begin{equation}\hleq
    \int_a^b f(x)\,dx
  \end{equation}
  \hl{é a área sob o gráfico de $f$}\footnote{Consulte o Exercício \ref{exer:int_geointdef} para uma interpretação geométrica no caso geral de funções contínuas.}. Consulte a Figura \ref{fig:geointdef}.  
\end{obs}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_0^1 1\,dx.
  \end{equation}
  Aqui, o integrando é a função constante $f(x) \equiv 1$ e o \emph{intervalo de integração} é $[a, b]$. Da Observação \ref{obs:int_area}, temos que esta integral é a área sob o gráfico de $f$ no intervalo $[0, 1]$. Esta área é um retângulo de altura $1$ e comprimento $1$. Logo,
  \begin{equation}
    \int_0^1 1\,dx = 1\cdot 1 = 1.
  \end{equation}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(1, (x, 0, 1))
\end{lstlisting}

\begin{verbatim}
1
\end{verbatim}

\end{ex}

\subsection{Exercícios resolvidos}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int_{-1}^1 \sqrt{1 - x^2}\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Esta integral corresponde à área sob o gráfico da função $f(x) = \sqrt{1 - x^2}$ restrita ao intervalo $[-1, 1]$. Observando que
  \begin{align}
    y = \sqrt{x^2 - 1} &\Rightarrow y^2 = 1 - x^2\\
                       &\Rightarrow y^2 + x^2 = 1,
  \end{align}
  vemos que esta é a área do semicírculo de raio $1$. Logo,
  \begin{equation}
    \int_{-1}^1 \sqrt{1 - x^2}\,dx = \frac{\pi \cdot 1^2}{2} = \frac{\pi}{2}.
  \end{equation}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(sym.sqrt(1-x**2), (x, -1, 1))
\end{lstlisting}

\begin{verbatim}
pi/2
\end{verbatim}

\end{resol}

\begin{exeresol}
  Determine a função $F(x)$ tal que
  \begin{equation}
    F(x) = \int_0^x t\,dt,
  \end{equation}
  para todo $x\geq 0$. Então, mostre que $F'(x) = x$.
\end{exeresol}
\begin{resol}
  A integral definida
  \begin{equation}
    \int_0^x t\,dt
  \end{equation}
  é a área sob o gráfico de $f(t) = t$ restrita no intervalo $[0, x]$. Isto é, a área do triângulo retângulo de base $x$ e altura $x$. Logo,
  \begin{equation}
    F(x) = \int_0^x t\,dt = \frac{x\cdot x}{2} = \frac{x^2}{2}.
  \end{equation}
  Ou seja, temos $F(x) = x^2/2$ e, portanto,
  \begin{equation}
    F'(x) = \frac{1}{2}\cdot 2x = x.
  \end{equation}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x,t
F = sym.integrate(t, (t, 0, x))
print('F(x) =', F)
\end{lstlisting}

\begin{verbatim}
F(x) = x**2/2  
\end{verbatim}

\begin{lstlisting}
sym.diff(F, x)
\end{lstlisting}

\begin{verbatim}
x
\end{verbatim}

\end{resol}

\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-1}^2 2\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $6$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-3}^{-1} 1-x\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $6$
\end{resp}

\begin{exer}
  Determine $F(x)$ tal que
  \begin{equation}
    F(x) = \int_{0}^{x} t+1\,dt.
  \end{equation}
  para $x\geq 0$. Então, calcule $F'(x)$.
\end{exer}
\begin{resp}
  $\displaystyle F(x) = \frac{x^2}{2} + x$; $F'(x) = x + 1$.
\end{resp}

\begin{exer}\label{exer:int_geoRiemann}
  Faça uma interpretação geométrica da uma soma de Riemann aplicada a uma função contínua e não positiva. Estenda sua interpretação para funções contínuas arbitrárias.
\end{exer}
\begin{resp}
  Dica: a soma de Riemann é uma aproximação da área líquida sob o gráfico da função.
\end{resp}

\begin{exer}\label{exer:int_geointdef}
  Faça uma interpretação geométrica de
  \begin{equation}
    \int_a^b f(x)\,dx
  \end{equation}
  quando $f$ é uma função contínua e não positiva. Estenda sua interpretação para funções contínuas arbitrárias.
\end{exer}
\begin{resp}
  Dica: $\displaystyle \int_a^b f(x)\,dx$é a área líquida sob o gráfico da função.
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-1}^2 -1\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $-3$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-1}^{1} x\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $0$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Propriedades de integração}\label{cap_int_sec_propint}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Na Seção \ref{cap_int_sec_nocaoint}, vimos que \hl{a integral definida de uma dada função $f$ em um intervalo $[a, b]$ está associada à área (líquida) entre seu gráfico e as retas $y=0$, $x=a$ e $x=b$}. Veja a Figura \ref{fig:geointdef}.

Com base nesta noção geométrica, podemos inferir as seguintes propriedades de integração para funções integráveis $f$ e $g$:
\begin{enumerate}[a)]
\item \hl{\emph{Integral degenerada}}
  \begin{equation}\hleq
    \int_a^a f(x)\,dx = 0
  \end{equation}
\item \hl{\emph{Multiplicação por escalar}}
  \begin{equation}\hleq
    \int_a^b k\cdot f(x)\,dx = k\cdot\int_a^b f(x)\,dx
  \end{equation}
\item \hl{\emph{Soma/subtração}}
  \begin{equation}\hleq
    \int_a^b \left[f(x)\pm g(x)\right]\,dx = \int_a^b f(x)\,dx \pm \int_a^b g(x)\,dx
  \end{equation}
\item \hl{\emph{Sobreposição/concatenação de intervalos}}
  \begin{equation}\hleq
    \int_a^b f(x)\,dx = \int_a^c f(x)\,dx + \int_c^b f(x)\,dx
  \end{equation}
\item \hl{\emph{Cotas inferior e superior}}
  \begin{equation}\hleq
    \min_{x\in [a, b]} \{f(x)\}\cdot (b-a) \leq \int_a^b f(x)\,dx \leq \max_{x\in [a, b]} \{f(x)\}\cdot (b-a)
  \end{equation}
\end{enumerate}

\begin{ex}
  Sejam $f$ e $g$ funções integráveis tais que
  \begin{gather}
    \int_{-1}^4 f(x)\,dx = 2,\\
    \int_4^5 f(x)\,dx = 3,\\
    \int_{-1}^4 g(x)\,dx = -1.
  \end{gather}
  Então, vejamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      \int_{4}^{-1} g(x)\,dx &= -\int_{-1}^4 g(x)\,dx\\
      &= -(-1) = 1.
    \end{align}
  \item
    \begin{equation}
      \int_{-1}^{-1} 4f(x)\,dx = 0.
    \end{equation}
  \item
    \begin{align}
      \int_{-1}^{4} -2g(x)\,dx &= -2\int_{-1}^4 g(x)\,dx\\
                               &= 2.
    \end{align}
  \item
    \begin{align}
      \int_{-1}^{4} \left[f(x) - 2g(x)\right]\,dx &= \int_{-1}^{4} f(x)\,dx - \int_{-1}^4 2g(x)\,dx \\
                                                  &= 2 - 2\int_{-1}^4 g(x)\,dx \\
                                                  &= 2 + 2 = 4.
    \end{align}
  \item
    \begin{align}
      \int_{-1}^5 f(x)\,dx &= \int_{-1}^4 f(x)\,dx + \int_{4}^5 f(x)\,dx \\
                           &= 2 + 3 = 5.
    \end{align}
  \end{enumerate}
\end{ex}

\begin{ex}
  Lembrando que $-1 \leq \sen x \leq 1$, temos da propriedade e) acima que
  \begin{equation}
    \begin{aligned}
      &2\pi \min_{x\in [-\pi, \pi]} \{\sen(x)\} \leq \int_{-\pi}^\pi \sen(x)\,dx \leq 2\pi \max_{x\in [\-pi, \pi]} \{\sen(x)\} \\
      &\Rightarrow -2\pi \leq \int_{-\pi}^\pi \sen(x)\,dx \leq 2\pi.
    \end{aligned}
\end{equation}
\end{ex}

\subsection{Teorema do valor médio}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Com base na noção de integral, define-se \hl{a \emph{média de uma função} $f$ no intervalo $[a, b]$} por
\begin{equation}\hleq
  \frac{1}{b-a}\int_a^b f(x)\,dx,
\end{equation}
no caso de $f$ ser integrável neste intervalo.

\begin{teo}\normalfont{\hl{(Teorema do valor médio para integrais)}}\label{teo:int_teomed}
  Se $f$ for contínua em $[a, b]$, então existe $c\in [a, b]$ tal que
  \begin{equation}\hleq
    f(c) = \frac{1}{b-a}\int_a^b f(x)\,dx.
  \end{equation}
\end{teo}
\begin{dem}
  Vejamos uma ideia da demonstração. Da propriedade de integração e) acima, temos
  \begin{equation}
    \min_{x\in [a, b]} \{f(x)\} \leq \frac{1}{b-a}\int_a^b f(x)\,dx \leq \max_{x\in [a, b]} \{f(x)\}.
  \end{equation}
  Agora, pelo Teorema do valor intermediário (Teorema \ref{teo:valorintermediario}), temos $f$ assume todos os valores entre seus valores mínimo e máximo. Logo, existe $c\in [a, b]$ tal que
  \begin{equation}
    f(c) = \frac{1}{b-a}\int_a^b f(x)\,dx.
  \end{equation}  
\end{dem}

\begin{ex}
  Seja $f$ uma função contínua em $[a, b]$, $a\neq b$, e
  \begin{equation}
    \int_a^b f(x)\,dx = 0,
  \end{equation}
  então $f$ possui pelo menos um zero neste intervalo. De fato, do Teorema do valor médio para integrais, temos que existe $c\in [a, b]$ tal que
  \begin{align}
    f(c) &= \frac{1}{b-a}\int_a^b f(x)\,dx\\
         &= \frac{1}{b-a}\cdot 0 = 0.
  \end{align}
\end{ex}

\subsection{Teorema fundamental do cálculo, parte I}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Seja $f$ uma função integrável e $F$ a função definida por
\begin{equation}
  F(x) = \int_a^x f(t)\,dt,
\end{equation}
para algum número real $a$ dado.

\begin{teo}\normalfont{\hl{(Teorema fundamental do cálculo, parte I)}}\label{teo:int_tfc1}
  Se $f$ é contínua em $[a, b]$, então é contínua em $[a, b]$ e diferenciável em $(a, b)$ a função
  \begin{equation}\hleq
    F(x) = \int_a^x f(t)\,dt
  \end{equation}
  sendo
  \begin{equation}\hleq
    F'(x) = \frac{d}{dx}\int_a^x f(t)\,dt = f(x).
  \end{equation}
\end{teo}
\begin{dem}
  Vejamos a ideia da demonstração. Da definição de derivada, temos
  \begin{align}
    F'(x) &= \lim_{h\to 0} \frac{F(x+h) - F(x)}{h} \\
          &= \lim_{h\to 0} \frac{1}{h}\left[\int_a^{x+h} f(x)\,dx - \int_a^x f(x)\, dx\right] \\
          &= \lim_{h\to 0} \frac{1}{h}\int_x^{x+h} f(x)\,dx.
  \end{align}
  Agora, do Teorema do valor médio para integrais (Teorema \ref{teo:int_teomed}), temos que existe $c_h \in [x, x+h]$ tal que
  \begin{align}
    f(c_h) &= \frac{1}{x+h-x}\int_x^{x+h} f(x)\,dx \\
           &= \frac{1}{h}\int_x^{x+h} f(x)\,dx.
  \end{align}
  Notemos que $c_h\to x$ quando $h\to 0$ e, portanto, temos
  \begin{align}
    F'(x) &= \lim_{h\to 0} \frac{1}{h}\int_x^{x+h} f(x)\,dx \\
          &= \lim_{h\to 0} f(c_h) \\
          &= f(x).
  \end{align}
\end{dem}

\begin{ex}
  Vejamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{equation}
      \frac{d}{dx}\int_1^x t^2\,dt = x^2.
    \end{equation}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x,t
sym.diff(sym.integrate(t**2, (t, 1, x)))
\end{lstlisting}

\begin{verbatim}
x**2
\end{verbatim}

  \item
    \begin{equation}
      \frac{d}{dx}\int_0^x \sen(t)\,dt = \sen(x)
    \end{equation}
  \end{enumerate}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x,t  
sym.diff(sym.integrate(sym.sin(t), (t, 0, x)))
\end{lstlisting}

\begin{verbatim}
sin(x)
\end{verbatim}

\end{ex}

\subsection{Integral indefinida}

A parte I do Teorema fundamental do cálculo (Teorema \ref{teo:int_tfc1}), mostra que \hl{a integral de uma função $f$ (contínua) é uma função $F$ tal que}
\begin{equation}\hleq
  F'(x) = f(x).
\end{equation}
Dizemos que \hl{$F$ é uma \emph{primitiva} da função $f$}.

Observamos que se $F$ é uma primitiva de $f$, então
\begin{equation}
  G(x) = F(x) + C
\end{equation}
também é primitiva de $f$ para qualquer constante $C$, i.e.
\begin{align}
  G'(x) &= (F(x) + C)' \\
        &= F'(x) + (C)' \\
        &= f(x) + 0 \\
        &= f(x).
\end{align}
Mais ainda, do Corolário \ref{corol:apderiv_teomed_2} do Teorema do valor médio para derivadas, temos que quaisquer duas primitivas de uma mesma função diferem-se apenas uma constante.

Com isso, definimos \hl{a \emph{integral indefinida} de $f$ em relação a $x$} por
\begin{equation}\hleq
  \int f(x)\,dx = F(x) + C,
\end{equation}
\hl{onde $F$ é qualquer primitiva de $f$ e $C$ uma constante indeterminada}.

\begin{ex}
  Vejamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{equation}
      \int \,dx = x + C
    \end{equation}
  \item
    \begin{equation}
      \int 2x\,dx = x^2 + C
    \end{equation}
  \item
    \begin{equation}
      \int \cos(x)\,dx = \sen(x) + C
    \end{equation}
  \item
    \begin{equation}
      \int e^x\,dx = e^x + C
    \end{equation}
  \end{enumerate}
  \ifispython
  Com o {\python}+{\sympy}, podemos computar as integrais indefinidas acima com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    In : x = symbols('x')
    >>> # a)
    >>> integrate(1, x)
    >>> 
     x
    # b)
    In : integrate(2*x, x)
    >>> 
     x**2
    # c)
    In : integrate(cos(x), x)
    >>> 
     sin(x)
    # d)
    In : integrate(exp(x), x)
     exp(x)
  \end{lstlisting}
  \fi  
\end{ex}

\subsection{Teorema fundamental do cálculo, parte II}

\begin{teo}\normalfont{\hl{(Teorema fundamental do cálculo, parte II)}}\label{teo:int_tfc2}
  Se $f$ é contínua em $[a, b]$ e $F$ é qualquer primitiva de $f$, então
  \begin{equation}
    \int_a^b f(x)\,dx = F(b) - F(a).
  \end{equation}
\end{teo}
\begin{dem}
  Vejamos a ideia da demonstração. A parte I do Teorema fundamental do cálculo (Teorema \ref{teo:int_tfc1}), nos garante a existência de
  \begin{equation}
    G(x) = \int_a^x f(t)\,dt.
  \end{equation}
  Seja, então, $F$ uma primitiva qualquer de $f$. Logo,
  \begin{align}
    F(b) - F(a) &= [G(b) + C] - [G(a) + C] \\
                &= G(b) - G(a) \\
                &= \int_a^b f(t)\,dx - \int_a^a f(t)\,dt \\
                &= \int_a^b f(t)\,dx.
  \end{align}
\end{dem}

\begin{ex}
  Vejamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      \int_0^1 \,dx &= \left. x \right|_0^1 \\
                    &= 1 - 0 = 1
    \end{align}
  \item
    \begin{align}
      \int_0^1 x\,dx &= \left.\frac{x^2}{2}\right|_0^1\\
                     &= \frac{1^2}{2}-\frac{0^2}{2} = \frac{1}{2}
    \end{align}
  \item
    \begin{align}
      \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} \cos(x)\,dx &= \left.\sen(x)\right|_{-\frac{\pi}{2}}^{\frac{\pi}{2}}\\
                                                        &= \sen\left(\frac{\pi}{2}\right) - \sen\left(-\frac{\pi}{2}\right) \\
                                                        &= 2
    \end{align}
  \end{enumerate}
  \ifispython
  Com o {\python}+{\sympy}, podemos computar as integrais indefinidas acima com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> # a)
    >>> integrate(1, (x,0,1))
     1
    ..: # b)
    In : integrate(x, (x,0,1))
     1/2
    ..: c)
    In : integrate(cos(x), (x,-pi/2,pi/2))
     2
  \end{lstlisting}
  \fi  
\end{ex}

\begin{obs}\normalfont{\hl{(Permutação dos limites de integração.)}}
  Do Teorema fundamental do cálculo, parte II, temos
  \begin{equation}\hleq
    \int_a^b f(x)\,dx = - \int_b^a f(x)\,dx.
  \end{equation}
    Ou seja, o \hl{valor da integral definida muda de sinal ao permutarmos seus limites de integração}. De fato, se $F$ é uma primitiva de $f$, então
  \begin{align}
    \int_a^b f(x)\,dx &= F(b) - F(a) \\
                      &= - \left[F(a) - F(b)\right] \\
                      &= - \int_b^a f(x)\,dx.
  \end{align}
\end{obs}

\begin{ex}
  Temos que
  \begin{equation}
    \int_0^1 dx = \left. x\right|_0^1 = 1 - 0 = 1.
  \end{equation}
  Agora,
  \begin{equation}
    \int_1^0 dx = \left. x\right|_1^0 = 0 - 1 = -1.
  \end{equation}
  Conforme esperado, temos
  \begin{equation}
    \int_0^1 dx = - \int_1^0 dx.
  \end{equation}
\end{ex}

\subsection{Exercícios resolvidos}

% \begin{flushright}
%   [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
% \end{flushright}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int_1^{\sqrt{e}} x - \frac{1}{x}\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Primeiramente, notemos que
  \begin{align}
    & \int x\,dx = \frac{x^2}{2} + C,\\
    & \int \frac{1}{x}\,dx = \ln x + C.
  \end{align}
  Então, usando as propriedades de integração, temos
  \begin{align}
    \int_1^{\sqrt{e}} x - \frac{1}{x}\,dx &= \int_1^{\sqrt{e}} x\,dx - \int_1^{\sqrt{e}} \frac{1}{x}\,dx \\
                                 &= \left[\frac{x^2}{2}\right]_1^{\sqrt{e}} - \left[\ln x\right]_1^{\sqrt{e}} \\
                                          &= \left[\frac{(\sqrt{e})^2}{2} - \frac{1}{2}\right] - \left[\ln\sqrt{e} - \ln 1\right]\\
                                          &= \frac{e}{2} - \frac{1}{2} - \frac{1}{2}\ln(e) - 0 \\
                                          &= \frac{e}{2} - 1.
  \end{align}
  \ifispython
  Com o {\python}+{\sympy}, podemos computar essa integral definida com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> integrate((x - 1/x), (x,1,sqrt(E)))
     -1 + E/2
  \end{lstlisting}
  \fi  
\end{resol}

\begin{exeresol}
  Calcule a área entre o gráfico de $f(x) = \sen(x)$ e as retas $y=0$, $x=-\pi/2$ e $x=\pi/2$.
\end{exeresol}
\begin{resol}
  Lembrando que a integral definida está associada a área sob o gráfico do integrando, temos que a área desejada pode ser calculada por
  \begin{equation}
    A = - \int_{-\frac{\pi}{2}}^0 \sen(x)\,dx + \int_0^{\frac{\pi}{2}} \sen(x)\,dx,
  \end{equation}
  pois $\sen(x) < 0$ para $x\in (-\pi/2, 0)$ e $\sen(x) > 0$ para $x\in (0, \pi/2)$.
  Também, observamos que
  \begin{equation}
    \int \sen(x)\,dx = -\cos(x) + C.
  \end{equation}
  Logo, do Teorema fundamental do cálculo segue que
  \begin{align}
    A &= - \int_{-\frac{\pi}{2}}^0 \sen(x)\,dx + \int_0^{\frac{\pi}{2}} \sen(x)\,dx \\
      &= -\left[-\cos(x)\right]_{-\frac{\pi}{2}}^0 + \left[-\cos(x)\right]_0^{\frac{\pi}{2}} \\
      &= -[-1 - 0] + [-0 - (-1)] = 2. 
  \end{align}
  \ifispython
  Com o {\python}+{\sympy}, podemos computar essa integral definida com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> A = -integrate(sin(x), (x,-pi/2,0))
    >>> A += integrate(sin(x), (x,0,pi/2))
    >>> A
     2
  \end{lstlisting}
  \fi  
\end{resol}

\begin{exeresol}
  Encontre a função $y = y(x)$ tal que
  \begin{equation}
    \frac{dy}{dx} = x,
  \end{equation}
  e $y(0) = 1$.
\end{exeresol}
\begin{resol}
  Integrando ambos os lados da equação diferencial em relação a $x$, temos
  \begin{gather}
    \int \frac{dy}{dx}\,dx = \int x\,dx \\
    y = \frac{x^2}{2} + C \\
  \end{gather}
  Agora, da condição $y(0) = 1$, segue
  \begin{gather}
    y(0) = 1 \\
    \frac{0^2}{2} + C = 1 \\
    C = 1.
  \end{gather}
  Concluímos que $y = x^2/2 + 1$.
  \ifispython
  Com o {\python}+{\sympy}, podemos resolver esta computar essa integral definida com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    >>> y = Function('y')
    >>> x = symbols('x')
    >>> dsolve(Eq(diff(y(x),x), x), y(x), ics={y(0):1})
     Eq(y(x), x**2/2 + 1)
  \end{lstlisting}
  \fi  
\end{resol}

\subsection{Exercícios}

\begin{exer}
  Sejam $f$ e $g$ tais que
  \begin{align}
    &\int_{-2}^{0} f(x)\,dx = -2,\quad\int_{-1}^{0} f(x)\,dx = \frac{1}{2},\\
    &\int_{-2}^0 g(x)\,dx = 1.
  \end{align}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int_{-1}^{-1} f(x) - 51\cdot g(x)\,dx$
  \item $\displaystyle \int_{-2}^{0} 2g(x) - \frac{1}{2}f(x)\,dx$
  \item $\displaystyle \int_{-2}^{-1} f(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$0$; b)~$3$; c)~$-5/2$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle\int_{-1}^2 2\,dx$
  \item $\displaystyle\int_{-3}^{-1} 1-x\,dx$
  \item $\displaystyle\int_{1}^{e} \frac{2}{x}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$6$; b)~$6$; c)~$2$
\end{resp}

\begin{exer}
  Calcule a área entre o gráfico de $f(x) = x^2-1$ e as retas $y=0$, $x=0$ e $x=2$.
\end{exer}
\begin{resp}
  $4/3$
\end{resp}

\begin{exer}
  Encontre a função $y = y(x)$ tal que
  \begin{equation}
    \frac{dy}{dx} = \cos(x),
  \end{equation}
  e $y(\pi) = 1$.
\end{exer}
\begin{resp}
  $y = \sen(x) + 1$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Regras Básicas de Integração}\label{cap_int_sec_regrasbasic}

A \hl{integral indefinida} de uma função $f$ em relação a $x$ é
\begin{equation}\hleq
  \int f(x)\,dx = F(x) + C,
\end{equation}
onde \hl{$F$ é uma \emph{primitiva} de $f$}, i.e. \hl{$F' = f$, e $C$ é uma \emph{constante indeterminada}}. Na sequência, vamos estudar as regras básicas para o cálculo de integrais.

\subsection{Integral de Função Potência}

Com base na derivada de \hl{função potência}, podemos afirmar que
\begin{equation}\label{eq:int_fpot}\hleq
  \int x^r\,dx = \frac{x^{r+1}}{r+1} + C, ~r\neq -1.
\end{equation}
De fato, para $r\neq -1$, temos
\begin{align}
  & F(x) = \frac{x^{r+1}}{r+1} + C, \\
  & F'(x) = (r+1) \frac{x^r}{r+1} = x^r.
\end{align}

\begin{ex}
  Estudamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{equation}
      \int x\,dx = \frac{x^2}{2} + C.
    \end{equation}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(x, x)
\end{lstlisting}

\begin{verbatim}
x**2/2
\end{verbatim}

  \item
    \begin{align}
      & \int \frac{1}{x^2}\,dx = \int x^{\color{blue}-2}\,dx \\
      &\text{}\qquad = \frac{x^{{\color{blue}-2}+1}}{{\color{blue}-2}+1} + C = -\frac{1}{x}+C.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(1/x**2, x)
\end{lstlisting}

\begin{verbatim}
-1/x
\end{verbatim}

  \end{enumerate}
\end{ex}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_{-1}^1 x^2\,dx.
  \end{equation}
  Da regra da potência \eqref{eq:int_fpot}, temos
  \begin{equation}
    \int x^2\,dx = \frac{x^3}{3} + C.
  \end{equation}
  Logo, do teorema fundamental do cálculo, temos
  \begin{align}
    & \int_{-1}^1 x^2\,dx = \left.\frac{x^3}{3}\right|_{-1}^1 \\
    &\text{}\qquad = \frac{1^3}{3} - \frac{(-1)^3}{3} \\
    &\text{}\qquad = \frac{1}{3} + \frac{1}{3} = \frac{2}{3}.
  \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(x**2, (x, -1, 1))
\end{lstlisting}

\begin{verbatim}
2/3
\end{verbatim}

\end{ex}

\subsection{Regra da Multiplicação por Constante}

Seja $k$ uma constante. Então, temos a seguinte \hlemph{regra da multiplicação por constante}
\begin{equation}\label{eq:regra_mult_por_const}\hleq
  \int k\cdot f(x)\,dx = k\cdot \int f(x)\,dx
\end{equation}
De fato, se $F$ é uma primitiva de $f$, então pela regra da multiplicação por constante para derivadas, temos
\begin{align}
  & (k\cdot F)' = k\cdot F'\\
  &\text{}\qquad = k\cdot f,
\end{align}
i.e. $k\cdot F$ é primitiva de $k\cdot f$.

\begin{ex}
  Estudamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      & \int 2x\,dx = 2\int x\,dx\\
      &\text{}\qquad = 2\left(\frac{x^2}{2} + C\right)\\
      &\text{}\qquad = x^2 + 2C\\
      &\text{}\qquad = x^2 + C.
    \end{align}
    Aqui, fizemos um abuso de linguagem ao assumir \hl{$2C = C$}. Isso pode ser feito, pois $C$ denota uma constante indeterminada e, multiplicá-la por dois continua sendo indeterminada e constante. Vamos fazer este tipo de \hl{simplificação de notação} várias vezes ao longo do texto.

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(2*x, x)
\end{lstlisting}

\begin{verbatim}
x**2
\end{verbatim}

\item
    \begin{align}
      & \int \frac{1}{3}\sqrt{x}\,dx = \frac{1}{3}\int x^{\frac{1}{2}}\,dx\\
      &\text{}\qquad = \frac{1}{3}\frac{x^{\frac{1}{2}+1}}{\frac{1}{2}+1} + C\\
      &\text{}\qquad = \frac{1}{3}\frac{x^{\frac{3}{2}}}{\frac{3}{2}} + C\\
      &\text{}\qquad = \frac{2}{9}\sqrt{x^3} + C.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(1/3*sym.sqrt(x), x)
\end{lstlisting}

\begin{verbatim}
0.222222222222222*x**(3/2)
\end{verbatim}

  \item
    \begin{align}
      & \int_0^{1}-x^2\,dx = -\int_0^1x^2\,dx \\
      &\text{}\qquad = -\left[\frac{x^3}{3}\right]_0^1 \\
      &\text{}\qquad = -\left(\frac{1}{3} - \frac{0}{3}\right) \\
      &\text{}\qquad = -\frac{1}{3}.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(-x**2, (x, 0, 1))
\end{lstlisting}

\begin{verbatim}
-1/3
\end{verbatim}

  \end{enumerate}

\end{ex}

\subsection{Regra da soma ou subtração}

Se $f$ e $g$ são funções integráveis, então vale a seguinte \hl{\emph{regra da soma/subtração}}
\begin{equation}\label{cap_int_sec_regrasbasias:eq:regra_soma}\hleq
  \int \left[f(x)\pm g(x)\right]\,dx = \int f(x)\,dx \pm \int g(x)\,dx.
\end{equation}
De fato, sejam $F$ uma primitiva de $f$ e $G$ uma primitiva de $g$. Temos
\begin{align}
  & (F \pm G)' = F' \pm G'\\
  &\text{}\qquad = f \pm g,
\end{align}
i.e. $F \pm G$ é primitiva de $f\pm g$.

\begin{ex}
  Estudamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      & \int {\color{blue}x} + {\color{red}1}\,dx = {\color{blue}\int x\,dx} + {\color{red}\int dx}\\
      &\text{}\qquad = {\color{blue}\frac{x^2}{2} + C_1} + {\color{red}x + C_2}\\
      &\text{}\qquad = \frac{x^2}{2} + x + C.
    \end{align}
    Aqui, $C_1$, $C_2$ e $C = C_1+C_2$ denotam constantes indeterminadas.

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(x+1, x)
\end{lstlisting}

\begin{verbatim}
x**2/2 + x
\end{verbatim}

  \item 
    \begin{align}
      & \int {\color{blue}\sqrt{x}} - {\color{red}x}\,dx = {\color{blue}\int x^{\frac{1}{2}}\,dx} - {\color{red}\int x\,dx}\\
      &\text{}\qquad = {\color{blue}\frac{2}{3}x^{\frac{3}{2}}} - {\color{red}\frac{x^2}{2}} + C.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
f = sym.sqrt(x) - x
sym.integrate(f, x)
\end{lstlisting}

\begin{verbatim}
2*x**(3/2)/3 - x**2/2
\end{verbatim}

  \item
      \begin{align}
      & \hleq{\int (2x^2 + 3x - 1)\,dx} = \int \left[2x^2 + (3x - 1)\right]\,dx\\
      &\text{}\quad = \int 2x^2\,dx + \int 3x - 1 \,dx \\
      &\text{}\quad = \hleq{\int 2x^2\,dx - \int 3x\,dx - \int \,dx}\\
      &\text{}\quad = 2\int x^2\,dx + 3\int x\,dx - \int \,dx\\
      &\text{}\quad = \frac{2}{3}x^3 + \frac{3}{2}x^2 - x + C.
      \end{align}

    \end{enumerate}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
f = 2*x**2 + 3*x - 1
sym.integrate(f, x)
\end{lstlisting}

\begin{verbatim}
2*x**3/3 + 3*x**2/2 - x
\end{verbatim}
\end{ex}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_{0}^1 x^2 + 1\,dx.
  \end{equation}
  Temos
  \begin{align}
    & \int x^2 + 1\,dx = \int x^2\,dx + \int \,dx\\
    &\text{}\qquad = \frac{x^3}{3} + x + C.
  \end{align}
  Agora, do teorema fundamental do cálculo, temos
  \begin{align}
    & \int_0^1 x^2+1\,dx = \left. \frac{x^3}{3} + x\right|_0^1 \\
    &\text{}\qquad = \left(\frac{1}{3} + 1 \right)- \left(\frac{0^3}{3} + 0\right) \\
    &\text{}\qquad = \frac{4}{3}.
  \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(x**2 + 1, (x, 0, 1))
\end{lstlisting}

\begin{verbatim}
4/3
\end{verbatim}

\end{ex}

\subsection{Integral de $x^{-1}$}

Começamos lembrando que
\begin{equation}
  \frac{d}{dx}\ln x = \frac{1}{x}, ~x>0.
\end{equation}
Para $x < 0$, usamos a regra da cadeia
\begin{align}
  & \frac{d}{dx}\ln(-x) = \frac{1}{-x}\cdot (-x)'\\
  &\text{}\qquad = -\frac{1}{x}\cdot (-1)\\
  &\text{}\qquad = \frac{1}{x}.
\end{align}
Ou seja, temos que 
\begin{equation}
  \frac{d}{dx}\ln|x| = \frac{1}{x},
\end{equation}
donde concluímos que a \hlemph{integral de $x^{-1}$} é
\begin{equation}\hleq
  \int\frac{1}{x}\,dx = \ln|x| + C.
\end{equation}

\begin{ex}

  \begin{align}
    & \int_1^e x^{-1}\,dx = \int_1^e \frac{1}{x}\,dx\\
    &\text{}\qquad = \left[ \ln|x|\right]_1^e \\
    &\text{}\qquad = \ln|e| - \ln|1| \\
    &\text{}\qquad = 1 - 0 = 1.
  \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(1/x, (x, 1, sym.E))
\end{lstlisting}

\begin{verbatim}
1
\end{verbatim}
  
\end{ex}

\subsection{Integral da Função Exponencial Natural}\label{cap_int_subsec_funexp}

Da derivada da \hl{função exponencial natural}, temos
\begin{equation}\hleq
  \int e^x\,dx = e^x + C.
\end{equation}

\begin{ex}
  Vamos estudar os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      & \int e^{2 + x}\,dx = \int e^2e^x\,dx \\
      &\text{}\qquad = e^2\int e^x\,dx \\
      &\text{}\qquad = e^2e^x + C \\
      &\text{}\qquad = e^{2+x} + C.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(sym.exp(2+x), x)
\end{lstlisting}

\begin{verbatim}
exp(x + 2)  
\end{verbatim}

  \item
    \begin{align}
      & \int_{0}^{\ln 2}e^x\,dx = \left. e^x\right|_0^{\ln 2}\\
      &\text{}\qquad = e^{\ln 2} - e^0\\
      &\text{}\qquad = 2 - 1\\
      &\text{}\qquad = 1.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(sym.exp(x), (x, 0, sym.log(2)))
\end{lstlisting}

\begin{verbatim}
1
\end{verbatim}

\end{enumerate}
\end{ex}

\subsection{Integrais de Funções Trigonométricas}\label{cap_int_sec_regrasbasic_trigo}

No que lembramos que
\begin{equation}
  \frac{d}{dx}\cos(x) = -\sen(x)
\end{equation}
temos que a \hlemph{integral da função seno} é
\begin{equation}\hleq
  \int \sen(x)\,dx = -\cos(x) + C.
\end{equation}

\begin{ex}
  Estudamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      & \int 2\sen(x)\,dx = 2\int \sen(x) dx\\
      &\text{}\qquad = -2\cos(x) + C
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(2*sym.sin(x), x)
\end{lstlisting}

\begin{verbatim}
-2*cos(x)
\end{verbatim}

  \item
    \begin{align}
      & \int_{-\pi}^\pi\sen(x)\,dx = \left.-\cos(x)\right|_{-\pi}^\pi\\
      &\text{}\qquad = -\cos(\pi) - [-\cos(-\pi)]\\
      &\text{}\qquad = 1 - 1 = 0
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(sym.sin(x), (x, -sym.pi, sym.pi))
\end{lstlisting}

\begin{verbatim}
0
\end{verbatim}

  \end{enumerate}
\end{ex}

Também, lembramos que
\begin{equation}
  \frac{d}{dx}\sen(x) = \cos(x),
\end{equation}
donde temos que a \hl{\emph{integral da função cosseno}}
\begin{equation}\hleq
  \int \cos(x)\,dx = \sen(x) + C.
\end{equation}

\begin{ex}
  Estudamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      & \int \frac{1}{2}\cos(x)\,dx = \frac{1}{2}\int\cos(x)\,dx \\
      &\text{}\qquad = \frac{1}{2}\sen(x) + C. \\
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(1/2*sym.cos(x), x)
\end{lstlisting}

\begin{verbatim}
0.5*sin(x)
\end{verbatim}

  \item
    \begin{align}
      & \int_{-\pi}^\pi\cos(x)\,dx = \left.\sen(x)\right|_{-\pi}^\pi\\
      &\text{}\qquad = \sen(\pi) - \sen(-\pi)\\
      &\text{}\qquad = 0.
    \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(sym.cos(x), (x, -sym.pi, sym.pi))
\end{lstlisting}

\begin{verbatim}
0
\end{verbatim}

  \end{enumerate}

\end{ex}

\subsection{Tabela de Integrais}

\begin{align}
  & \int k\cdot f(x)\,dx = k\cdot\int f(x)\,dx\\
  & \int \left[f(x)\pm g(x)\right]\,dx = \int f(x)\,dx \pm \int g(x)\,dx\\
  & \int x^r\,dx = \frac{x^{r+1}}{r+1} + C,\quad r\neq -1\\
  & \int \frac{1}{x}\,dx = \ln x + C \\
  & \int e^x\,dx = e^x + C \\
  & \int \sen(x)\,dx = -\cos(x) + C \\
  & \int \cos(x)\,dx = \sen(x) + C
\end{align}

\subsection{Exercícios resolvidos}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int \frac{x^2+2x}{\sqrt{x}}\,dx
  \end{equation}
\end{exeresol}
\begin{resol}
  \begin{align}
    & \int \frac{x^2+2x}{\sqrt{x}}\,dx = \int \frac{x^2}{\sqrt{x}} + 2\frac{x}{\sqrt{x}}\,dx\\
    &\text{}\qquad = \int \frac{x^2}{x^{\frac{1}{2}}} + 2\frac{x}{x^{\frac{1}{2}}}\,dx\\
    &\text{}\qquad = \int x^{2-\frac{1}{2}} + 2x^{1-\frac{1}{2}}\,dx\\
    &\text{}\qquad = \int x^{\frac{3}{2}}\,dx + 2\int x^{\frac{1}{2}}\,dx.
  \end{align}
  Agora, usando a \emph{regra da função potência} \eqref{eq:int_fpot}, obtemos
  \begin{align}
    & \int \frac{x^2+2x}{\sqrt{x}}\,dx = \frac{x^{\frac{3}{2}+1}}{\frac{3}{2}+1} + 2\frac{x^{\frac{1}{2}+1}}{\frac{1}{2}+1} + C \\
    &\text{}\qquad = \frac{2}{5}x^{\frac{5}{2}} + \frac{4}{3}x^{\frac{3}{2}} + C.
  \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate((x**2+2*x)/(sqrt(x)))
\end{lstlisting}

\begin{verbatim}
2*x**(5/2)/5 + 4*x**(3/2)/3
\end{verbatim}

\end{resol}


\begin{exeresol}
  Calcule
  \begin{equation}
    \int_1^{e} \frac{1}{2x}\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Das regras básicas de integração, temos
  \begin{align}
    & \int \frac{1}{2x}\,dx = \int \frac{1}{2}\cdot\frac{1}{x}\,dx \\
    &\text{}\qquad = \frac{1}{2}\int\frac{1}{x}\,dx \\
    &\text{}\qquad = \frac{1}{2}\ln(x) + C \\
    &\text{}\qquad = \ln\sqrt{x} + C.
  \end{align}
  Então, do teorema fundamental do cálculo, temos
  \begin{align}
    & \int_1^e \frac{1}{2x}\,dx = \left.\ln\sqrt{x}\right|_1^e\\
    &\text{}\qquad = \ln(\sqrt{e}) - \ln(1)\\
    &\text{}\qquad = \frac{1}{2}.
  \end{align}

\begin{lstlisting}
import sympy as sym
from sympy.abc import x
sym.integrate(1/(2*x), (x, 1, sym.E))
\end{lstlisting}

\begin{verbatim}
1/2
\end{verbatim}

\end{resol}


\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int \,dx$
  \item $\displaystyle \int x^{-2}\,dx$
  \item $\displaystyle \int \sqrt{x}\,dx$
  \item $\displaystyle \int \frac{1}{\sqrt{x}}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\displaystyle x + C$; b)~$\displaystyle -\frac{1}{x} + C$; c)~$\displaystyle \frac{2}{3}x^{3/2} + C$; d)~$\displaystyle 2x^{1/2} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int 1 + x^{-2}\,dx$
  \item $\displaystyle \int x - \frac{1}{x}\,dx$
  \item $\displaystyle \int 2x^3 - 3x^2 + 1\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\displaystyle x-\frac{1}{x}+C$; b)~$\displaystyle \frac{x^2}{2} - \ln|x| + C$; c) $\displaystyle \frac{1}{2}x^4 - x^3 + x + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int 2\cos(x)\,dx$
  \item $\displaystyle \int 1 - \sen(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\displaystyle 2\sen(x) + C$; b)~$\displaystyle x + \cos(x) + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int_{-1}^1 x^3\,dx$
  \item $\displaystyle \int_e^{2e} x^{-1}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $0$; b) $\ln(2)$;
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}
  \item $\displaystyle \int_0^1 x^2 - 2x^3\,dx$
  \item $\displaystyle \int_1^2 \frac{x+1}{\sqrt{x}}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\displaystyle -\frac{1}{6}$; b) $\displaystyle \frac{10}{3}\sqrt{2} - \frac{8}{3}$;
\end{resp}

\begin{exer}
  Cálculo
  \begin{enumerate}[a)]
  \item $\displaystyle \int_0^{\frac{\pi}{2}}\sen(x)\,dx$
  \item $\displaystyle \int_0^{\frac{\pi}{2}}\cos(x)\,dx$
  \item $\displaystyle \int_0^{\pi}\cos(x)-\sen(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $1$; b) $1$; c) $-2$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Integração por substituição}\label{cap_int_sec_subs}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Seja $u = u(x)$. A regra de integração por substituição é
\begin{equation}
  {\color{blue}\int f(u(x))u'(x)\,dx = \int f(u)\,du}.
\end{equation}
De fato, se
\begin{equation}
  \int f(u)\,du = F(u) + C,
\end{equation}
então, da \emph{regra da cadeira}\footnote{Consulte a Seção \ref{cap_deriv_sec_cadeia} para mais informações sobre a regra da cadeia.}, temos
\begin{align}
  \frac{d}{dx}F(u(x)) &= F'(u(x))u'(x) \\
                      &= f(u(x))u'(x),
\end{align}
i.e. $F(u(x))$ é primitiva de $f(u(x))u'(x)$.

\begin{ex}
  Vamos aplicar integração por substituição para calcular as seguintes integrais:
  \begin{enumerate}[a)]
  \item $\displaystyle\int (x+1)^2\,dx$.

    Escolhemos
    \begin{equation}
      {\color{blue}u = x + 1}
    \end{equation}
    donde
    \begin{gather}
      \frac{du}{dx} = 1\\
      {\color{blue}du = dx}
    \end{gather}
    Fazendo a substituição na integral, obtemos
    \begin{align*}
      \int (x+1)^2\,dx &= \int \underbrace{u^2}_{f(u)}\,du\\
                       &= \frac{u^3}{3} + C
    \end{align*}
    Agora, substituindo de volta $u = x+1$, concluímos que
    \begin{equation}
      \int (x+1)^2\,dx = \frac{(x+1)^3}{3} + C
    \end{equation}

  \item $\displaystyle \int 2\sqrt{2x+1}\,dx$
    Escolhemos
    \begin{equation}
      {\color{blue}u = 2x+1}
    \end{equation}
    e calculamos
    \begin{gather}
      \frac{du}{dx} = 2x\\
      {\color{blue}du = 2\,dx}
    \end{gather}
    Substituindo na integral, obtemos
    \begin{align*}
      \int 2\sqrt{2x+1}\,dx &= \int \sqrt{2x+1}\cdot 2\,dx\\
                            &= \int \sqrt{u}\,du\\
                            &= \int u^{\frac{1}{2}}\,du\\
                            &= \frac{2}{3}u^{\frac{3}{2}} + C\\
                            &= \frac{2}{3}\sqrt{(2x+1)^3} + C
    \end{align*}
    
  \item $\displaystyle\int \pi\sen(\pi x)\,dx$.

    Escolhemos
    \begin{equation}
      u = \pi x
    \end{equation}
    e calculamos
    \begin{equation}
      du = \pi\,dx
    \end{equation}
    Por substituição, obtemos
    \begin{align}
      \int \pi\sen(\pi x)\,dx &= \int \sen(u)\,du \\
                              &= -\cos(u) + C \\
                              &= -\cos(\pi x) + C.
    \end{align}
  \end{enumerate}
\end{ex}

Observe que ao escolhermos $u = u(x)$, sua derivada $u'(x)$ também precisa estar no integrando. Uma exceção é o caso em que $u'(x)\equiv k$ é constante. Neste, podemos multiplicar o integrando por $k/k$ e usar a regra da multiplicação por escalar.

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int (2x+1)^2\,dx.
  \end{equation}
  Substituindo
  \begin{equation}
    u = 2x+1
  \end{equation}
  temos
  \begin{equation}
    du = 2\,dx
  \end{equation}
  Por substituição, obtemos
  \begin{align}
    \int (2x+1)^2\,dx &= \int (2x+1)^2\cdot \frac{2}{2}\,dx\\
                      &= \frac{1}{2}\int (2x+1)^2\cdot 2\,dx\\
                     &= \frac{1}{2}\int u^2\,du\\
                     &= \frac{u^3}{6} + C\\
                     &= \frac{1}{6}(2x+1)^3 + C.
  \end{align}

  Outra forma equivalente de calcularmos, é observarmos que
  \begin{gather}
    du = 2\,dx \\
    \Rightarrow {\color{blue}dx = \frac{du}{2}}
  \end{gather}
  Então, ao fazermos a substituição $u = 2x+1$ na integral original, obtemos
  \begin{align}
    \int (2x+1)^2\,dx &= \int u^2\,\frac{du}{2}\\
                      &= \frac{1}{2}\int u^2\,du\\
                      &= \frac{u^3}{6} + C\\
                      &= \frac{(2x+1)^3}{6} + C
  \end{align}
\end{ex}


\subsection{Integral de função exponencial}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Na Subseção \ref{cap_int_subsec_funexp}, vimos que
\begin{equation}
  \int e^x\,dx = e^x + C
\end{equation}
Agora, com a regra da substituição, temos
\begin{align}
  \int a^x\,dx &= \int e^{\ln a^x}\,dx \\
               &= \int e^{x\ln a}\,dx,
\end{align}
com $a>0$ e $a\neq 1$. Tomando
\begin{gather}
  u = x\ln a\\
  \Rightarrow du = \ln(a)dx.
\end{gather}
Segue que
\begin{align}
  \int a^x\,dx &= \int e^u\,\frac{du}{\ln a} \\
               &= \frac{1}{\ln a}\int e^u\,du \\
               &= \frac{e^u}{\ln a} + C \\
               &= \frac{e^{x\ln a}}{\ln a} + C \\
               &= \frac{e^{\ln a^x}}{\ln a} + C \\
               &= \frac{a^x}{\ln a} + C.
\end{align}
Ou seja, concluímos que
\begin{equation}
  {\color{blue}\int a^x\,dx = \frac{a^x}{\ln a} + C}.
\end{equation}

\begin{ex}
  Estudamos os seguintes casos:
  \begin{enumerate}[a)]
  \item
    \begin{align}
      \int 2^x\,dx = \frac{2^x}{\ln 2} + C
    \end{align}
  \item
    \begin{equation}
      \int \sqrt{2^x}\,dx = \int 2^{\frac{x}{2}}\,dx
    \end{equation}
    Escolhendo
    \begin{gather}
      u = \frac{x}{2}\\
      \Rightarrow du = \frac{dx}{2}
    \end{gather}
    Por substituição, obtemos
    \begin{align}
      \int \sqrt{2^x}\,dx &= \int 2^{\frac{x}{2}}\,dx\\
                          &= \int 2^u\,\frac{du}{2}\\
                          &= \frac{1}{2}\int 2^u\,du\\
                          &= \frac{1}{2}\frac{2^{\frac{x}{2}}}{\ln 2} + C\\
                          &= \frac{\sqrt{2^x}}{2\ln 2} + C
    \end{align}
  \item
    \begin{equation}
      \int_1^{\sqrt{2}} x\cdot 2^{x^2}\,dx.
    \end{equation}
    Por substituição, tomamos
    \begin{gather}
      u = x^2\\
      \Rightarrow du = 2x\,dx,
    \end{gather}
    segue
    \begin{align}
      \int x\cdot 2^{x^2}\,dx &= \int \cdot 2^{u}\frac{du}{2} \\
                              &= \frac{1}{2}\int \cdot 2^{u}\,du \\
                              &= \frac{1}{2}\frac{2^u}{\ln 2} + C \\
                              &= \frac{1}{2}\frac{2^{x^2}}{\ln 2} + C
    \end{align}
    Então, pelo Teorema Fundamental do Cálculo, concluímos que
    \begin{align}
      \int_1^{\sqrt{2}} x\cdot 2^{x^2}\,dx &= \left.\frac{1}{2}\frac{2^{x^2}}{\ln 2}\right|_1^{\sqrt{2}}\\
                                           &= \frac{1}{2\ln 2}\left[2^{x^2}\right]_1^{\sqrt{2}}\\
                                           &= \frac{1}{2\ln 2}\left[2^{(\sqrt{2})^2}-2^{1^2}\right]\\
                                           &= \frac{1}{2\ln 2}\left[2^{2}-2\right]\\
                                           &= \frac{1}{\ln 2}
    \end{align}
  \end{enumerate}
  \ifispython
  Verifique computando as integrais com o {\python}+{\sympy}!
  \fi
\end{ex}

\subsection{Integral de funções trigonométricas}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Na Seção \ref{cap_int_sec_regrasbasic_trigo}, vimos que
\begin{align}
  &\int \sen(x)\,dx = -\cos(x) + C \quad\text{e}\\
  &\int \cos(x)\,dx = \sen(x) + C.
\end{align}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int \sen^2(x)\,dx.
  \end{equation}
  Usando a identidade trigonométrica
  \begin{equation}
    \sen^2(x) = \frac{1 - \cos(2x)}{2},
  \end{equation}
  temos
  \begin{align}
    \int \sen^2(x)\,dx &= \int \frac{1-x\cos(2x)}{2}\,dx \\
                       &= \frac{1}{2}\int dx - \frac{1}{2}\int\cos(2x)\,dx.\label{int_subs_aux1}
  \end{align}
  Agora, tomando $u = 2x$, temos $du = 2\,dx$, donde
  \begin{align}
    \int \cos(2x)\,dx &= \int\cos(u)\frac{du}{2} \\
                      &= \frac{1}{2}\sen(u) + C \\
                      &= \frac{1}{2}\sen(2x) + C.
  \end{align}
  Retornando a \ref{int_subs_aux1}, obtemos
  \begin{align}
    \int \sen^2(x)\,dx &= \frac{x}{2} - \frac{\sen(2x)}{4} + C.
  \end{align}
\end{ex}

Agora, afirmamos que 
\begin{equation}
  {\color{blue}\int \tg(x)\,dx = \ln|\sec(x)| + C}.
\end{equation}
De fato, no que observamos que
\begin{equation}
  \int \tg(x)\,dx = \int \frac{\sen(x)}{\cos(x)}\,dx,
\end{equation}
escolhemos
\begin{gather}
  u = \cos(x)\\
  \Rightarrow du = -\sen(x)\,dx.
\end{gather}
Então, por substituição, calculamos
\begin{align}
  \int \tg(x)\,dx &= -\int \frac{1}{u}\,du \\
                  &= -\ln|u| + C \\
                  &= -\ln|\cos(x)| + C \\
                  &= \ln\left|\frac{1}{\cos(x)}\right| + C\\
                  &= \ln|\sec(x)| + C.
\end{align}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int x\tg(x^2)\,dx.
  \end{equation}
  Usando a regra de substituição, escolhemos
  \begin{gather}
    u = x^2 \\
    \Rightarrow du = 2x\,du.
  \end{gather}
  Fazendo a substituição e calculando, obtemos
  \begin{align}
    \int x\tg(x^2)\,dx &= \int \tg(u)\,\frac{du}{2} \\
                       &= \frac{1}{2}\int \tg(u)\,du \\
                       &= \frac{1}{2}\ln|\sec(u)| + C \\
                       &= \frac{1}{2}\ln|\sec(x^2)| + C.
  \end{align}
\end{ex}

Com raciocínio análogo ao utilizado na integração da função tangente, obtemos\footnote{Veja o Exercício \ref{exer:int_subs_cotg}.}
\begin{equation}
  {\color{blue}\int \cotg(x)\,dx = \ln|\sen(x)| + C}.
\end{equation}

Agora, vamos mostrar que
\begin{equation}
  {\color{blue}\int \sec(x)\,dx = \ln|\sec(x)+\tg(x)|+C}.
\end{equation}
Observamos que
\begin{align}
  \int\sec(x)\,dx &= \int \sec(x)\cdot\frac{\sec(x)+\tg(x)}{\sec(x)+\tg(x)}\,dx \\
                  &= \int \frac{\sec^2(x)+\sec(x)\tg(x)}{\sec(x)+\tg(x)}\,dx.
\end{align}
Então, escolhendo
\begin{equation}
  u = \sec(x) + \tg(x)\\
  \Rightarrow du = \sec(x)\tg(x) + \sec^2(x),
\end{equation}
temos, por substituição, que
\begin{align}
  \int\sec(x)\,dx &= \int\frac{\sec^2(x)+\sec(x)\tg(x)}{\sec(x)+\tg(x)}\,dx \\
                  &= \int\frac{1}{u}\,du \\
                  &= \ln|u| + C \\
                  &= \ln|\sec(x)+\tg(x)| + C.
\end{align}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int\sec\left(\frac{u}{2}\right)\,du.
  \end{equation}
  Fazendo a substituição
  \begin{equation}
    v = \frac{u}{2}\\
    \Rightarrow dv = \frac{du}{2},
  \end{equation}
  segue
  \begin{align}
    \int\sec\left(\frac{u}{2}\right)\,du &= \int\sec(v)\cdot 2\,dv \\
                                         &= 2\int \sec(v)\,dv \\
                                         &= 2\ln|\sec(v)+\tg(v)| + C \\
                                         &= 2\ln\left|\sec\left(\frac{u}{2}\right)+\tg\left(\frac{u}{2}\right)\right| + C.
  \end{align}
\end{ex}

Com raciocínio análogo ao utilizado na integração da função secante, obtemos\footnote{Veja o Exercício \ref{exer:int_subs_cossec}.}
\begin{equation}
  {\color{blue}\int \cossec(x)\,dx = -\ln|\cossec(x)+\cotg(x)| + C}.
\end{equation}


\subsection{Integrais definidas}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

A regra de substituição para integrais definidas é
\begin{equation}
  {\color{blue}\int_a^b f(u(x))u'(x)\,dx = \int_{u(a)}^{u(b)} f(u)\,du}.
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_0^1 e^{-2x}\,dx.
  \end{equation}
  Por substituição, escolhemos
  \begin{equation}
    u = -2x\\
    \Rightarrow du = -2dx.
  \end{equation}
  Logo,
  \begin{align}
    \int 0^1 e^{-2x}\,dx &= \int_{u(0)}^{u(1)} e^{u}\frac{du}{-2} \\
                         &= -\frac{1}{2}\int_{0}^{-2} e^udu \\
                         &= -\frac{1}{2}\left[e^u\right]_0^{-2} \\
                         &= -\frac{1}{2}\left(e^{-2} - e^0\right) \\
                         &= \frac{1}{2} - \frac{e^{-2}}{2}.
  \end{align}

  Alternativamente, podemos calcular a integral indefinida primeiramente e, então, usar o Teorema Fundamental do Cálculo com a primitiva obtida. Ou seja, temos
  \begin{align}
    \int e^{-2x}\,dx &= \int e^u\frac{du}{-2} \\
                     &= -\frac{1}{2}\int e^u\,du \\
                     &= -\frac{1}{2}e^u + C \\
                     &= -\frac{1}{2}e^{-2x} + C.
  \end{align}
  Então, do Teorema Fundamental do Cálculo, temos
  \begin{align}
    \int_0^1 e^{-2x}\,dx &= \left[-\frac{1}{2}e^{-2x}\right]_0^1 \\
                         &= -\frac{1}{2}e^{-2} + \frac{1}{2}e^{0} \\
                         &= \frac{1}{2} - \frac{e^{-2}}{2},
  \end{align}
  como esperado.

\end{ex}

\subsection{Tabela de integrais}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

\begin{small}
\begin{align}
  & \int k\cdot f(u)\,du = k\cdot\int f(u)\,du\\
  & \int \left[f(u)\pm g(u)\right]\,du = \int f(u)\,du \pm \int g(u)\,dx\\
  & \int u^r\,du = \frac{u^{r+1}}{r+1} + C,\quad r\neq -1\\
  & \int \frac{1}{u}\,du = \ln u + C \\
  & \int e^u\,du = e^u + C \\
  & \int a^u\,dx = \frac{a^u}{\ln a} + C \\
  & \int \sen(u)\,du = -\cos(u) + C \\
  & \int \cos(u)\,dx = \sen(u) + C \\
  & \int \tg(u)\,dx = \ln|\sec(u)| + C \\
  & \int \cotg(u)\,dx = \ln|\sen(u)| + C \\
  & \int \sec(u)\,dx = \ln|\sec(u)+\tg(u)| + C \\
  & \int \cossec(u)\,dx = -\ln|\cossec(u)+\cotg(u)| + C
\end{align}
\end{small}


\subsection{Exercícios resolvidos}

% \begin{flushright}
%   [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
% \end{flushright}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int \frac{7}{(x-1)^2}\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Usamos a regra de integração por substituição
  \begin{equation}
    \int f(u(x))u'(x)\,dx = \int f(u)\,du.
  \end{equation}
  Escolhemos
  \begin{equation}
    u = x-1,
  \end{equation}
  e calculamos
  \begin{gather}
    \frac{du}{dx} = 1\\
    \Rightarrow du = dx.
  \end{gather}
  Então, da fórmula, obtemos
  \begin{align}
    \int \frac{7}{(x-1)^2}\,dx &= \int \frac{7}{u^2}\,du\\
                               &= 7\int u^{-2}\,du\\
                               &= 7\frac{u^{-2+1}}{-2+1}\\
                               &= -\frac{7}{u}\\
                               &= \frac{7}{1-x} + C.
  \end{align}
\end{resol}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int \frac{e^x}{e^x - 1}\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Fazendo a substituição
  \begin{gather}
    u = e^x-1\\
    \Rightarrow du = e^x\,dx,
  \end{gather}
  temos
  \begin{align}
    \int \frac{e^x}{e^x - 1}\,dx &= \int \frac{1}{u}\,du \\
                                 &= \ln|u| + C \\
                                 &= \ln|e^x-1|+C.
  \end{align}
\end{resol}


\begin{exeresol}
  Calcule
  \begin{equation}
    \int_0^1x\sqrt{1-x^2}\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Vejamos as seguintes formas de calcular esta integral definida.
  \begin{itemize}
  \item {\bf Solução 1}: aplicando a regra de substituição em integrais definidas.
    \begin{equation}
      \int_a^bf(u(x))u'(x)\,dx = \int_{u(a)}^{u(b)} f(u)\,du.
    \end{equation}
    Escolhendo, $u = 1-x^2$, temos $du = -2x\,dx$. Daí, segue
    \begin{align}
      \int_0^1x\sqrt{1-x^2}\,dx &= \int_{u(0)}^{u(1)}x\sqrt{u}\,\frac{du}{-2x}\\
                                &= -\frac{1}{2}\int_{1}^0 u^{\frac{1}{2}}\,du\\
                                &= -\frac{1}{2}\left.\frac{u^{\frac{1}{2}+1}}{\frac{1}{2}+1}\right|_{u=1}^0\\
                                &= -\frac{1}{3}\left.\sqrt{u^3}\right|_{u=1}^0\\
                                &= \frac{1}{3}.
    \end{align}
  \item {\bf Solução 2}: calculando uma primitiva em função de $x$.
    Para obtermos uma primitiva em função de $x$, calculamos a integral indefinida
    \begin{equation}
      \int x\sqrt{1-x^2}\,dx.
    \end{equation}
    Como anteriormente, usamos a regra de substituição. Escolhendo $u=1-x^2$, temos $du = -2x\,dx$ e, portanto
    \begin{align}
      \int x\sqrt{1-x^2}\,dx &= \int x\sqrt{u}\,\frac{du}{-2x}\\
                             &= -\frac{1}{2}\int u^{\frac{1}{2}}\,du\\
                             &= -\frac{1}{2}\frac{u^{\frac{1}{2}+1}}{\frac{1}{2}+1}\\
                             &= -\frac{1}{3}\sqrt{u^3}\\
                             &= -\frac{1}{3}\sqrt{(1-x^2)^3} + C.
    \end{align}
    Então, do teorema fundamental do cálculo, temos
    \begin{equation}
      \int_0^1 x\sqrt{1-x^2}\,dx = -\frac{1}{3}\left.\sqrt{(1-x^2)^3}\right|_{0}^1 = \frac{1}{3}.
    \end{equation}
  \end{itemize}
\end{resol}


% \begin{exeresol}
%   Calcule a área total entre as curvas $y=(1-x)^3$, $y=0$, $x=0$ e $x=2$.
% \end{exeresol}
% \begin{resol}
%   A função $f(x) = (1-x)^3$ é positiva em $(0, 1)$ e negativa em $(1, 2)$. Logo, a área é igual a
%   \begin{equation}
%     A = \int_0^1 (1-x)^3\,dx - \int_1^2 (1-x)^3\,dx.
%   \end{equation}
%   Agora, calculamos
%   \begin{equation}
%     \int (1-x)^3\,dx.
%   \end{equation}
%   Para tanto, fazemos a substituição
%   \begin{equation}
%     u = 1-x \Rightarrow du = -dx.
%   \end{equation}
%   Logo,
%   \begin{align}
%     \int (1-x)^3\,dx &= -\int u^3du \\
%                      &= -\frac{u^4}{4} + C \\
%                      &= -\frac{(1-x)^4}{4} + C.
%   \end{align}
%   Então, do Teorema Fundamental do Cálculo, temos
%   \begin{align}
%     A &= \left[-\frac{(1-x)^4}{4}\right]_0^1 - \left[-\frac{(1-x)^4}{4}\right]_1^2 \\
%       &= \frac{1}{4} + \frac{1}{4} \\
%       &= \frac{1}{2}.
%   \end{align}

%   \ifispython
%   No \sympy, temos\footnote{Veja a Observação \ref{obs:cap_int_python}.}:
% \begin{verbatim}
% >>> integrate((1-x)**3,(x,0,1))-integrate((1-x)**3,(x,1,2))
% 1/2
% \end{verbatim}
%   \fi      
% \end{resol}

\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{equation}
    \int 2(2x+1)^2\,dx
  \end{equation}
  \begin{enumerate}[a)]
  \item[a)] por integração direta.
  \item[b)] por substituição.
  \end{enumerate}
\end{exer}
\begin{resp}
  $\displaystyle \int 2(2x+1)^2\,dx = \frac{8}{3}x^3 + 4x^2 + 2x + C$
\end{resp}

\begin{exer}
  Use o método da substituição para calcular as seguintes integrais:
  \begin{enumerate}[a)]
  \item $\displaystyle \int 2(2x+1)^3\,dx$
  \item $\displaystyle \int \sqrt{2x+1}\,dx$
  \item $\displaystyle \int 2x(x^2-2)\,dx$
  \item $\displaystyle \int (2x^2+ 4x - 3)^4(x+1)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\displaystyle 4x^4+8x^3+6x^2+2x+C$; b) $\displaystyle \frac{\sqrt{(2x+1)^3}}{3} + C$; c) $\displaystyle \frac{1}{3}(x^2-2)^3 + C$; d) $\frac{1}{20}(2x^2 + 4x - 3)^5 + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int \frac{1}{x+1}\,dx$
  \item $\displaystyle \int \frac{1}{3x-2}\,dx$
  \item $\displaystyle \int \frac{6x + 1}{x + 3x^2}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\displaystyle \ln |x+1| + C$; b) $\displaystyle \frac{1}{3}\ln \left|x-\frac{2}{3}\right| + C$; c) $\displaystyle \ln \left|x + 3x^2\right| + C$;
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int 3e^{3x}\,dx$
  \item $\displaystyle \int e^{2x-1}\,dx$
  \item $\displaystyle \int xe^{x^2}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\displaystyle e^{3x}+C$; b) $\displaystyle \frac{1}{2}e^{2x-1} + C$; c) $\displaystyle \frac{1}{2}e^{x^2} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int 2^x\,dx$
  \item $\displaystyle \int x - 3^x\,dx$
  \item $\displaystyle \int \frac{x}{2^{x^2}}\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\displaystyle \frac{2^x}{\ln 2} + C$; b) $\frac{x^2}{2} - \frac{3^x}{\ln 3} + C$; c) $\displaystyle -\frac{1}{2\cdot 2^{x^2}\ln 2} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-1}^0 \frac{7}{(x-1)^2}\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\frac{7}{2}$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_0^{\ln 3} e^{2x}\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $4$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_0^{\sqrt{e-1}} \frac{x}{x^2+1}\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\frac{1}{2}$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int \sen(x)\cos(x)\,dx$
  \item $\displaystyle \int \sen(2x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\displaystyle \frac{\sen^2(x)}{2} + C$; b)~$\displaystyle \frac{-\cos(2x)}{2} + C$;
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int \cos^2(x)\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle \frac{x}{2} + \frac{\sen(2x)}{4} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_0^{\frac{\pi}{4}}\cos(2x)\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $1/2$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_0^{\pi/4} \sec^2(x)e^{\tg(x)}\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $e-1$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\sec^2(x)\tg(x)\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $\frac{1}{2}\tg^2(x) + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int \frac{\ln(x^3)}{x}\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle \frac{3\ln^2(x)}{2} + C$
\end{resp}


\begin{exer}\label{exer:int_subs_cotg}
  Use a regra da substituição para mostrar que
  \begin{equation}
    \int \cotg(x)\,dx = \ln|\sen(x)| + C.
  \end{equation}
\end{exer}

\begin{exer}
  Calcule
  \begin{equation}
    \int \cos^2(x)\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle \frac{x}{2} + \frac{\sen(x)\cos(x)}{2} + C$
\end{resp}

\begin{exer}\label{exer:int_subs_cossec}
  Use o método da substituição para mostrar que
  \begin{equation}
    \int \cossec(x)\,dx = -\ln|\cossec(x)+\cotg(x)| + C.
  \end{equation}
\end{exer}
\begin{resp}
  Dica: Multiplique o numerador e o denominador por $\cotg(X)+\cossec(x)$.
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{x}{x^2-4x+8}\,dx
  \end{equation}
  Dica: Complete o quadrado no denominador e então faça a substituição adequada.
\end{exer}
\begin{resp}
  $\frac{1}{2}\ln|(x-2)^2+4|+\arc\tg\left(\frac{x-2}{2}\right) + C$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Integração por partes}\label{cap_int_sec_partes}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Sejam $u=u(x)$ e $v=v(x)$ funções diferenciáveis, então da regra do produto para derivadas temos
\begin{equation}
  \frac{d}{dx}(uv) = \frac{du}{dx}v + u\frac{dv}{dx}.
\end{equation}
Integrando em ambos os lados, obtemos
\begin{equation}
  \int \frac{d (uv)}{dx}dx = \int \frac{du}{dx}vdx + \int u\frac{dv}{dx}dx,
\end{equation}
donde
\begin{equation}
  uv = \int vdu + \int udv.
\end{equation}
Daí, segue a \emph{fórmula de integração por partes}
\begin{equation}
  {\color{blue}\int udv = uv - \int vdu}.
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int xe^x\,dx.
  \end{equation}
  usando integração por partes. Escolhemos
  \begin{gather}
    {\color{blue}u = x}\\
    \frac{du}{dx} = 1\\
    {\color{blue}du = dx}
  \end{gather}
  e
  \begin{gather}
    {\color{red}dv = e^x\,dx}\\
    \int dv = \int e^x\,dx\\
    {\color{red}v = e^x}.
  \end{gather}
  Observamos que no cálculo de $v$, desprezamos a constante indeterminada. Então, da fórmula de integração por partes, temos
  \begin{align}
    \int {\color{blue}x}{\color{red}e^x\,dx} &= \int {\color{blue}u}{\color{red}dv}\\
                  &= {\color{blue}u}{\color{red}v} - \int {\color{red}v}{\color{blue}du} \\
                  &= xe^x - \int e^xdx \\
                  &= xe^x - e^x + C.
  \end{align}
  
  \ifispython
  Verifique computando esta integral com {\python}+{\sympy}!
  \fi
\end{ex}

Em alguns casos, é possível fazer mais de uma escolha na aplicação da integração por partes.

\subsection{A integral do logaritmo natural}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Vamos calcular
\begin{equation}
  \int \ln x\,dx.
\end{equation}
Usando integração por partes, escolhemos
\begin{gather}
  u = \ln x\\
  du = \frac{1}{x}\,dx
\end{gather}
e
\begin{gather}
  dv = dx\\
  v = \int dx = x
\end{gather}
Pela fórmula de integração por partes, segue que
\begin{align}
  \int \ln x \,dx &= \int u\,dv \\
                  &= uv - \int v\,du \\
                  &= x\ln(x) - \int x\frac{1}{x}\,dx \\
                  &= x\ln(x) - \int dx \\
                  &= x\ln(x) - x + C.
\end{align}
Ou seja, concluímos que
\begin{equation}\label{eq:int_lnx}
  {\color{blue}\int \ln x \,dx = x\ln(x) - x + C}.
\end{equation}

\begin{ex}
  Calculamos as seguintes integrais:
  \begin{enumerate}[a)]
  \item $\displaystyle\int_1^e\ln(x)\,dx$
    \begin{align}
      \int_1^e\ln(x)\,dx &= \left. x\ln(x) - x\right|_1^e\\
                         &= e\ln(e) - e - [1\cdot\ln(1) - 1]\\
                         &= e\ln(e) - e + 1
    \end{align}

  \item $\displaystyle\int\ln(2x)\,dx$
    
    Usando o método da substituição\footnote{Consulte a Seção \ref{cap_int_sec_subs} para mais informações sobre integração por substituição.}, escolhemos
    \begin{gather}
      u = 2x\\
      \Rightarrow du = 2\,dx.
    \end{gather}
    Fazendo a substituição e calculando, temos
    \begin{align}
      \int \ln(2x)\,dx &= \int \ln(u)\frac{du}{2} \\
                       &= \frac{1}{2}\int \ln(u)\,du \\
                       &= \frac{u\ln(u)}{2} - \frac{u}{2} + C \\
                       &= x\ln(2x) - x + C.
    \end{align}
    
  \ifispython
  Verifique as soluções com o {\python}+{\sympy}!
  \fi
  \end{enumerate}
\end{ex}

% \begin{ex}
%   Vamos calcular
%   \begin{equation}
%     \int \sen(x)e^x\,dx.
%   \end{equation}
%   Para integrar por partes, podemos escolher
%   \begin{align}
%     u = \sen(x) &\Rightarrow du = \cos(x)\,dx \\
%     dv = e^x\,dx &\Rightarrow v = e^x
%   \end{align}
%   Então, segue
%   \begin{equation}\label{eq:int_aux_p1}
%     \int\sen(x)e^x\,dx = \sen(x)e^x - \int\cos(x)e^x\,dx.
%   \end{equation}
%   Agora, aplicamos integração por partes a esta última integral. Tomamos as seguintes novas escolhas
%   \begin{align}
%     u = \cos(x) &\Rightarrow du = -\sen(x)\,dx \\
%     dv = e^x\,dx &\Rightarrow dv = e^x
%   \end{align}
%   Segue que
%   \begin{equation}
%     \int\cos(x)e^x\,dx = \cos(x)e^x + \int\sen(x)e^x\,dx.
%   \end{equation}
%   Substituindo este resultado na equação \eqref{eq:int_aux_p1}, obtemos
%   \begin{equation}
%     \int\sen(x)e^x\,dx = \sen(x)e^x-\cos(x)e^x-\int\sen(x)e^x\,dx.
%   \end{equation}
%   Somando este primeiro termo em ambos os lados desta equação, obtemos
%   \begin{equation}
%     2\int\sen(x)e^x\,dx = (\sen(x)-\cos(x))e^x.
%   \end{equation}
%   Daí, concluímos que
%   \begin{equation}
%     \int\sen(x)e^x\,dx = \frac{\sen(x)-\cos(x)}{2}e^x + C.
%   \end{equation}

%   \ifispython
%   No \sympy\footnote{Veja a Observação \ref{obs:cap_int_python}.}, temos:
% \begin{verbatim}
% >>> integrate(sin(x)*exp(x),x)
%  x            x
% e · sin(x)   e · cos(x)
% ---------- - ----------
%      2           2
% \end{verbatim}
%   \fi
% \end{ex}

\subsection{Integral definida}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

Sejam $u=u(x)$ e $v=v(x)$ funções diferenciáveis em $x$. Segue que $du = u'(x)\,dx$ e $dv = v'(x)\,dx$. Segue que a fórmula de integração por partes para integrais definidas é
\begin{equation}
  {\color{blue}\int_{x=a}^b u\,dv = \left. uv \right|_{x=a}^b - \int_{x=a}^b v\,du}.
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_0^2 xe^{-x}\,dx.
  \end{equation}
  Para aplicar integração por partes, escolhemos
  \begin{gather}
    u = x\\
    du = dx
  \end{gather}
  e
  \begin{gather}
    dv = e^{-x}\,dx\\
    v = -e^{-x}
  \end{gather}
  Segue da fórmula de integração por partes para integrais definidas que
  \begin{align}
    \int_0^2 xe^{-x}\,dx &= \left. uv \right|_{x=0}^2 - \int_{x=0}^2 e^{-x}\,dx\\
                         &= \left. -xe^{-x}\right|_0^2 + \int_0^2 e^{-x}\,dx \\
                         &= -2e^{-2} + \left[-e^{-x}\right]_0^2 \\
                         &= -3e^{-2} + 1.
  \end{align}

  \ifispython
  Verifique computando com o {\python}+{\sympy}!
  \fi
\end{ex}

\subsection{Tabela de integrais}

\begin{flushright}
  [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
\end{flushright}

\begin{small}
\begin{align}
  & \int k\cdot f(u)\,du = k\cdot\int f(u)\,du\\
  & \int \left[f(u)\pm g(u)\right]\,du = \int f(u)\,du \pm \int g(u)\,du\\
  & \int u^r\,du = \frac{u^{r+1}}{r+1} + C,\quad r\neq -1\\
  & \int \frac{1}{u}\,du = \ln |u| + C \\
  & \int e^u\,du = e^u + C \\
  & \int a^u\,du = \frac{a^u}{\ln a} + C \\
  & \int \ln u \,du = u\ln(u) - u + C \\
  & \int \sen(u)\,du = -\cos(u) + C \\
  & \int \cos(u)\,du = \sen(u) + C \\
  & \int \tg(u)\,du = \ln|\sec(u)| + C \\
  & \int \cotg(u)\,du = \ln|\sen(u)| + C \\
  & \int \sec(u)\,du = \ln|\sec(u)+\tg(u)| + C \\
  & \int \cossec(u)\,du = -\ln|\cossec(u)+\cotg(u)| + C
\end{align}
\end{small}

\subsection{Exercícios resolvidos}

% \begin{flushright}
%   [Vídeo] | [Áudio] | \href{https://phkonzen.github.io/notas/contato.html}{[Contatar]}
% \end{flushright}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int x\ln x\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Usamos a fórmula de integração por partes
  \begin{equation}
    \int udv = uv - \int vdu.
  \end{equation}
  Para tanto, escolhemos
  \begin{gather}
    u = \ln x\\
    du = \frac{1}{x}\,dx
  \end{gather}
  e
  \begin{gather}
    dv = x\,dx\\
    v = \frac{x^2}{2}
  \end{gather}
  Segue que
  \begin{align}
    \int x\ln x\,dx &= \int udv\\
                    &= uv - \int v\,du\\
                    &= \frac{x^2}{2}\ln x - \int \frac{x^2}{2}\frac{1}{x}\,dx\\
                    &= \frac{x^2}{2}\ln x - \frac{1}{2}\int x\,dx\\
                    &= \frac{x^2}{2}\ln x - \frac{1}{2}\frac{x^2}{2} + C\\
                    &= \frac{x^2}{2}\ln x - \frac{x^2}{4} + C.
  \end{align}

  \ifispython
  Com o {\python}+{\sympy}, computamos este integral com os seguintes comandos:
  \begin{lstlisting}
    >>> from sympy import *
    >>> x = symbols('x')
    >>> integrate(x*log(x))
    x**2*log(x)/2 - x**2/4
  \end{lstlisting}
  \fi
\end{resol}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int_{-1}^1 xe^x\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Primeiramente, vamos calcular
  \begin{equation}
    \int xe^{-x}\,dx
  \end{equation}
  Por integração por partes, escolhemos
  \begin{gather}
    u = x\\
    du = dx
  \end{gather}
  e
  \begin{gather}
    dv = e^x\,dx\\
    v = e^x
  \end{gather}
  Segue que
  \begin{align}
    \int xe^x\,dx &= uv - \int v\,du\\
                  &= xe^x - \int e^x\,dx\\
                  &= xe^x - e^x + C
  \end{align}

  Então, aplicamos o Teorema Fundamental do Cálculo como segue
  \begin{align}
    \int_{-1}^1 xe^x\,dx &= \left. xe^x - e^x\right|_{-1}^1\\
                         &= 1\cdot e^1 - e^1\\
                         &- (-1\cdot e^{-1} - e^{-1})\\
                         &= \frac{2}{e}
  \end{align}
  
  \ifispython
  Com o {\python}+{sympy}, computamos
  \begin{lstlisting}
    >>> from sympy import *
    >>> x = symbols('x')
    >>> integrate(x*exp(x), (x, -1, 1))
    2*exp(-1)
  \end{lstlisting}
  \fi
\end{resol}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int e^x\sen(x)\,dx.
  \end{equation}
\end{exeresol}
\begin{resol}
  Por integração por partes, escolhemos
  \begin{gather}
    u = e^x\\
    du = e^x\,dx
  \end{gather}
  e
  \begin{gather}
    dv = \sen(x)\,dx\\
    v = -\cos(x)
  \end{gather}
  Então, segue que
  \begin{align}\label{eq:exeresol_int_excosx}
    \int e^x\sen(x)\,dx &= uv - \int v\,du\\
                        &= -e^x\cos(x) + {\color{blue}\int e^x\cos(x)\,dx}
  \end{align}
  Por sua vez, integramos por partes esta última, escolhendo
  \begin{gather}
    u = e^x\\
    du = e^x\,dx
  \end{gather}
  e
  \begin{gather}
    dv = \cos(x)\,dx\\
    v = \sen(x)
  \end{gather}
  Com isso, temos
  \begin{align}
    {\color{blue}\int e^x\cos(x)\,dx} &= uv - \int v\,du\\
                                      &= e^x\sen(x) - \int e^x\sen(x)\,dx
  \end{align}
  Então, voltamos a \eqref{eq:exeresol_int_excosx} e obtemos
  \begin{gather}
    \int e^x\sen(x)\,dx = -e^x\cos(x) + {\color{blue}e^x\sen(x) - \int e^x\sen(x)\,dx}\\
    2\int e^x\sen(x)\,dx = -e^x\cos(x) + e^x\sen(x)\\
    \int e^x\sen(x)\,dx = \frac{1}{2}e^x\sen(x) - \frac{1}{2}e^x\cos(x) + C
  \end{gather}

  \ifispython
  Com o {\python}+{\sympy}, computamos esta integral com os seguintes códigos
  \begin{lstlisting}
    >>> from sympy import *
    >>> x = symbols('x')
    >>> integrate(exp(x)*sin(x))
    exp(x)*sin(x)/2 - exp(x)*cos(x)/2
  \end{lstlisting}
  \fi
\end{resol}

\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle\int xe^{2x}\,dx$
  \item $\displaystyle\int (x-1)e^x\,dx$
  \item $\displaystyle\int x^2\ln(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\frac{2x-1}{4}e^{2x} + C$; b) $xe^x + C$; c) $\frac{x^3}{3}\ln(x) - \frac{x^3}{9} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle\int_0^1 xe^{2x}\,dx$
  \item $\displaystyle\int_0^{\ln 2} (x+1)e^x\,dx$
  \item $\displaystyle\int x^2\ln(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\frac{1}{4} + \frac{e^2}{4}$; b) $2\ln 2$; c) $\frac{1}{9} + \frac{2}{9}e^{3}$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\log_2(x)\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle \frac{x\ln(x)}{\log_2(x)}-\frac{x}{\log_2(x)} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-1}^1 x^2e^x\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $-\frac{5}{e}+e$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int x\sen(x)\,dx$
  \item $\displaystyle \int x\cos(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\displaystyle \sen(x)-x\cos(x)+C$; b)~$\displaystyle \cos(x)+x\sen(x)+C$;
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int x^2e^x\,dx$
  \item $\displaystyle \int x^2\sen(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\displaystyle \left(x^2-2x+2\right)e^x+C$; b)~$\displaystyle -x^2\cos(x)+2x\sen(x)+2\cos(x)+C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int e^x\cos(x)\,dx.
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle \frac{\sen(x)+\cos(x)}{2}e^x + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle \int_0^{\frac{\pi}{2}} x\sen(x)\,dx$
  \item $\displaystyle \int_{-\pi}^{0} x\cos(x)\,dx$
  \item $\displaystyle \int_1^e x^2\ln(x)\,dx$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$1$; b)~$2$;  c)~$\displaystyle \frac{1}{9}+\frac{2e^3}{9}$
\end{resp}

\begin{exer}\label{eq:int_sec3_x}
  Calcule
  \begin{equation}
    \int \sec^3(x)\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle\frac{\sec(x)\tg(x)}{2} + \frac{1}{2}\ln|\sec(x)+\tg(x)| + C$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Integração por substituição trigonométrica}\label{cap_int_sec_substrigo}

Em muitos casos, integrais em $x$ envolvendo
\begin{gather}
  \sqrt{a^2 - x^2},\\
  \sqrt{x^2 + a^2},\\
  \sqrt{x^2 - a^2},
\end{gather}
com $a>0$, podem ser calculadas por meio de substituições envolvendo funções trigonométricas.

\subsubsection{Integrais envolvendo $\pmb{\sqrt{a^2 - x^2}}$}

No caso de integrais em $x$ envolvendo
\begin{equation}
  \sqrt{a^2 - x^2}
\end{equation}
com $a>0$, podemos fazer a substituição trigonométrica
\begin{equation}
  x = a\sin\theta
\end{equation}
com $-\pi/2\leq\theta\leq\pi/2$. Com isso\footnote{Lembremos da identidade trigonométrica fundamental  $\sen^2 \theta + \cos^2 \theta = 1 $.},
\begin{align}
  \sqrt{a^2 - x^2} &= \sqrt{a^2 - a^2\sen^2\theta}\\
                   &= \sqrt{a^2\cos^2\theta}\\
                   &= a|\cos\theta|\\
                   &= |a|\cos\theta
\end{align}
uma vez que $\cos\theta \geq 0$ para todo $\theta\in [-\pi/2,\pi/2]$. Com isso, eliminamos o termo radical, passando a uma integral envolvendo a função trigonométrica.

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int \frac{1}{\sqrt{1 - x^2}}\,dx
  \end{equation}
  \begin{enumerate}[a)]
  \item Por substituição trigonométrica.
    Fazemos a substituição trigonométrica
    \begin{gather}
      x = \sin\theta,\quad -\frac{\pi}{2}\leq\theta\leq\frac{\pi}{2},\\
      \Rightarrow\\
      dx = \cos(\theta)\,d\theta
    \end{gather}
    Substituindo na integral, obtemos
    \begin{align}
      \int \frac{1}{\sqrt{1 - x^2}}\,dx &= \int \frac{1}{\sqrt{1 - \sen^2(\theta)}}\cos(\theta)\,d\theta\\
                                        &= \int \frac{\cos(\theta)}{|\cos(\theta)|}\,d\theta\\
                                        &= \int d\theta\\
                                        &= \theta + C\\
                                        &= \arc\sen(x) + C
    \end{align}
  \item Por integração direta.
    No estudo de derivadas de funções trigonométricas inversas, vemos que
    \begin{equation}
      \frac{d}{dx}\arc\sen(x) = \frac{1}{\sqrt{1-x^2}}.
    \end{equation}
    Logo, pela definição de integral indeterminada, temos
    \begin{equation}
      \int\frac{1}{\sqrt{1-x^2}}\,dx = \arc\sen(x) + C
    \end{equation}
    como esperado.
  \end{enumerate}

  \ifispython
  Com {\python}+{\sympy}, podemos computar esta integral como os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> integrate(1/sqrt(1-x**2),x)
     asin(x)
  \end{lstlisting}
  \fi
\end{ex}

\subsubsection{Integrais envolvendo $\pmb{\sqrt{a^2 + x^2}}$}

No caso de integrais em $x$ envolvendo
\begin{equation}
  \sqrt{a^2 + x^2}
\end{equation}
com $a>0$, podemos fazer a substituição trigonométrica
\begin{equation}
  x = a\tg(\theta),\quad -\frac{\pi}{2}\leq\theta\leq\frac{\pi}{2} 
\end{equation}
Com isso\footnote{Lembremos a identidade trigonométrica $1 + \tg^2(x) = \sec^2(x)$.},
\begin{align}
  \sqrt{a^2 + x^2} &= \sqrt{a^2 + a^2\tg^2(\theta)}\\
                   &= \sqrt{a^2\sec^2(\theta)}\\
                   &= |a||\sec(\theta)|\\
                   &= |a|\sec(\theta),
\end{align}
observando que $\sec(\theta) \geq 0$ para $\theta\in(-\pi/2,\pi/2)$.

\begin{ex}
  Calcule
  \begin{equation}
    \int \sqrt{4 + x^2}\,dx
  \end{equation}
  Fazemos a substituição trigonométrica
  \begin{gather}
    x = 2\tg(\theta),\quad-\frac{\pi}{2}\leq\theta\leq\frac{\pi}{2}\\
    \Rightarrow
    dx = 2\sec^2(\theta)\,d\theta
  \end{gather}
  Substituindo na integral, temos
  \begin{align}
    \int \sqrt{4 + x^2}\,dx &= \int \sqrt{4 + 4\tg^2(\theta)}\,2\sec^2(\theta)\,d\theta\\
                            &= \int 4\sec^3(\theta)\,d\theta
  \end{align}
  Para calcular esta última integral, podemos usar integração por partes\footnote{Consulte o Exercício \ref{eq:int_sec3_x}.}, donde obtemos
  \begin{align}
    \int \sqrt{4 + x^2}\,dx &= 2\sec(\theta)\tg(\theta) + 2\ln|\sec(\theta)+\tg(\theta)| + C\\
                              &= x\sec\left(\arc\tg\left(\frac{x}{2}\right)\right) \\
                              &+ 2\ln\left|\sec\left(\arc\tg\left(\frac{x}{2}\right)\right) + \frac{x}{2}\right| + C
  \end{align}
\end{ex}

\subsubsection{Integrais envolvendo $\pmb{\sqrt{x^2 - a^2}}$}

No caso de integrais em $x$ envolvendo
\begin{equation}
  \sqrt{x^2+a^2}
\end{equation}
com $a>0$, podemos fazer a substituição trigonométrica
\begin{equation}
  x = a\sec(\theta),
\end{equation}
assumindo $0\leq\theta\leq\pi/2$, no caso de $x\geq a$, e $\pi/2\leq\theta\leq\pi$, quando $x\leq -a$.

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int\sqrt{x^2-4}\,dx
  \end{equation}
  para $x\geq 2$. Fazemos a substituição trigonométrica
  \begin{gather}
    x = 2\sec(\theta),\quad 0\leq\theta\leq\frac{\pi}{2}\\
    dx = 2\sec(\theta)\tg(\theta)
  \end{gather}
  Substituindo na integral, temos\footnote{Vamos usar a identidade trigonométrica $\sec^2(x)-1=\tg^2(x)$.}
  \begin{align}
    \int\sqrt{x^2-4}\,dx &= \int\sqrt{4\sec^2(\theta)-4}2\sec(\theta)\tg(\theta)\,d\theta\\
                         &= 4\int\sec(\theta)\tg^2(\theta)\,d\theta\\
                         &= 4\int\sec^3(\theta)\,d\theta - 4\int\sec(\theta)\,d\theta\\
                         &= 2\sec(\theta)\tg(\theta) + 2\ln|\sec(\theta)+\tg(\theta)| \\
                         &- 4\ln|\sec(\theta)+\tg(\theta)|\\
                         &= x\tg\left(\arc\tg\left(\frac{x}{2}\right)\right) \\
                         &- 2\ln\left|\frac{x}{2}+\tg\left(\arc\tg\left(\frac{x}{2}\right)\right)\right| + C
  \end{align}
\end{ex}

\subsection{Exercícios resolvidos}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int_{\frac{5}{2}}^{\frac{5}{2}\sqrt{2}}\frac{dx}{x^2\sqrt{25-x^2}}\,dx
  \end{equation}
\end{exeresol}
\begin{resol}
  Fazemos a substituição trigonométrica
  \begin{gather}
    x = 5\sen(\theta),\quad -\frac{\pi}{2}\leq\theta\leq\frac{\pi}{2}\\
    dx = 5\cos(\theta)\,d\theta
  \end{gather}
  Substituindo na integral, temos
  \begin{equation}
    \int_{\frac{5}{2}}^{\frac{5}{2}\sqrt{2}}\frac{dx}{x^2\sqrt{25-x^2}} = \int_{x=\frac{5}{2}}^{\frac{5}{2}\sqrt{2}}\frac{5\cos(\theta)}{25\sen^2(\theta)\sqrt{25-\sen^2(\theta)}}\,d\theta
  \end{equation}
  Observamos que
  \begin{gather}
    \theta = \arc\sen\left(\frac{x}{5}\right)\\
    x = \frac{5}{2} \Rightarrow \theta = \arc\sen\left(\frac{1}{2}\right) = \frac{\pi}{6}\\
    x = \frac{5\sqrt{2}}{2} \Rightarrow \theta = \arc\sen\left(\frac{\sqrt{2}}{2}\right) = \frac{\pi}{4}
  \end{gather}
  Segue que
  \begin{align}
    \int_{\frac{5}{2}}^{\frac{5}{2}\sqrt{2}}\frac{dx}{x^2\sqrt{25-x^2}} &= \int_{\frac{\pi}{6}}^{\frac{\pi}{4}}\frac{5\cos(\theta)}{25\sen^2(\theta)\cdot 5\cos(\theta)}\,d\theta\\
                                                                        &= \int_{\frac{\pi}{6}}^{\frac{\pi}{4}}\cossec^2(\theta)\,d\theta\\
                                                                        &= -\frac{1}{25}\left.\cotg^2(\theta)\right|_{\frac{\pi}{6}}^{\frac{\pi}{4}}\\
                                                                        &= -\frac{1}{25}\cotg\left(\frac{\pi}{4}\right) + \frac{1}{25}\cotg\left(\frac{\pi}{6}\right)\\
                                                                        &= \frac{\sqrt{3}}{25} - \frac{1}{25}
  \end{align}  
\end{resol}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int\frac{\sqrt{x^2-4}}{x}\,dx
  \end{equation}
  para $x\leq -2$.
\end{exeresol}
\begin{resol}
  Fazemos a substituição trigonométrica
  \begin{equation}
    x = 2\sec(\theta),\quad \frac{\pi}{2}\leq\theta\leq\pi\\
    dx = 2\sec(\theta)\tg(\theta)
  \end{equation}
  Substituindo na integral, obtemos
  \begin{align}
    \int\frac{\sqrt{x^2-4}}{x}\,dx &= \int\frac{\sqrt{4-4\sec^2(\theta)}}{2\sec(\theta)}2\sec(\theta)\tg(\theta)\,d\theta\\
                                   &= \int 2|\tg(\theta)|\tg(\theta)\,d\theta\\
                                   &= -2\int\tg^2(\theta)\,d\theta\\
                                   &= -2\int\left(\sec^2(\theta)-1\right)\,d\theta\\
                                   &= -2\tg(\theta) + 2\theta + C
  \end{align}
  
  Como $x = 2\sec(\theta)$, temos $\theta = \arc\sec(x/2)$ e
  \begin{align}
    \tg(\theta) = \frac{\sqrt{x^2-4}}{2}
  \end{align}
  Concluímos que
  \begin{equation}
    \int\frac{\sqrt{x^2-4}}{x}\,dx = 2\arc\sen\left(\frac{x}{2}\right) - \sqrt{x^2-4} + C
  \end{equation}
\end{resol}

\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{1}{\sqrt{4-x^2}\,dx}
  \end{equation}
  \begin{enumerate}[a)]
  \item Pelo método de substituição.
  \item Pelo método de substituição trigonométrica.
  \end{enumerate}
\end{exer}
\begin{resp}
  a) $u = \frac{1}{2}x$; b) $x = \sen(x)$, $-\frac{\pi}{2}\leq\theta\leq\frac{\pi}{2}$; $\int\frac{1}{\sqrt{4-x^2}\,dx} = \arc\sen(x/2) + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{dx}{x^2\sqrt{4-x^2}}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $-\frac{1}{4}\frac{\sqrt{4-x^2}}{x} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\sqrt{25+x^2}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $\displaystyle x\sec\left(\arc\tg\left(\frac{x}{5}\right)\right) + 5\ln\left|\sec\left(\arc\tg\left(\frac{x}{5}\right)\right) + \frac{x}{5}\right| + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_1^{\sqrt{2}}\frac{dx}{x^2\sqrt{4-x^2}}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $(\sqrt{3}-1)/4$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{\sqrt{x^2-9}}{x}\,dx
  \end{equation}
  para $x \geq 3$.
\end{exer}
\begin{resp}
  $\sqrt{x^2-9} - 2\arc\sen\left(\frac{x}{3}\right) + C$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Integração por frações parciais}\label{cap_int_sec_frapar}

O método de integração por frações parciais aplica-se a integrais de funções racionais
\begin{equation}
  \int \frac{p(x)}{q(x)}\,dx
\end{equation}
onde, $p$ e $q$ são funções polinomiais. A ideia é usar a chamada \emph{decomposição por fatores parciais}: toda função racional própria\footnote{Uma função racional $p/q$ é própria, quando o grau de $p$ é menor que o grau do denominador.} $p/q$ pode ser reescrita da seguinte forma
\begin{equation}
  \frac{p(x)}{q(x)} = f_1(x) + f_2(x) + \cdots + f_n(x),
\end{equation}
onde $f_1, f_2, \dotsc, f_n$ são chamadas de \emph{frações parciais} e têm a forma
\begin{equation}
  \frac{A}{(ax + b)^m}
\end{equation}
ou
\begin{equation}
  \frac{Ax + b}{(ax^2 + bx + c)^m}
\end{equation}
sendo seus denominadores os fatores de $q$.

\subsection{Raízes reais distintas}

Quando o polinômio denominador tem todas suas raízes reais e distintas, a decomposição por frações parciais tem a forma
\begin{equation}
  \frac{p(x)}{q(x)} = \frac{A_1}{a_1x + b_1} + \cdots + \frac{A_n}{a_nx + b_n} 
\end{equation}
onde, $n$ é o grau do denominador.

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int \frac{2x-4}{2x^2 - 5x + 3}\,dx.
  \end{equation}
  Para fazermos a decomposição por frações parciais, começamos calculando as raízes do denominador.
  \begin{gather}
    {\color{red}2}x^2 - 5x + 3 = 0\\
    x^2 - \frac{5}{2}x + \frac{3}{2} = 0\\
    x_{1,2} = \frac{\frac{5}{2} \pm \sqrt{\frac{25}{4} - 4\cdot \frac{3}{2}}}{2}\\
    x_1 = {\color{blue}1},\quad x_2 = {\color{blue}\frac{3}{2}}
  \end{gather}
  Com isso, decompomos o denominador como segue
  \begin{align}
    2x^2 - 5x + 3 &= {\color{red}2}(x-{\color{blue}1})\left(x-{\color{blue}\frac{3}{2}}\right)\\
                  &= (x-1)(2x-3)
  \end{align}

  \ifispython
  Com o {\python}+{\sympy}, podemos computar a fatoração do polinômio acima como segue:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> factor(2*x**2 - 5*x + 3)
     (x - 1)*(2*x - 3)
  \end{lstlisting}
  \fi

  Uma vez fatorado o denominador, a decomposição por frações parciais consistem em calcular os parâmetros $A$ e $B$ tais que
  \begin{align}
    \frac{2x-4}{2x^2 - 5x + 3} &= \frac{A}{x-1} + \frac{B}{2x-3}\\
                               &= \frac{A(2x-3) + B(x-1)}{(x-1)(2x-3)}\\
                               &= \frac{(2A+B)x + (-3A - B))}{(x-1)(2x-3)}
  \end{align}
  Então, por comparação direta, obtemos o seguinte sistema linear de duas equações e duas incógnitas
  \begin{equation}
    2A + B = 2\\
    -3A - B = -4
  \end{equation}
  Resolvendo-o, encontramos $A = 2$ e $B = -2$.

  \ifispython
  Com o {\python}+{\sympy}, podemos computar a solução deste sistema como segue:
  \begin{lstlisting}
    In : from sympy import *
    >>> A,B = symbols('A,B')
    >>> solve([Eq(2*A + B, 2),
    >>>        Eq(-3*A - B, -4)])
     {A: 2, B: -2}
  \end{lstlisting}
  \fi

  Em fim, obtemos a decomposição por frações parciais
  \begin{equation}
    \frac{2x-4}{2x^2 - 5x + 3} = \frac{2}{x-1} - \frac{2}{2x-3}.
  \end{equation}

  \ifispython
  Com o {\python}+{\sympy}, podemos computar a decomposição por frações parciais diretamente com o método \lstinline+apart+. Neste caso aqui, temos:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> apart((2*x-4)/(2*x**2 - 5*x + 3))
     -2/(2*x - 3) + 2/(x - 1)
  \end{lstlisting}
  \fi

  Uma vez, calculada a decomposição, temos que a integral que queremos calcular pode ser reescrita da seguinte forma
  \begin{equation}
    \int\frac{2x-4}{2x^2 - 5x + 3}\,dx = \int\frac{2}{x-1}\,dx - \int\frac{2}{2x-3}\,dx
  \end{equation}
  As integrais do lado esquerdo podem ser computadas pelo método da substituição, obtendo-se
  \begin{equation}
    \int\frac{2x-4}{2x^2 - 5x + 3}\,dx = 2\ln|x-1| - \ln|2x-3| + C
  \end{equation}
\end{ex}

\subsection{Raízes reais múltiplas}

No caso em que o denominador com raízes reais múltiplas, a decomposição por frações parciais tem a forma
\begin{equation}
  \frac{p(x)}{(ax+b)^m} = \frac{A_1}{(ax+b)} + \frac{A_2}{(ax+b)^2} + \cdots + \frac{A_m}{(ax+b)^m}. 
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int \frac{2-x}{x^2 - 2x + 1}\,dx
  \end{equation}
  O denominador tem raiz real dupla $x_{1,2} = 1$, podendo ser fatorado como segue
  \begin{equation}
    x^2 - 2x + 1 = (x-1)^2
  \end{equation}
  Então, a decomposição do integrando por frações parciais tem a forma
  \begin{align}
    \frac{2-x}{x^2 - 2x + 1} &= \frac{A_1}{x-1} + \frac{A_2}{(x-1)^2}\\
                             &= \frac{A_1(x-1) + A_2}{(x-1)^2}\\
                             &= \frac{A_1x + (-A_1 + A_2)}{(x-1)^2}
  \end{align}
  Por comparação direta, encontramos o seguinte sistema de equações lineares
  \begin{equation}
    A_1 = -1\\
    -A_1 + A_2 = 2
  \end{equation}
  Donde, obtemos os parâmetros $A_1 = -1$ e $A_2 = 1$. Com isso, a integral pode ser reescrita da seguinte forma
  \begin{equation}
    \int\frac{2-x}{x^2 - 2x + 1}\,dx = -\int\frac{1}{x-1}\,dx + \int\frac{1}{(x-1)^2}\,dx
  \end{equation}
  Estas últimas podem ser calculadas pelo método de substituição, donde concluímos que
  \begin{equation}
    \int\frac{2-x}{x^2 - 2x + 1}\,dx = -\ln|x-1| - \frac{1}{x-1} + C
  \end{equation}

  \ifispython
  Com o {\python}+{\sympy}, podemos computar esta integral diretamente com os seguintes comandos:
  \begin{lstlisting}
    In : from sympy import *
    >>> x = symbols('x')
    >>> integrate((2-x)/(x**2 - 2*x + 1))
     -log(x - 1) - 1/(x - 1)
  \end{lstlisting}
  \fi  
\end{ex}

\subsection{Raízes complexas}

Quando o polinômio denominador tem raízes complexas, a decomposição por frações parciais tem a forma
\begin{equation}
  \frac{p(x)}{(ax^2 + bx + c)^m} = \frac{A_1x + B_1}{ax^2 + bx + c} + \cdots + \frac{A_mx + B_m}{(ax^2 + bx + c)^m}
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int \frac{1}{x^3 - 3x^2 + 4x -2}\,dx
  \end{equation}
  As raízes do denominador são $x_1=1$ e $x_{2,3} = 1 \pm i$. Desta forma, fazemos a decomposição por frações parciais do integrando como segue 
  \begin{align}
    \frac{1}{x^3 - 3x^2 + 4x -2} &= \frac{A_1}{x-1} + \frac{A_2x + B_2}{x^2 - 2x + 2}\\
                                 &= \frac{A_1(x^2-2x+2) + (A_2x+B_2)(x-1))}{x^3-3x^2+4x-2}\\
                                 &= \frac{(A_1+A_2)x^2+(-2A_1-A_2+B_2)x+(2A_1-B_2)}{x^3-3x^2+4x-2}
  \end{align}
  Por comparação direta, temos
  \begin{gather}
    A_1+A_2 = 0\\
    -2A_1-A_2+B_2 = 0\\
    2A_1-B_2 = 1
  \end{gather}
  donde $A_1=1$, $A_2=-1$ e $B_2=1$. Com isso, calculamos a integral como segue
  \begin{align}
    \int \frac{1}{x^3 - 3x^2 + 4x -2}\,dx &= \int\frac{1}{(x-1)}\,dx + \int\frac{-x+1}{x^2 - 2x + 2}\,dx\\
                                          &= \ln|x-1| -\frac{1}{2}\ln|x^2-2x+2| + C
  \end{align}
\end{ex}

\subsection{Exercícios resolvidos}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int\frac{x+1}{2x^3+2x^2-2x-2}\,dx
  \end{equation}
\end{exeresol}
\begin{resol}
  Vamos calcular fazendo a decomposição por frações parciais. Começamos observando que $x=1$ é raiz do denominador, donde calculamos a fatoração
  \begin{equation}
    2x^3+2x^2-2x-2 = 2(x-1)(x+1)^2.
  \end{equation}
  Com isso, vemos que o denominador tem raízes $x_1=1$ e $x_{2,3}=-1$. Então, a decomposição por frações parciais do integrando tem a forma
  \begin{align}
    \frac{x+1}{2x^3+2x^2-2x-2} &= \frac{A_1}{2x-2} + \frac{A_2}{x+1} + \frac{A_3}{(x+1)^2}\\
                               &= \frac{A_1(2x+2)^2+A_2(2x-2)(x+1)+A_3(2x-2)}{(2x-2)(x+1)^2}\\
                               &= \frac{A_1(4x^2+8x+4)+A_2(2x^2-2)+A_3(2x-2)}{(2x-2)(x+1)^2}
  \end{align}
  Por comparação direta, temos
  \begin{gather}
    4A_1+2A_2=0\\
    8A_1+2A_3=1\\
    4A_1-2A_2-2A_3=1
  \end{gather}
  Resolvendo, obtemos $A_1=1/8$, $A_2=-1/4$ e $A_3=0$. Por fim, calculamos a integral como segue
  \begin{align}
    \int\frac{x+1}{2x^3+2x^2-2x-2}\,dx &= \int\frac{\frac{1}{8}}{2x-2}\,dx + \int\frac{-\frac{1}{4}}{x+1}\,dx\\
                                       &= \frac{1}{4}\ln|x-1| - \frac{1}{4}\ln|x+1| + C
  \end{align}
\end{resol}

\begin{exeresol}
  Calcule a área entre as curvas $y=5/(x(x^2+4))$, $y=0$, $x=1$ e $x=2$.
\end{exeresol}
\begin{resol}
  A área pode ser calculada pela integral definida
  \begin{equation}
    \int_{1}^{2}\frac{5}{x(x^2+4)}\,dx.
  \end{equation}
  Vamos calculá-la pelo método da decomposição por frações parciais
  \begin{align}
    \frac{5}{x(x^2-4)} &= \frac{A_1}{x} + \frac{A_2x+B_2}{(x**2+4}\\
                       &= \frac{A_1(x^2+4) + (A_2x+B_2)x}{x(x^2+4)}
  \end{align}
  Por comparação direta, obtemos o seguinte sistema de equações lineares
  \begin{gather}
    A_1+A_2=0\\
    B_2=0\\
    4A_1=5
  \end{gather}
  Donde, temos os parâmetros $A_1=\frac{5}{4}$, $A_2 = -\frac{5}{4}$ e $B_2=0$. Com isso, calculamos a integral como segue
  \begin{align}
    \int_{1}^{2}\frac{5}{x(x^2-4)}\,dx &= \int_1^2\frac{\frac{5}{4}}{x}\,dx + \int_1^2\frac{-\frac{5}{4}x}{x^2+4}\,dx\\
                                       &= \frac{5}{4}\left[\ln|x|\right]_1^2 - \frac{5}{4}\left[\ln|x^2+4|\right]_1^2\\
                                       &= \frac{5}{4}\ln(2) - \frac{5}{4}\ln(8) + \frac{5}{4}\ln(4)\\
                                       &= \frac{5}{4}\ln(2)
  \end{align}
\end{resol}

\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{1}{x^2-1}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $\frac{1}{2}\ln|x-1| - \frac{1}{2}\ln|x+1| + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{x+2}{2x^3-5x^2+2x}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $\ln|x|+\frac{2}{3}\ln|x-2|-\frac{5}{3}\ln|x-\frac{1}{2}| + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{2x-3}{x^3-x^2-x+1}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $\frac{5}{4}\ln|x-1|-\frac{5}{4}\ln|x+1|+\frac{1}{2x-2} + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int\frac{x+2}{x^3+x}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $2\ln|x| - \ln|x^2+1| + \arctg(x) + C$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_0^1\frac{1}{2x^3+7x^2-7x+2}\,dx
  \end{equation}
\end{exer}
\begin{resp}
  $-\frac{4}{3}\ln(2)+\ln|3|$
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi


\section{Integrais Impróprias}\label{cap_int_sec_intimp}

A integral
\begin{equation}
  \int_a^b f(x)\,dx
\end{equation}
é chamada de integral imprópria quando $a,b\to\pm\infty$ ou $f$ tem uma descontinuidade infinita no intervalo $[a, b]$. Quando a integral existe, dizemos que ela é convergente.

\begin{ex}
  Estudemos os seguintes casos:
  \begin{enumerate}[a)]
  \item $\displaystyle\int_{-2}^\infty \frac{1}{x^2}\,dx$
    É uma integral imprópria, pois o intervalo de integração $[-2, \infty)$ é infinito.
  \item $\displaystyle\int_{-\infty}^{1}e^{x}\,dx$
    É uma integral imprópria, pois o intervalo de integração $(-\infty, 1]$ é infinito.
  \item $\displaystyle\int_{-1}^{1}\frac{1}{x+1}\,dx$
    É uma integral imprópria, pois o integrando $1/(x+1)$ tem uma assíntota vertical no extremo esquerdo do intervalo de integração.
  \item $\displaystyle\int_{0}^2\frac{x-1}{x^2-1}\,dx$
    Não é uma integral imprópria, pois o integrando é contínuo por partes no intervalo $[0,2]$.
  \item $\displaystyle\int_{-2}^2\frac{x-1}{x^2-1}\,dx$
    É uma integral imprópria, pois o integrando tem uma descontinuidade infinita em $x=-1$.
  \end{enumerate}
\end{ex}

\subsection{Limites de integração infinitos}

No caso de integrais impróprias da forma
\begin{equation}
  \int_a^\infty f(x)\,dx
\end{equation}
calculamos
\begin{equation}
  \int_a^\infty f(x)\,dx = \lim_{b\to\infty}\int_a^bf(x)\,dx.
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_1^\infty\frac{1}{x^2}\,dx
  \end{equation}
  Temos
  \begin{align}
    \int_1^\infty\frac{1}{x^2}\,dx &= \lim_{b\to\infty}\int_1^b\frac{1}{x^2}\,dx\\
                                   &= \lim_{b\to\infty} \left[-\frac{1}{x}\right]_1^b\\
                                   &= \lim_{b\to\infty} \left[-\cancelto{0}{\frac{1}{b}} + \frac{1}{1}\right]\\
                                   &= 1
  \end{align}
\end{ex}

Analogamente, calculamos
\begin{equation}
  \int_{-\infty}^{b}f(x)\,dx = \lim_{a\to -\infty}\int_a^bf(x)\,dx.
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_{-\infty}^2e^{x}\,dx.
  \end{equation}
  Temos
  \begin{align}
    \int_{-\infty}^2e^{x}\,dx &= \lim_{a\to -\infty}\int_a^2e^{x}\,dx\\
                              &= \lim_{a\to -\infty} [e^x]_a^2\\
                              &= \lim_{a\to -\infty} e^2 - \cancelto{0}{e^a}\\
                              &= e^2
  \end{align}
\end{ex}

No caso de integrais impróprias da forma
\begin{equation}
  \int_{-\infty}^\infty f(x)\,dx
\end{equation}
escolhemos um $c$ qualquer e calculamos
\begin{equation}
  \int_{-\infty}^\infty f(x)\,dx = \int_{-\infty}^c f(x)\,dx + \int_{c}^\infty f(x)\,dx
\end{equation}
Dizemos que a integral é divergente no caso de ao menos uma das integrais à direita ser divergente.

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_{-\infty}^\infty \frac{2dx}{1+4x^2}
  \end{equation}
  Escolhendo $c=0$, temos
  \begin{align}
    \int_{-\infty}^\infty \frac{2dx}{1+4x^2} &= \int_{-\infty}^0 \frac{2dx}{1+4x^2} + \int_{0}^\infty \frac{2dx}{1+4x^2}\\
                                             &= \lim_{a\to -\infty}\int_a^0\frac{2dx}{1+4x^2} + \lim_{b\to\infty}\int_{0}^b \frac{2dx}{1+4x^2}\\
                                             &= \lim_{a\to -\infty}[\arc\tg(2x)]_a^0 + \lim_{b\to\infty}[\arc\tg(2x)]_0^b\\
                                             &= \lim_{a\to -\infty}[\arc\tg(0) - \cancelto{-\frac{\pi}{4}}{\arc\tg(a)}]_a^0 \\
                                             &+ \lim_{b\to\infty}[\cancelto{\frac{\pi}{4}}{\arc\tg(b)} - \arc\tg(0)]_0^b\\
                                             &= \frac{\pi}{4} + \frac{\pi}{4} = \frac{\pi}{2}
  \end{align}
\end{ex}

\subsection{Integrandos com descontinuidade infinita}

No caso de integrais impróprias em que o integrando tem descontinuidade infinita no limite de integração inferior, calculamos
\begin{equation}
  \int_a^bf(x)\,dx = \lim_{c\to a^+}\int_c^bf(x),dx.
\end{equation}
Se a descontinuidade for no limite superior, então calculamos
\begin{equation}
  \int_a^bf(x)\,dx = \lim_{c\to b^-}\int_a^cf(x),dx.
\end{equation}

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_1^2\frac{2x - 2}{(x-1)^2}\,dx
  \end{equation}
  Temos
  \begin{align}
    \int_1^2\frac{dx}{(x-1)^2}\,dx &= \lim_{c\to 1^+}\int_c^2\frac{dx}{(x-1)^2}\\
                                   &= \lim_{c\to 1^+}\int_{x=c}^2\frac{du}{u^2}
  \end{align}
  onde, usamos a substituição $u = x-1$ e $du = dx$. Segue que,
  \begin{align}
    \int_1^2\frac{dx}{(x-1)^2}\,dx &= \lim_{c\to 1^+}[-u^{-1}]_{x=c}^2\\
                                   &= \lim_{c\to 1^+}\left[-\frac{1}{x-1}\right]_{c}^2\\
                                   &= \lim_{c\to 1^+}\left[-1 + \frac{1}{\cancelto{0^+}{c-1}}\right]\\
                                   &= \infty
  \end{align}
\end{ex}

No caso do integrando ter descontinuidade infinita em um ponto interno do limite de integração, calculamos
\begin{equation}
  \int_a^bf(x)\,dx = \int_{a}^cf(x)\,dx + \int_c^bf(x)\,dx,
\end{equation}
onde, $x=c$ é o ponto de descontinuidade de $f$.

\begin{ex}
  Vamos calcular
  \begin{equation}
    \int_0^3\frac{dx}{x-2}
  \end{equation}
  Fazemos
  \begin{align}
    \int_0^3\frac{dx}{x-2} &= \int_0^2\frac{dx}{x-2} + \int_2^3\frac{dx}{x-2}\\
                           &= \lim_{c\to 2^-}\int_0^c\frac{dx}{x-2} + \lim_{c\to 2^+}\int_c^3\frac{dx}{x-2}\\
                           &= \lim_{c\to 2^-}[\ln|x-2|]_0^c + \lim_{x\to 2^+}[\ln|x-2|]_c^3\\
                           &= \lim_{c\to 2^-}[\cancelto{-\infty}{\ln|c-2|} + \ln|-2|]_0^c + \lim_{x\to 2^+}[\ln|1| - \cancelto{-\infty}{\ln|c-2|}]_c^3\\
                           &= -\infty + \infty
  \end{align}
  no que concluímos que a integral é divergente.
\end{ex}

\subsection{Exercícios resolvidos}

\begin{exeresol}
  Para quais valores de $p$ a integral
  \begin{equation}
    \int_1^\infty\frac{dx}{x^p}
  \end{equation}
  é convergente.
\end{exeresol}
\begin{resol}
  Por definição
  \begin{equation}
    \int_1^\infty\frac{dx}{x^p} = \lim_{b\to\infty}\int_1^b\frac{dx}{x^p}
  \end{equation}
  Para $p=1$, temos
  \begin{align}
    \int_1^\infty\frac{dx}{x} &= \lim_{b\to\infty}\int_1^b\frac{dx}{x}\\
                              &= \lim_{b\to\infty}\left[\ln|x|\right]_1^b\\
                              &= \lim_{b\to\infty}\left[\cancelto{\infty}{\ln|b|} - \ln|1|\right]\\
                              &= \infty
  \end{align}
  Ou seja, para $p=1$ a integral é divergente. Agora, para $p\neq 1$, temos
  \begin{align}
    \int_1^\infty\frac{dx}{x^p} &= \lim_{b\to\infty}\int_1^b\frac{dx}{x^p}\\
                              &= \lim_{b\to\infty}\left[\frac{x^{1-p}}{1-p}\right]_1^b\\
                              &= \lim_{b\to\infty}\left[\frac{b^{1-p}}{1-p} - \frac{1}{1-p}\right]
  \end{align}
  Para $p<1$, temos que $b^{1-p}\to\infty$ quando $b\to\infty$. Agora, para $p>1$, temos que $b^{1-p}\to 0$ quando $b\to\infty$. Logo, concluímos que a integral é convergente para $p>1$ e
  \begin{equation}
    \int_1^\infty\frac{dx}{x^p} = \frac{1}{p-1},\quad p>1.
  \end{equation}
\end{resol}

\begin{exeresol}
  Calcule
  \begin{equation}
    \int_1^\infty\frac{dx}{(x-1)^2}
  \end{equation}
\end{exeresol}
\begin{resol}
  Notamos que, além do limite de integração infinito, o integrando tem uma descontinuidade infinita em $x=1$. Logo, calculamos
  \begin{align}
    \int_1^\infty\frac{dx}{x-1} &= \lim_{b\to\infty}\int_1^b\frac{dx}{(x-1)^2}\\
                                &= \lim_{b\to\infty}\left[\lim_{a\to 1^+}\int_a^b\frac{dx}{(x-1)^2}\right]\\
                                &= \lim_{b\to\infty}\left[\lim_{a\to 1^+}\left[\frac{1}{1-x}\right]_a^b\right]\\
                                &= \lim_{b\to\infty}\lim_{a\to 1^+}\left(\cancelto{0}{\frac{1}{1-b}} - \cancelto{-\infty}{\frac{1}{1-a}}\right)\\
                                &= +\infty
  \end{align}
\end{resol}

\subsection{Exercícios}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle\int_1^\infty\frac{dx}{x^3}$
  \item $\displaystyle\int_{-\infty}^{-\frac{1}{2}}\frac{dx}{x^3}$
  \end{enumerate}
\end{exer}
\begin{resp}
  a)~$\frac{1}{2}$; b)~$2$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}[a)]
  \item $\displaystyle\int_{-\infty}^\infty\frac{xdx}{\sqrt{x^2+1}}$
  \item $\displaystyle\int_{-\infty}^{\infty}\frac{e^{-x}}{1+e^{-2x}}\,dx$
  \end{enumerate}  
\end{exer}
\begin{resp}
  a) $\infty$; b) $-\frac{\pi}{2}$
\end{resp}

\begin{exer}
  Calcule
  \begin{enumerate}
  \item $\displaystyle\int_{0}^1\frac{dx}{x^2}$
  \item $\displaystyle\int_{-1}^{2}\frac{dx}{x-2}\,dx$

  \end{enumerate}
\end{exer}
\begin{resp}
  a) $\infty$; b) $-\infty$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-2}^2\frac{dx}{x^2}
  \end{equation}
\end{exer}
\begin{resp}
  $\infty$
\end{resp}

\begin{exer}
  Calcule
  \begin{equation}
    \int_{-\infty}^{\infty} \frac{dx}{x^3}
  \end{equation}
\end{exer}
\begin{resp}
  divergente
\end{resp}

\ifisbook
\subsubsection{Respostas}
\shipoutAnswer
\fi